<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.12">
<link rel="icon" type="image/x-icon" href="../favicon.ico">
<title>Mobi User Manual</title>
<link rel="stylesheet" href="./../foundation.css">
<link rel="stylesheet" href="../highlight/styles/github.min.css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.2/css/font-awesome.min.css">
<link rel="stylesheet" href="custom.css">
<link rel="stylesheet" href="../nav-bar.css">
<script src="https://code.jquery.com/jquery-2.2.3.min.js" integrity="sha256-a23g1Nt4dtEYOj7bR+vTu7+T8VP13humZFBJNIYoEJo=" crossorigin="anonymous"></script>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        // Create toggle anchor
        var target = document.querySelector('#header');
        var anchor = document.createElement('a');
        anchor.className = 'tocSwitch fa fa-arrow-up';
        // Add click listener to the button
        anchor.addEventListener('click', function (e) {
            e.stopPropagation();
            var toc = document.querySelector('#toc');
            var body = document.querySelector('body');
            // If the toc is visible
            if (body.classList.contains('toc2')) {
                body.classList.remove('toc2');
                body.classList.remove('toc-left');
                toc.style.display = 'none';
                anchor.className = 'tocSwitch fa fa-arrow-down';
            } else { // If the toc is not visible
                body.classList.add('toc2');
                body.classList.add('toc-left');
                toc.style.display = 'block';
                anchor.className = 'tocSwitch fa fa-arrow-up';
            }
        });
        // Add anchor to DOM
        target.appendChild(anchor);
        // Add window resize listener
        $(window).resize(function() {
            var toc = document.querySelector('#toc');
            var body = document.querySelector('body');
            // If the window is smaller than 768px, collapse the toc by default
            if ($(window).width() < 768) {
                body.classList.remove('toc2');
                body.classList.remove('toc-left');
                toc.style.display = 'none';
                anchor.className = 'tocSwitch fa fa-arrow-down';
            } else { // If the window is bigger than 768px, keep the toc open
                body.classList.add('toc2');
                body.classList.add('toc-left');
                toc.style.display = 'block';
                anchor.className = 'tocSwitch fa fa-arrow-up';
            }
        });
        // Add click listener for
        $('#toc a').click(function() {
            var toc = document.querySelector('#toc');
            var body = document.querySelector('body');
            if ($(window).width() < 768) {
                body.classList.remove('toc2');
                body.classList.remove('toc-left');
                toc.style.display = 'none';
                anchor.className = 'tocSwitch fa fa-arrow-down';
            }
        });
    });
</script>
</head>
<body class="article toc2 toc-left">
<div class="nav-bar">
    <a class="img-link" href="../">
        <img src="../mobi-alternate-logo.png" alt="Alternative Mobi Logo"/>
    </a>
    <input type="checkbox" name="menu-btn" id="menu-btn" value="1" />
    <label class="menu-icon" for="menu-btn"><i class="fa fa-bars" aria-hidden="true"></i></label>
    <ul class="nav-items">
        <li><a href="../latest/index.html">User Manual</a></li>
        <li><a href="../release-notes/index.html">Release Notes</a></li>
        <li><a href="https://inovexirad.atlassian.net/servicedesk/customer/portal/1" target="_blank">Help Desk</a></li>
    </ul>
</div><div id="header">
<h1>Mobi User Manual</h1>
<div class="details">
<span id="revnumber">version 2.4</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#introduction">Introduction</a></li>
<li><a href="#quick_start_guide">Quick Start Guide</a>
<ul class="sectlevel2">
<li><a href="#installing_from_the_distribution">Installing from the Distribution</a>
<ul class="sectlevel3">
<li><a href="#prerequisites">Prerequisites</a></li>
<li><a href="#installation">Installation</a></li>
</ul>
</li>
<li><a href="#installing_the_docker_image">Installing the Docker Image</a></li>
</ul>
</li>
<li><a href="#user_guide">User Guide</a>
<ul class="sectlevel2">
<li><a href="#catalog-guide">Catalog</a>
<ul class="sectlevel3">
<li><a href="#catalog_landing_page">Catalog Landing Page</a></li>
<li><a href="#record_view">Record View</a></li>
<li><a href="#record_permissions">Record Permissions</a></li>
</ul>
</li>
<li><a href="#ontology-editor-guide">Ontology Editor</a>
<ul class="sectlevel3">
<li><a href="#creating_new_ontologies">Creating New Ontologies</a></li>
<li><a href="#uploading_existing_ontologies">Uploading Existing Ontologies</a></li>
<li><a href="#editing_an_ontology">Editing an Ontology</a>
<ul class="sectlevel4">
<li><a href="#ontology_project_tab">Ontology Project Tab</a></li>
<li><a href="#overview_tab">Overview Tab</a></li>
<li><a href="#classes_tab">Classes Tab</a></li>
<li><a href="#properties_tab">Properties Tab</a></li>
<li><a href="#individuals_tab">Individuals Tab</a></li>
<li><a href="#schemes_tab">Schemes Tab</a></li>
<li><a href="#concepts_tab">Concepts Tab</a></li>
<li><a href="#search_tab">Search Tab</a></li>
<li><a href="#visualization_tab">Visualization Tab</a></li>
</ul>
</li>
<li><a href="#ontology_versioning">Ontology Versioning</a>
<ul class="sectlevel4">
<li><a href="#checking_out_branchestagscommits">Checking Out Branches/Tags/Commits</a></li>
<li><a href="#viewing_saved_changes">Viewing Saved Changes</a></li>
<li><a href="#merging_branches">Merging Branches</a></li>
<li><a href="#commits_tab">Commits Tab</a></li>
<li><a href="#entity_history">Entity History</a></li>
</ul>
</li>
<li><a href="#ontology_editor_reference">Ontology Editor Reference</a>
<ul class="sectlevel4">
<li><a href="#edit_iri_overlay">Edit IRI Overlay</a></li>
<li><a href="#axiom_overlay">Axiom Overlay</a></li>
<li><a href="#property_value_displays">Property Value Displays</a></li>
<li><a href="#button_stack">Button Stack</a></li>
<li><a href="#extension_mappings">Extension Mappings</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#vocabulary-linking">Link (ENTERPRISE)</a></li>
<li><a href="#shapes-editor-guide">Shapes Editor (BETA)</a>
<ul class="sectlevel3">
<li><a href="#creating_new_shapes_graphs">Creating New Shapes Graphs</a></li>
<li><a href="#editing_a_shapes_graph">Editing a Shapes Graph</a></li>
<li><a href="#shapes_graph_versioning">Shapes Graph Versioning</a>
<ul class="sectlevel4">
<li><a href="#branches_tags">Branches &amp; Tags</a></li>
<li><a href="#viewing_saved_changes_on_shapes_graphs">Viewing Saved Changes on Shapes Graphs</a></li>
<li><a href="#merging_branches_on_shapes_graphs">Merging Branches on Shapes Graphs</a></li>
<li><a href="#uploading_changes_to_shapes_graphs">Uploading Changes to Shapes Graphs</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#merge-requests-guide">Merge Requests</a>
<ul class="sectlevel3">
<li><a href="#create_a_merge_request">Create a Merge Request</a></li>
<li><a href="#accepting_a_merge_request">Accepting a Merge Request</a></li>
</ul>
</li>
<li><a href="#mapping-tool-guide">Mapping Tool</a>
<ul class="sectlevel3">
<li><a href="#creating_a_mapping">Creating a Mapping</a></li>
<li><a href="#editing_a_mapping">Editing a Mapping</a></li>
<li><a href="#duplicating_a_mapping">Duplicating a Mapping</a></li>
<li><a href="#running_a_mapping">Running a Mapping</a></li>
<li><a href="#mapping_tool_reference">Mapping Tool Reference</a>
<ul class="sectlevel4">
<li><a href="#source_ontology_overlay">Source Ontology Overlay</a></li>
<li><a href="#iri_template_overlay">IRI Template Overlay</a></li>
<li><a href="#mapping_into_an_ontology">Mapping into an Ontology</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#datasets-manager-guide">Datasets Manager</a>
<ul class="sectlevel3">
<li><a href="#create_dataset">Create Dataset</a></li>
<li><a href="#edit_dataset">Edit Dataset</a></li>
</ul>
</li>
<li><a href="#discover-guide">Discover</a>
<ul class="sectlevel3">
<li><a href="#explore">Explore</a></li>
<li><a href="#query">Query</a></li>
</ul>
</li>
<li><a href="#my-account-guide">My Account</a>
<ul class="sectlevel3">
<li><a href="#profile">Profile</a></li>
<li><a href="#groups">Groups</a></li>
<li><a href="#password">Password</a></li>
<li><a href="#preferences">Preferences</a></li>
</ul>
</li>
<li><a href="#administration">Administration</a>
<ul class="sectlevel3">
<li><a href="#users">Users</a></li>
<li><a href="#groups_2">Groups</a></li>
<li><a href="#permissions">Permissions</a></li>
<li><a href="#application_settings">Application Settings</a></li>
<li><a href="#licensing">Licensing (ENTERPRISE)</a></li>
</ul>
</li>
<li><a href="#configuration-guide">Configuration</a>
<ul class="sectlevel3">
<li><a href="#mobi">Mobi</a>
<ul class="sectlevel4">
<li><a href="#service_configuration">Service Configuration</a></li>
<li><a href="#core_security_configuration">Core Security Configuration</a></li>
<li><a href="#configure_default_authentication_token_jwt_duration">Configure Default Authentication Token (JWT) Duration</a></li>
<li><a href="#ldap_configuration_enterprise">LDAP Configuration (ENTERPRISE)</a></li>
<li><a href="#sso_configuration_enterprise">SSO Configuration (ENTERPRISE)</a></li>
<li><a href="#password_encryption_configuration">Password Encryption Configuration</a></li>
<li><a href="#ontology_cache_configuration">Ontology Cache Configuration</a></li>
<li><a href="#banner_configuration_enterprise">Banner Configuration (ENTERPRISE)</a></li>
<li><a href="#email_service_configuration">Email Service Configuration</a></li>
</ul>
</li>
<li><a href="#apache_karaf">Apache Karaf</a></li>
</ul>
</li>
<li><a href="#mobi-shell-guide">Mobi Shell</a></li>
</ul>
</li>
<li><a href="#administration-guide">Administration Guide</a>
<ul class="sectlevel2">
<li><a href="#mobi_requirements">Mobi Requirements</a>
<ul class="sectlevel3">
<li><a href="#hardware_requirements">Hardware Requirements</a></li>
<li><a href="#software_requirements">Software Requirements</a></li>
<li><a href="#firewall_requirements">Firewall Requirements</a></li>
</ul>
</li>
<li><a href="#installing_mobi">Installing Mobi</a>
<ul class="sectlevel3">
<li><a href="#pre_installation_configuration">Pre-Installation Configuration</a>
<ul class="sectlevel4">
<li><a href="#create_service_account">Create Service Account</a></li>
<li><a href="#install_java_17">Install Java 17</a></li>
</ul>
</li>
<li><a href="#install_mobi">Install Mobi</a>
<ul class="sectlevel4">
<li><a href="#server-id-license-file">Server ID and License File (ENTERPRISE)</a></li>
</ul>
</li>
<li><a href="#post_installation_configuration">Post-Installation Configuration</a>
<ul class="sectlevel4">
<li><a href="#change_the_default_java_heap_size">Change the Default Java Heap Size</a></li>
<li><a href="#set_the_host_name">Set the Host Name</a></li>
<li><a href="#change_the_default_web_port">Change the Default Web Port</a></li>
<li><a href="#configure_custom_ssl_certificates">Configure Custom SSL Certificates</a></li>
<li><a href="#installing_mobi_as_a_service">Installing Mobi as a Service</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#upgrading_mobi">Upgrading Mobi</a></li>
</ul>
</li>
<li><a href="#developer_guide">Developer Guide</a>
<ul class="sectlevel2">
<li><a href="#prerequisites_2">Prerequisites</a></li>
<li><a href="#build_from_source">Build from Source</a></li>
<li><a href="#load_dataset_data">Load Dataset Data</a></li>
<li><a href="#accessing_swagger_rest_api_documentation">Accessing Swagger REST API Documentation</a></li>
<li><a href="#translating_documents">Translating Documents</a>
<ul class="sectlevel3">
<li><a href="#utilizing_the_mobi_shell">Utilizing the Mobi Shell</a></li>
<li><a href="#utilizing_the_rest_endpoints_and_swagger_ui">Utilizing the REST endpoints and Swagger UI</a></li>
<li><a href="#translating_different_file_types">Translating Different File Types</a>
<ul class="sectlevel4">
<li><a href="#xml">XML</a></li>
<li><a href="#json">JSON</a></li>
<li><a href="#csv">CSV</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#mobi_mappings">Appendix A: Mobi Mappings</a>
<ul class="sectlevel2">
<li><a href="#mapping">Mapping</a>
<ul class="sectlevel3">
<li><a href="#sourcerecord">sourceRecord</a></li>
<li><a href="#sourcebranch">sourceBranch</a></li>
<li><a href="#sourcecommit">sourceCommit</a></li>
</ul>
</li>
<li><a href="#classmapping">ClassMapping</a>
<ul class="sectlevel3">
<li><a href="#mapsto">mapsTo</a></li>
<li><a href="#dataproperty">dataProperty</a></li>
<li><a href="#objectproperty">objectProperty</a></li>
<li><a href="#hasprefix">hasPrefix</a></li>
<li><a href="#localname">localName</a></li>
</ul>
</li>
<li><a href="#datamapping">DataMapping</a>
<ul class="sectlevel3">
<li><a href="#columnindex">columnIndex</a></li>
<li><a href="#data-hasProperty">hasProperty</a></li>
<li><a href="#datatypespec">datatypeSpec</a></li>
<li><a href="#languagespec">languageSpec</a></li>
</ul>
</li>
<li><a href="#objectmapping">ObjectMapping</a>
<ul class="sectlevel3">
<li><a href="#classmapping_2">classMapping</a></li>
<li><a href="#object-hasProperty">hasProperty</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#mobi_datasets">Appendix B: Mobi Datasets</a>
<ul class="sectlevel2">
<li><a href="#systemdefaultnamedgraph">systemDefaultNamedGraph</a></li>
<li><a href="#defaultnamedgraph">defaultNamedGraph</a></li>
<li><a href="#namedgraph">namedGraph</a></li>
</ul>
</li>
<li><a href="#settings_framework">Appendix C: Settings Framework</a>
<ul class="sectlevel2">
<li><a href="#setting_rdf_definition">Setting RDF Definition</a>
<ul class="sectlevel3">
<li><a href="#settingpreference">setting:Preference</a></li>
<li><a href="#settingapplicationsetting">setting:ApplicationSetting</a></li>
<li><a href="#settingpreferencegroup">setting:PreferenceGroup</a></li>
<li><a href="#settingapplicationsettinggroup">setting:ApplicationSettingGroup</a></li>
<li><a href="#wfformfield">wf:FormField</a></li>
<li><a href="#settinghasdatavalue">setting:hasDataValue</a></li>
<li><a href="#wfusesformfield">wf:usesFormField</a></li>
<li><a href="#settingingroup">setting:inGroup</a>
<ul class="sectlevel4">
<li><a href="#required_shacl_nodeshape">Required SHACL NodeShape</a></li>
<li><a href="#required_shacl_propertyshape">Required SHACL PropertyShape</a></li>
<li><a href="#required_preferencegroupapplicationsettinggroup">Required PreferenceGroup/ApplicationSettingGroup</a></li>
</ul>
</li>
<li><a href="#example_rdf">Example RDF</a></li>
</ul>
</li>
<li><a href="#adding_custom_settings">Adding Custom Settings</a>
<ul class="sectlevel3">
<li><a href="#generate_java_classes_from_setting_rdf">Generate Java Classes from Setting RDF</a></li>
<li><a href="#load_setting_rdf_into_mobi_repo">Load Setting RDF into Mobi Repo</a></li>
</ul>
</li>
<li><a href="#using_a_stored_setting">Using a Stored Setting</a></li>
</ul>
</li>
<li><a href="#mobi_security_policies">Appendix D: Mobi Security Policies</a>
<ul class="sectlevel2">
<li><a href="#attribute_based_access_control">Attribute-Based Access Control</a>
<ul class="sectlevel3">
<li><a href="#attribute_based_access_control_workflow">Attribute-Based Access Control Workflow</a></li>
</ul>
</li>
<li><a href="#xacml">XACML</a>
<ul class="sectlevel3">
<li><a href="#xacml_example">XACML Example</a></li>
<li><a href="#xacml_workflow">XACML Workflow</a></li>
</ul>
</li>
<li><a href="#mobi_policies">Mobi Policies</a>
<ul class="sectlevel3">
<li><a href="#mobi_system_policies">Mobi System Policies</a></li>
<li><a href="#reload_system_policy_command">Reload System Policy Command</a></li>
<li><a href="#mobi_policy_templates">Mobi Policy Templates</a>
<ul class="sectlevel4">
<li><a href="#allow_everyone">Allow "Everyone"</a></li>
<li><a href="#allow_creator_or_specific_user">Allow "Creator" or Specific User</a></li>
<li><a href="#allow_specific_group">Allow Specific Group</a></li>
<li><a href="#allow_admin_users">Allow admin Users</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#workflows">Appendix E: Workflows</a>
<ul class="sectlevel2">
<li><a href="#workflow_rdf_definition">Workflow RDF Definition</a>
<ul class="sectlevel3">
<li><a href="#wworkflow">w:Workflow</a></li>
<li><a href="#wtrigger">w:Trigger</a></li>
<li><a href="#waction">w:Action</a></li>
</ul>
</li>
<li><a href="#workflows_system_configuration">Workflows System Configuration</a>
<ul class="sectlevel3">
<li><a href="#dagu_workflow_engine">Dagu Workflow Engine</a></li>
</ul>
</li>
<li><a href="#creating_and_using_workflows">Creating and Using Workflows</a>
<ul class="sectlevel3">
<li><a href="#create_a_workflow">Create a Workflow</a></li>
<li><a href="#activatedeactivate_a_workflow">Activate/Deactivate a Workflow</a></li>
<li><a href="#update_a_workflow_definition">Update a Workflow Definition</a></li>
<li><a href="#manually_initiate_a_workflow_execution">Manually Initiate a Workflow Execution</a></li>
<li><a href="#retrieving_workflow_provenance_and_logs">Retrieving Workflow Provenance and Logs</a>
<ul class="sectlevel4">
<li><a href="#retrieve_workflow_activity">Retrieve Workflow Activity</a></li>
<li><a href="#retrieve_all_workflow_activities">Retrieve All Workflow Activities</a></li>
<li><a href="#retrieve_specific_workflow_activity_logs">Retrieve Specific Workflow Activity Logs</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#extending_workflows">Extending Workflows</a>
<ul class="sectlevel3">
<li><a href="#triggeraction_rdf_definition">Trigger/Action RDF Definition</a></li>
<li><a href="#adding_custom_triggersactions">Adding Custom Triggers/Actions</a>
<ul class="sectlevel4">
<li><a href="#create_workflow_extension_bundle_with_rdf">Create Workflow Extension Bundle with RDF</a></li>
<li><a href="#create_workflow_extension_services">Create Workflow Extension Services</a></li>
<li><a href="#deploy_osgi_bundle">Deploy OSGi Bundle</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="imageblock text-center">
<div class="content">
<img src="../mobi-primary-logo-cropped.png" alt="Mobi Logo" width="500">
</div>
</div>
<div class="paragraph">
<p>Mobi is an open and collaborative knowledge graph platform for teams and communities to publish and discover data, data models, and analytics that are instantly consumable.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="introduction">Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Mobi is a free and open platform which links native data sources into a knowledge graph, creating an environment for teams and communities to accelerate discovery and deployment of advanced data systems. Mobi is built with <a href="http://karaf.apache.org/">Apache Karaf</a> and utilizes <a href="https://www.w3.org/TR/owl2-overview/">OWL 2</a> for authoring ontologies, the <a href="https://www.w3.org/TR/sparql11-overview/">SPARQL</a> query language for data lookup, and a pluggable backend system for processing and handling graph data modeled using the Resource Description Framework (<a href="https://www.w3.org/RDF/">RDF</a>). The Mobi platform applies the best practices recommended by the World Wide Web Consortium (<a href="https://www.w3.org/standards/semanticweb/data">W3C</a>) to support organic growth of knowledge in a variety of domains.</p>
</div>
<div class="paragraph">
<p><a href="#quick_start_guide">Quick Start Guide</a></p>
</div>
<div class="paragraph">
<p><a href="#user_guide">User Guide</a></p>
</div>
<div class="paragraph">
<p><a href="#administration_guide">Administration Guide</a></p>
</div>
<div class="paragraph">
<p><a href="#developer_guide">Developer Guide</a></p>
</div>
<div class="paragraph">
<p><a href="#release_notes">Release Notes</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="quick_start_guide">Quick Start Guide</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="installing_from_the_distribution">Installing from the Distribution</h3>
<div class="sect3">
<h4 id="prerequisites">Prerequisites</h4>
<div class="paragraph">
<p>Mobi requires a Java SE 17 environment to run. Refer to <code><a href="http://www.oracle.com/technetwork/java/javase/" class="bare">http://www.oracle.com/technetwork/java/javase/</a></code> for details on how to download and install Java SE 1.17.</p>
</div>
<div class="paragraph">
<p>Make sure your <code>JAVA_HOME</code> environment variable correctly points to your Java 17 installation directory. For example on a Mac, this would resemble <code>/Library/Java/JavaVirtualMachines/openjdk-17.jdk</code>. On Windows, this would resemble <code>C:\Program Files\Java\openjdk-17.jdk</code></p>
</div>
</div>
<div class="sect3">
<h4 id="installation">Installation</h4>
<div class="paragraph">
<p>Download the appropriate binary distribution for your system using our <a href="https://mobi.inovexcorp.com/features/#download">download site</a>.</p>
</div>
<div class="paragraph">
<p>The Mobi distribution comes packaged as a <code>.zip</code> file for Windows and a <code>tar.gz</code> file for Linux/OSX. Extract this file to a new directory on your system. For example, in <code>C:\Mobi</code> - from now on this directory will be referenced as <code>$MOBI_HOME</code>.</p>
</div>
<div class="paragraph">
<p>Open a command line console and change the directory to <code>$MOBI_HOME</code>.</p>
</div>
<div class="paragraph">
<p>To start the Mobi server, run the following command in Windows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-powershell hljs" data-lang="powershell">&gt; cd %MOBI_HOME%
&gt; bin\start.bat</code></pre>
</div>
</div>
<div class="paragraph">
<p>or for Linux/OSX:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ cd $MOBI_HOME
$ ./bin/start</code></pre>
</div>
</div>
<div class="paragraph">
<p>All Mobi prepackaged bundles, services, and required artifacts and dependencies will be automatically deployed by the runtime once started.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
You can check the status of the running server using the <code>bin/status</code> script or access the <a href="#mobi-shell-guide">Mobi shell</a> using the <code>bin/client</code> script (that&#8217;s <code>bin\status.bat</code> and <code>bin\client.bat</code> for you Windows users). If you are having problems starting Mobi, check the log files in <code>$MOBI_HOME\data\log</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The Mobi web application should now be accessible at <code><a href="https://localhost:8443/mobi/index.html" class="bare">https://localhost:8443/mobi/index.html</a></code>. The default login credentials are <code>admin:admin</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Due to the self-signed SSL certificate that Mobi comes with, your browser will likely show you a certificate warning when first loaded. This is safe to proceed past. See <a href="#configure_custom_ssl_certificates">Configure Custom SSL Certificates</a> for more details.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="installing_the_docker_image">Installing the Docker Image</h3>
<div class="paragraph">
<p>The easiest way to get started with Mobi on Docker is to download and install <a href="https://docs.docker.com/get-docker/" class="bare">https://docs.docker.com/get-docker/</a>.
If you are using Mac or Windows Operating System, Docker Desktop will be available for use which provides a Dashboard GUI to manage docker images. If you are using a Linux operating system, you will interact with Docker via terminal commands.</p>
</div>
<div class="paragraph">
<p>Mobi is available as a preconfigured Docker image on Docker Hub: <a href="https://hub.docker.com/r/inovexis/mobi/" class="bare">https://hub.docker.com/r/inovexis/mobi/</a>.   You can find the Mobi image by searching for our organization "inovexis" in the DockerHub search bar.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/docker_hub_mobi.png" alt="DockerHub Mobi Page">
</div>
<div class="title">Figure 1. DockerHub Mobi Page</div>
</div>
<div class="paragraph">
<p>On this page you will see the <code>docker pull</code> command.  Open up a terminal and execute the command to pull the Mobi Docker image.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">~ % docker pull inovexis/mobi
Using default tag: latest
latest: Pulling from inovexis/mobi
6d827a3ef358: Pull complete
2726297beaf1: Pull complete
7d27bd3d7fec: Pull complete
e61641c845ed: Pull complete
cce4cca5b76b: Pull complete
6826227500b0: Pull complete
c03b117ffd91: Pull complete
821a1547b435: Pull complete
2bd47f6b1b42: Pull complete
e4cf3e9f705c: Pull complete
3733107c5c01: Pull complete
4a9bdb07bcd2: Pull complete
cb3da7c9fe66: Pull complete
Digest: sha256:f387dd12cc2235150a2dd03b2741f01baf872f771ea8fb7e61ebf8bd4acb2155
Status: Downloaded newer image for inovexis/mobi:latest
docker.io/inovexis/mobi:latest</code></pre>
</div>
</div>
<div class="paragraph">
<p>To verify that the image was pulled correctly, you can run the command below to view all pulled images.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">docker images -a
REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
inovexis/mobi       latest              6a5c8e447ec0        3 months ago        795MB</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can then run Mobi using the standard <code>docker run</code> command.  We recommend running Mobi on port 8443 rather than the random default value.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">% docker run -dp 8443:8443 inovexis/mobi
fb324e907ad8254e587e88e1014291850050ed8d6493463a8dabdd8ac9367430</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once you&#8217;ve created a container with the Mobi Docker image, you can go to Docker Dashboard to see image running.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/docker_dashboard.png" alt="Docker Dashboard">
</div>
<div class="title">Figure 2. Docker Dashboard</div>
</div>
<div class="paragraph">
<p>You can also look in the terminal for the Mobi container running.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">% docker container list
CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                    NAMES
9abedac96a93        inovexis/mobi       "/usr/local/bin/mvn-…"   4 seconds ago       Up 2 seconds        0.0.0.0:8443-&gt;8443/tcp   flamboyant_panini</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Mobi image should now be running with the web application accessible at <code><a href="https://localhost:8443/mobi/index.html" class="bare">https://localhost:8443/mobi/index.html</a></code>.  The default login credentials are <code>admin:admin</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Due to the self-signed SSL certificate that Mobi comes with, your browser will likely show you a certificate warning when first loaded. This is safe to proceed past. See <a href="#configure_custom_ssl_certificates">Configure Custom SSL Certificates</a> for more details.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can use the CLI tool to login in karaf.  Once you click on the CLI button, it will open up a terminal window where you can login into karaf.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/docker_dashboard_cli.png" alt="DockerHub Mobi Page">
</div>
<div class="title">Figure 3. Docker Dashboard CLI</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">user@machine ~ % docker exec -it fb324e907ad8254e587e88e1014291850050ed8d6493463a8dabdd8ac9367430 /bin/sh; exit
# ls -al # command to list directories
total 24
drwxr-xr-x 1 root root 4096 Jul 23 21:52 .
drwxr-xr-x 1 root root 4096 Jul 23 21:52 ..
drwxr-xr-x 1 root root 4096 Oct 29 15:43 mobi-distribution-1.17.78
# ./mobi-distribution-x.xx.xx/bin/client # command to login into karaf
Logging in as karaf




                       @@@@@
                      @#####@
                      @#####@
                     @@@@@@&amp;
    &amp;@%           @@@@@@@                       _     _
  @/,,,&amp;@@@@@@@@@&amp;   @@         _ __ ___   ___ | |__ (_)
  @,,,,,@@@@@@.     &amp;@         | '_ ` _ \ / _ \| '_ \| |
  @,,,,/@      @@&amp;  @@         | | | | | | (_) | |_) | |
    @*@           @@@@         |_| |_| |_|\___/|_.__/|_|
                   &amp;@@
                    @@@
                    @&amp;//@@
                   @//////@
                   @%////@@
                    @@@@@

  mobi (x.xx.xx).
  Powered by Apache Karaf

Hit '&lt;tab&gt;' for a list of available commands
and '[cmd] --help' for help on a specific command.
Hit '&lt;ctrl-d&gt;' or 'osgi:shutdown' to shutdown mobi.


karaf@mobi()&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>To start or stop the container, you could either use the terminal or Docker Dashboard GUI.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">docker container start {container id for mobi}
docker container stop {container id for mobi}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="user_guide">User Guide</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Mobi web application currently has seven main modules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the <a href="#catalog-guide">Catalog</a></p>
</li>
<li>
<p>the <a href="#ontology-editor-guide">Ontology Editor</a>,</p>
</li>
<li>
<p>the <a href="#shapes-editor-guide">Shapes Editor</a></p>
</li>
<li>
<p>the <a href="#merge-requests-guide">Merge Requests module</a></p>
</li>
<li>
<p>the <a href="#mapping-tool-guide">Mapping Tool</a>,</p>
</li>
<li>
<p>the <a href="#datasets-manager-guide">Datasets Manager</a>,</p>
</li>
<li>
<p>and the <a href="#discover-guide">Discover Page</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The web application also has a <a href="#my-account-guide">My Account</a> page to configure various settings and preferences of the logged in user and a <a href="#administration-guide">Administration</a> page for admin users to configure user accounts and groups. The <a href="#configuration-guide">Configuration</a> for the Mobi software itself is set in configuration files. The <a href="#mobi-shell-guide">Mobi Shell</a> also provides several commands for accessing the application data. The home page of Mobi includes some quick action buttons for performing common tasks and a display of the latest key activities performed by users throughout the application. Each activity displays a summary about the action performed, who did it, and when it happened. The list is sorted with the latest activities first and is paginated so you can view earlier actions.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/home/home_page.png" alt="The home page of Mobi">
</div>
<div class="title">Figure 4. The Home Page</div>
</div>
<div class="paragraph">
<p>Additionally, the activity display has a tab to view a filtered list of the current user&#8217;s activities.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/home/activity_view.png" alt="My Activity">
</div>
<div class="title">Figure 5. My Activity</div>
</div>
<div class="paragraph">
<p>Mobi Enterprise also has a <a href="#vocabulary-linking">Vocabulary Linking</a> module for discovering relationships between vocabularies for enhanced semantic integration.</p>
</div>
<div class="sect2">
<h3 id="catalog-guide">Catalog</h3>
<div class="paragraph">
<p>The Mobi web-based Catalog allows users to publish data, dataset descriptions, analytics and other resources. It allows users to control the way their data is shared.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Federation of catalogs in Mobi is coming soon!
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To reach the Catalog click on the link in the left menu.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/catalog/full_catalog_initial_view.png" alt="full catalog initial view">
</div>
<div class="title">Figure 6. The Catalog</div>
</div>
<div class="paragraph">
<p>The Local Catalog of Mobi contains all Records contained within your Mobi node. This includes all versioned ontologies created in the <a href="#ontology-editor-guide">Ontology Editor</a>, versioned mappings created in the <a href="#mapping-tool-guide">Mapping Tool</a>, versioned shapes graphs created in the <a href="#shapes-editor-guide">Shapes Editor</a>, and all datasets created in the <a href="#datasets-manager-guide">Datasets Manager</a>.</p>
</div>
<div class="paragraph">
<p>There are two main views of the Catalog:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the <a href="#catalog_landing_page">Catalog Landing Page</a></p>
</li>
<li>
<p>the <a href="#record_view">Record View</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="catalog_landing_page">Catalog Landing Page</h4>
<div class="imageblock">
<div class="content">
<img src="images/catalog/catalog_landing_page.png" alt="catalog landing page">
</div>
<div class="title">Figure 7. The Catalog Landing Page</div>
</div>
<div class="paragraph">
<p>The landing page of the Catalog displays a paginated list of all the Records in the Local Catalog that can be searched, sorted, and filtered.
The filters on the left contain all possible types of Records, any user who has created a record, and all possible user keywords.
The search bar allows you to perform a text search through all the Record metadata.</p>
</div>
<div class="paragraph">
<p>Each Record in the list is displayed as a card with the Record title, type with related icon, date last modified, description, and keywords.
Clicking on the title of the Record will copy its unique identifier (IRI).
The footer of each Record card shows the username of its creator and a button to open that Record in its respective module (ontologies in the <a href="#ontology-editor-guide">Ontology Editor</a>, etc.).
Clicking on the Record card will open it in the <a href="#record_view">Record View</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="record_view">Record View</h4>
<div class="imageblock">
<div class="content">
<img src="images/catalog/record_view.png" alt="record view">
</div>
<div class="title">Figure 8. The Record View</div>
</div>
<div class="paragraph">
<p>The Record View displays all metadata for the selected Record along with set of tabs that updates based on the type of Record. The top of the Record view shows the Record title, type icon, and its description. The Record description is meant to provide a short summary of the Record. The right side of the view displays the created and modified dates of the Record along with its keywords and a button to open the Record in its associated module (ontologies in the <a href="#ontology-editor-guide">Ontology Editor</a>, etc.).</p>
</div>
<div class="paragraph">
<p>Every Record type will contain an Overview tab where you can view a Markdown description of the Record that provides more detailed information than the description field. If the Record is a Versioned RDF Record, such as an Ontology Record or Mapping Record, the tabset will also include a tab displaying the list of its Branches. The Branches in the list are expandable to view the description and commit history of the Branch. The Activity tab will show a list of activities associated with the Record.</p>
</div>
<div class="paragraph">
<p>If you have the permission to manage the Record, clicking on the title, description, overview, and keywords fields will turn them into editable fields for easy updates. In addition, you will see a <b class="button">Manage</b> button which will navigate you to the Record Permissions page.</p>
</div>
</div>
<div class="sect3">
<h4 id="record_permissions">Record Permissions</h4>
<div class="paragraph">
<p>The Record Permissions page enables you to specify which users and groups can perform various actions against a record, such as viewing, deleting, modifying, and managing. <strong>Modify</strong> refers to the ability to affect the data represented by the record while <strong>Manage</strong> refers to the ability to edit the Record metadata. Versioned RDF Records like Ontologies and Mappings will also provide the ability to restrict who can modify the MASTER branch. Each type of Record has its own default permissions that get set uploaded or created.</p>
</div>
<div class="paragraph">
<p>Permissions can be set to allow all authenticated users (the Everyone slider) or limit access to specific users and groups. To set the permission to a user or group, unselect the Everyone permission, find a user or group in the search box underneath the appropriate box, and select it. To remove a user or group from the permission, click the X button next to the username or group title. After you have finished making the changes you want, make sure to click the save button in the bottom right.  You can also click on the back button if you want to go back to the Record View.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/catalog/record_view_permission.png" alt="record view permission">
</div>
<div class="title">Figure 9. Editing an Record Permission</div>
</div>
<div class="paragraph">
<p>For Versioned RDF records, If a user is not allowed to modify the branch they are currently viewing, all actions in the editor that would affect the branch are disabled or removed. In addition, if a user is not allowed to edit the target branch of a <a href="#merge-requests-guide">merge request</a>, they will not be able to accept the request.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ontology-editor-guide">Ontology Editor</h3>
<div class="paragraph">
<p>The Mobi web-based ontology editor provides a Distributed Ontology Management System (DOMS) for local and community development of Web Ontology Language (<a href="https://www.w3.org/TR/owl2-overview/">OWL</a>) ontologies. The DOMS features a customizable user interface, knowledge capture, collaboration, access policy management, ontology reuse, and extensibility.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The community distribution of ontologies in Mobi is coming soon!
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To reach the ontology editor, click on the link in the left menu.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ontology-editor/full_editor_initial_view.png" alt="The Ontology Editor">
</div>
<div class="title">Figure 10. The Ontology Editor</div>
</div>
<div class="paragraph">
<p>The initial view of the Ontology Editor shows the Ontologies page. The center of the page contains a paginated list of all ontologies in the local Mobi repository. Each ontology in the list displays ontology metadata and an action menu. The action menu allows you to download or delete the ontology. Downloading the ontology from this location will download the HEAD commit of the MASTER branch. Deleting an ontology from this location will delete the ontology and associated ontology record and change history from the local catalog. Clicking an ontology will open it in the editor.</p>
</div>
<div class="paragraph">
<p>When opening an ontology, the editor will load the previous branch and commit you were viewing. If you have not previously opened the ontology or the branch you were viewing no longer exists, then the editor will load the HEAD commit of the ontology&#8217;s master branch. For an explanation of commits and branches see the section on
<a href="#ontology_versioning">Ontology Versioning</a>.</p>
</div>
<div class="paragraph">
<p>From this screen you can also filter the ontology list, <a href="#creating_new_ontologies">create new ontologies</a>, or
<a href="#uploading_existing_ontologies">upload existing ones</a>.</p>
</div>
<div class="sect3">
<h4 id="creating_new_ontologies">Creating New Ontologies</h4>
<div class="paragraph">
<p>To create a new ontology, select the <b class="button">New Ontology</b> button on the main ontology editor view. In the creation dialog, you are required to provide an ontology IRI and title. You can also optionally provide a description and keywords. This metadata is used to describe the ontology in the local catalog.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/ontology-editor/new_ontology_form.png" alt="new ontology form" width="50%">
</div>
<div class="title">Figure 11. New Ontology Form</div>
</div>
<div class="paragraph">
<p>The <span class="underline">Ontology IRI</span> is the unique identifier for the new ontology. The editor pre-populates this field with a default namespace and a local name generated from the <span class="underline">Title</span> field. You can always override this behavior. The <span class="underline">Title</span> field populates the <code>dcterms:title</code> annotations of both the new ontology record and the ontology object within the new ontology. The <span class="underline">Description</span> field populates the <code>dcterms:description</code> annotations of both the new ontology record and the ontology object within the new ontology. The <span class="underline">Keywords</span> field will attach the entered values as keywords to the new ontology record.</p>
</div>
</div>
<div class="sect3">
<h4 id="uploading_existing_ontologies">Uploading Existing Ontologies</h4>
<div class="paragraph">
<p>To upload an existing ontology, you can either click the <b class="button">Upload Ontology</b> button and use the browser&#8217;s native file browser or drag and drop files onto the main ontologies view.</p>
</div>
<div class="paragraph">
<p>When uploading a file or files, a dialog box will prompt you for metadata entry for the ontology record (title, description, keywords). This metadata is used to describe the ontology in the local catalog. By default, the application will set the record title using the filename. Metadata for each ontology can be entered and submitted separately, or default metadata can be entered for all records using the <b class="button">Submit All</b> button.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/ontology-editor/upload_metadata_form.png" alt="upload metadata form" width="50%">
</div>
<div class="title">Figure 12. Ontology upload metadata form.</div>
</div>
<div class="paragraph">
<p>Once all metadata has been submitted, a panel will be shown in the bottom right of the page which shows the status for each upload. Any errors will be detailed for each file. To refresh the main ontologies list with the new files, close the upload panel.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/ontology-editor/upload_ontology_results.png" alt="upload ontology results" width="50%">
</div>
<div class="title">Figure 13. Ontology upload results.</div>
</div>
<div class="paragraph">
<p>Supported ontology file types are <code>.owl</code>, <code>.ttl</code>, <code>.xml</code>, <code>.jsonld</code>, <code>.owx</code>, <code>.json</code>, <code>.n3</code>, <code>.nq</code>, <code>.nt</code>, <code>.rdf</code>, <code>.txt</code>, <code>.json</code>, <code>.ofn</code>, <code>.omn</code> , <code>.owx</code>, and <code>.rdfs</code>. The <span class="underline">Title</span> field populates the <code>dcterms:title</code> annotation of the new ontology record. The <span class="underline">Description</span> field populates the <code>dcterms:description</code> annotation of the new ontology record. The <span class="underline">Keywords</span> field will attach the entered values as keywords to the new ontology record. The file extension is used to guess the appropriate RDF Format to parse the file contents. If a parsing error occurs, the snackbar will display the error message relevant to guessed RDF Format.</p>
</div>
</div>
<div class="sect3">
<h4 id="editing_an_ontology">Editing an Ontology</h4>
<div class="paragraph">
<p>The Ontology Editor provides an interface for developing <a href="https://www.w3.org/TR/owl2-overview/">OWL 2</a> ontologies with additional features directed towards developing Simple Knowledge Organization System (<a href="https://www.w3.org/2004/02/skos/">SKOS</a>) vocabularies and extensions thereof, including support for (<a href="https://www.w3.org/TR/skos-reference/skos-xl.html">SKOS-XL</a>)</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
To learn more about OWL ontologies, see the <a href="https://www.w3.org/TR/2012/REC-owl2-syntax-20121211/">W3C Specification</a>. To learn more about SKOS vocabularies, see the <a href="https://www.w3.org/TR/skos-reference/">W3C Specification</a>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The Ontology Editor contains various tabs supporting activities for ontology development, search, and version control.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ontology-editor/full_editor_ontology_view.png" alt="full editor ontology view">
</div>
<div class="title">Figure 14. Ontology Editor</div>
</div>
<div class="paragraph">
<p>This section will describe the tools related to ontology development activities. These include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the <a href="#ontology_project_tab">Ontology Project Tab</a></p>
</li>
<li>
<p>the <a href="#overview_tab">Overview Tab</a></p>
</li>
<li>
<p>the <a href="#classes_tab">Classes Tab</a></p>
</li>
<li>
<p>the <a href="#properties_tab">Properties Tab</a></p>
</li>
<li>
<p>the <a href="#individuals_tab">Individuals Tab</a></p>
</li>
<li>
<p>the optional <a href="#schemes_tab">Schemes Tab</a></p>
</li>
<li>
<p>the optional <a href="#concepts_tab">Concepts Tab</a></p>
</li>
<li>
<p>the <a href="#search_tab">Search Tab</a></p>
</li>
<li>
<p>the <a href="#visualization_tab">Visualization Tab</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <a href="#schemes_tab">Schemes Tab</a> and <a href="#concepts_tab">Concepts Tab</a> will appear if the editor detects that the opened ontology contains SKOS classes and properties. The easiest way to have access to these tabs is to import the SKOS ontology (<a href="http://www.w3.org/2004/02/skos/core" class="bare">http://www.w3.org/2004/02/skos/core</a>).</p>
</div>
<div class="paragraph">
<p>For a detailed description of the versioning components, refer to the <a href="#ontology_versioning">Ontology Versioning</a> section.</p>
</div>
<div class="sect4">
<h5 id="ontology_project_tab">Ontology Project Tab</h5>
<div class="paragraph">
<p>The Ontology Project Tab displays high-level information about the ontology. This includes the ontology annotations and properties, ontology imports, and a preview of the serialized ontology RDF.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ontology-editor/ontology_editor_tab_project.png" alt="ontology editor tab project">
</div>
<div class="title">Figure 15. Ontology Editor Project Tab</div>
</div>
<div class="paragraph">
<p>The top of this tab contains the title of the ontology and its IRI. The IRI shown is the Version IRI, Ontology IRI, or a blank node identifier. The IRI can be copied quickly by clicking on it.</p>
</div>
<div class="paragraph">
<p>On the upper left side of this tab is a section containing a list of all the applied OWL Ontology Properties and Annotations. There are controls included to add, remove, and edit these properties.</p>
</div>
<div class="paragraph">
<p>On the lower left side of this tab is a section containing a list of all direct and indirect ontology imports. If an imported ontology could not be resolved, it will appear red. To add a new imported ontology, click on the plus button and either enter the IRI of an ontology available on the web or select an ontology within Mobi. To refresh the cached versions of the imported ontologies and attempt to resolve any unresolved imports, click on the refresh button.</p>
</div>
<div class="paragraph">
<p>On the right of this tab is a card used to generate a preview of the ontology as RDF. There is a drop down with several different RDF serializations to choose from. Clicking <b class="button">Refresh</b> will generate a preview of the saved state of the ontology in the specified RDF format in the area below. The preview will be limited to the first 5000 results. Additionally, there is a button for downloading the ontology in the selected format.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
The serialized ontology is a representation of data stored in the repository and will not include unsaved changes.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="overview_tab">Overview Tab</h5>
<div class="paragraph">
<p>The Overview Tab provides quick access to classes and their associated properties as compared to the <a href="#classes_tab">Classes</a> and <a href="#properties_tab">Properties</a> tabs. Properties are associated to classes through the use of <code>rdfs:domain</code>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ontology-editor/ontology_editor_tab_overview.png" alt="ontology editor tab overview">
</div>
<div class="title">Figure 16. Ontology Editor Overview Tab</div>
</div>
<div class="paragraph">
<p>The left side of this tab contains the list of all classes and their associated properties, including imports. Any properties that have no <code>rdfs:domain</code> are grouped into a folder in the hierarchy called "Properties". You can expand a class to view its properties by clicking the "+" icon or double-clicking the class name. Properties are displayed with a symbol representing the data type of the range property. If an entity has been changed and those changes have not been committed, it will appear bold and an indicator will be shown on the right of the entity name. Imported classes and properties will appear grey and italicized.
The list also includes a search bar that will filter the list to classes/properties with annotations or local names containing your search query and the ability to apply one or more filters.
The <b class="button">Hide unused imports</b> filter will remove all imported entities from the list that are not used by any of the entities defined in the ontology.
The <b class="button">Hide deprecated entities</b> filter will remove all entities annotated with the owl:deprecated property.
Clicking on an item in the tree will load that entity&#8217;s information into the other sections in this tab.</p>
</div>
<div class="paragraph">
<p>The title of the selected class or property, its IRI, and its type(s) are displayed at the top of the tab along with buttons to delete the entity and view its change history (see <a href="#entity_history">Entity History</a>). The IRI can be copied quickly by clicking on it. The middle sections in this tab allow you to add, remove, and edit Annotations and Axioms for the selected class or property. Imported classes and properties cannot be edited.</p>
</div>
<div class="paragraph">
<p>If you selected a property, a section with checkboxes for adding different characteristics to the selected property is shown in the top right of the Overview Tab.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
See the <a href="https://www.w3.org/TR/2012/REC-owl2-syntax-20121211/">W3C Specification</a> for the definitions of property characteristics.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The last section on the right displays all the locations where the selected entity is used within the saved state of the ontology. For classes, this is anywhere the selected class is used as the object of a statement. For properties, this is anywhere the selected property is used as the predicate or object of a statement. Usages are grouped by the predicate of the statement and can be collapsed by clicking on the predicate title. Links in the usages section, as with links in various other components of the editor, can be clicked to navigate to that entity. If the number of usages exceeds 100, a button to load the next 100 is shown at the bottom of the section.</p>
</div>
</div>
<div class="sect4">
<h5 id="classes_tab">Classes Tab</h5>
<div class="paragraph">
<p>The Classes Tab allows you to view, create, and delete classes in the opened ontology.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ontology-editor/ontology_editor_tab_classes.png" alt="ontology editor tab classes">
</div>
<div class="title">Figure 17. Ontology Editor Classes Tab</div>
</div>
<div class="paragraph">
<p>The left side of the tab contains a hierarchical view of the classes, including imports, nested according to their <code>rdfs:subClassOf</code> property. That is, a class&#8217;s children are classes which are defined as subclasses of the particular class. Since classes can be defined as a subclass of multiple classes, they may appear several times within the hierarchy. If a class has been changed and those changes have not been committed, it will appear bold and an indicator will be shown on the right of the class name. Imported classes will appear grey and italicized.
The list also includes a search bar that will filter the list to classes with annotations or local names containing your search query and the ability to apply one or more filters.
The <b class="button">Hide unused imports</b> filter will remove all imported classes from the list that are not used by any of the entities defined in the ontology.
The <b class="button">Hide deprecated entities</b> filter will remove all classes annotated with the owl:deprecated property.
Clicking on an item in the hierarchy will load that class&#8217;s information into the other sections in this tab. Double clicking on a class with children will toggle the display of the children.</p>
</div>
<div class="paragraph">
<p>The title of the selected class, its IRI, and its type(s) are displayed at the top of the tab along with buttons to delete the class and view its change history (see <a href="#entity_history">Entity History</a>). The IRI can be copied quickly by clicking on it. The middle sections in this tab allow you to add, remove, and edit Annotations and Axioms for the selected class. Imported classes cannot be edited.</p>
</div>
<div class="paragraph">
<p>The section on the right of the Classes Tab displays all the locations where the selected class is used within the saved state of the ontology. That is, anywhere the selected class is used as the object of a statement. Usages are grouped by the predicate of the statement and can be collapsed by clicking on the predicate title. Links in the usages section, as with links in various other components of the editor, can be clicked to navigate to that entity. If the number of usages exceeds 100, a button to load the next 100 is shown at the bottom of the section.</p>
</div>
</div>
<div class="sect4">
<h5 id="properties_tab">Properties Tab</h5>
<div class="paragraph">
<p>The Properties Tab allows you to view, create, and delete properties in the opened ontology.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ontology-editor/ontology_editor_tab_properties.png" alt="ontology editor tab properties">
</div>
<div class="title">Figure 18. Ontology Editor Properties Tab</div>
</div>
<div class="paragraph">
<p>The left side of the tab contains a hierarchical view of the data, object, and annotation properties, including imports. The data, object, and annotation properties are grouped into three separate folders within the hierarchy that will open and close when clicked. Properties are nested according to their <code>rdfs:subPropertyOf</code> property. That is, a property&#8217;s children are properties which are defined as subproperties of the particular property. Properties are displayed with a symbol representing the data type of the range property. If a property has been changed and those changes have not been committed, it will appear bold and an indicator will be shown on the right of the property name.  Imported properties will appear grey and italicized.
The list also includes a search bar that will filter the list to properties with annotations or local names containing your search query and the ability to apply one or more filters.
The <b class="button">Hide unused imports</b> filter will remove all imported properties from the list that are not used by any of the entities defined in the ontology.
The <b class="button">Hide deprecated entities</b> filter will remove all properties annotated with the owl:deprecated property.
Clicking on an item in the hierarchy will load that property&#8217;s information into the other sections in this tab. Double clicking on a property with children will toggle the display of the children.</p>
</div>
<div class="paragraph">
<p>The title of the selected property, its IRI, and its type(s) are displayed at the top of the tab along with buttons to delete the property and view its change history (see <a href="#entity_history">Entity History</a>). The IRI can be copied quickly by clicking on it. The middle sections in this tab change depending on whether you have selected a data, object, or annotation property. If the selected property is a data or object property, the sections for adding, removing, and editing Annotations and Axioms are shown. If the selected property is an annotation property, only the Annotation sections is shown. Imported properties cannot be edited.</p>
</div>
<div class="paragraph">
<p>If the selected property is a data or object property, a block with checkboxes for adding different characteristics to the selected property is shown in the top right of the Properties Tab. Imported properties cannot be edited.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ontology-editor/object_property_tab.png" alt="object property tab">
</div>
<div class="title">Figure 19. Object Property View</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
See the <a href="https://www.w3.org/TR/2012/REC-owl2-syntax-20121211/">W3C Specification</a> for the definitions of property characteristics.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The last section on the right of the tab displays all the locations where the selected property is used within the saved state of the ontology. That is, anywhere the selected property is used as the predicate or object of a statement. Usages are grouped by the predicate of the statement and can be collapsed by clicking on the predicate title. Links in the usages section, as with links in various other components of the editor, can be clicked to navigate to that entity. If the number of usages exceeds 100, a button to load the next 100 is shown at the bottom of the section.</p>
</div>
</div>
<div class="sect4">
<h5 id="individuals_tab">Individuals Tab</h5>
<div class="paragraph">
<p>The Individuals Tab allows you to view, edit, create, and delete individuals in the opened ontology.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ontology-editor/ontology_editor_tab_individuals.png" alt="ontology editor tab individuals">
</div>
<div class="title">Figure 20. Ontology Editor Individuals Tab</div>
</div>
<div class="paragraph">
<p>The left side of the tab contains a view of all individuals, including imports, nested under their classes based on the <code>rdfs:subClassOf</code> property. If an individual has been changed and those changes have not been committed, it will appear bold and an indicator will be shown on the right of the individual name. Imported individuals will appear grey and italicized.
The list also includes a search bar that will filter the list to individuals with annotations or local names containing your search query and the ability to apply one or more filters.
The <b class="button">Hide unused imports</b> filter will remove all imported individuals from the list that are not used by any of the entities defined in the ontology.
The <b class="button">Hide deprecated entities</b> filter will remove all individual annotated with the owl:deprecated property.
Clicking on an item in the list will load that individual&#8217;s information into the other sections in this tab.</p>
</div>
<div class="paragraph">
<p>The title of the selected individual, its IRI, and its type(s) are displayed at the top of the tab along with buttons to delete the individual and view its change history (see <a href="#entity_history">Entity History</a>). The IRI can be copied quickly by clicking on it. The section to the center and right of the tab allow you to add, remove, and edit Data, Object, and Annotation Properties for the selected individual. The options for Data and Object Properties are populated from the ontology and its imports. The user entered values in both the annotation and datatype property overlays are validated against the type field of the overlay. Imported individuals cannot be edited.</p>
</div>
<div class="paragraph">
<p>The types of an individual are editable by clicking the pencil icon at the end of the types list. The overlay allows you to add and remove types from the ontology and its imports. The "Named Individual" type is required.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/ontology-editor/edit_individual_types.png" alt="edit individual types" width="50%">
</div>
<div class="title">Figure 21. Edit Individual Types Overlay</div>
</div>
</div>
<div class="sect4">
<h5 id="schemes_tab">Schemes Tab</h5>
<div class="paragraph">
<p>The Schemes Tab will appear if the editor detects the opened ontology is a SKOS vocabulary. It displays information about all the concept schemes and their directly related concepts defined in the opened vocabulary.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ontology-editor/ontology_editor_tab_schemes.png" alt="ontology editor tab schemes">
</div>
<div class="title">Figure 22. Ontology Editor Schemes Tab</div>
</div>
<div class="paragraph">
<p>The left side of the tab contains a hierarchical view of the concept schemes, including imports. The top level items are the concept schemes, or subclasses of <code>skos:ConceptScheme</code>, and their children are all concepts, or subclasses of <code>skos:Concept</code>, within that scheme. This could be defined through the <code>skos:hasTopConcept</code>, <code>skos:topConceptOf</code>, or <code>skos:inScheme</code> properties. If a concept scheme or concept has been changed and those changes have not been committed, it will appear bold and an indicator will be shown on the right of its name. Imported concept schemes and concepts will appear grey and italicized.
The list also includes a search bar that will filter the list to concepts/schemes with annotations or local names containing your search query and the ability to apply one or more filters.
The <b class="button">Hide unused imports</b> filter will remove all imported schemes from the list that are not used by any of the entities defined in the ontology.
The <b class="button">Hide deprecated entities</b> filter will remove all schemes annotated with the owl:deprecated property.
Clicking on an item in the hierarchy will load that concept scheme&#8217;s or concept&#8217;s information in the other sections in this tab. Double clicking on a concept scheme with children will toggle the display of the children.</p>
</div>
<div class="paragraph">
<p>The title of the selected concept scheme or concept, its IRI, and its type(s) are displayed at the top of the tab along with buttons to delete the entity and view its change history (see <a href="#entity_history">Entity History</a>). The IRI can be copied quickly by clicking on it. The middle sections in this tab allow you to add, remove, and edit Annotations, Data Properties, and Object Properties for the selected concept scheme or concept. Imported concept schemes and concepts cannot be edited.</p>
</div>
<div class="paragraph">
<p>The third section on the right of the Schemes Tab displays all the locations where the selected concept scheme or concept is used within the saved state of the vocabulary. This is anywhere the selected concept scheme or concept is used as the object of a statement. Usages are grouped by the predicate of the statement and can be collapsed by clicking on the predicate title. Links in the usages section, as with links in various other components of the editor, can be clicked to navigate to that entity. If the number of usages exceeds 100, a button to load the next 100 is shown at the bottom of the section.</p>
</div>
</div>
<div class="sect4">
<h5 id="concepts_tab">Concepts Tab</h5>
<div class="paragraph">
<p>The Concepts Tab will appear if the editor detects the opened ontology is a SKOS vocabulary. The Concepts Tab displays information about all the concepts defined in the opened vocabulary.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ontology-editor/ontology_editor_tab_concepts.png" alt="ontology editor tab concepts">
</div>
<div class="title">Figure 23. Ontology Editor Concepts Tab</div>
</div>
<div class="paragraph">
<p>The left side of the tab contains a hierarchical view of the concepts, including imports. The concept hierarchy is determined using all of the SKOS broader and narrower properties. If a concept scheme or concept has been changed and those changes have not been committed, it will appear bold and an indicator will be shown on the right of its name. Imported concepts will appear grey and italicized.
The list also includes a search bar that will filter the list to concepts with annotations or local names containing your search query and the ability to apply one or more filters.
The <b class="button">Hide unused imports</b> filter will remove all imported concepts from the list that are not used by any of the entities defined in the ontology.
The <b class="button">Hide deprecated entities</b> filter will remove all concepts annotated with the owl:deprecated property.
Clicking on an item in the hierarchy will load that concept&#8217;s information in the other sections in this tab. Double clicking on a concept with children will toggle the display of the children.</p>
</div>
<div class="paragraph">
<p>The title of the selected concept, its IRI, and its type(s) are displayed at the top of the tab along with buttons to delete the concept and view its change history (see <a href="#entity_history">Entity History</a>). The IRI can be copied quickly by clicking on it. The middle blocks in this tab allow you to add, remove, and edit Annotations, Data Properties, and Object Properties for the selected concept. Imported concepts cannot be edited.</p>
</div>
<div class="paragraph">
<p>The third section on the right of the Concepts Tab displays all the locations where the selected concept is used within the saved state of the vocabulary. This is anywhere the selected concept is used as the object of a statement. Usages are grouped by the predicate of the statement and can be collapsed by clicking on the predicate title. Links in the usages section, as with links in various other components of the editor, can be clicked to navigate to that entity. If the number of usages exceeds 100, a button to load the next 100 is shown at the bottom of the section.</p>
</div>
</div>
<div class="sect4">
<h5 id="search_tab">Search Tab</h5>
<div class="paragraph">
<p>The Search Tab has two views, Find and Query, accessible through the dropdown. By default, clicking on the Search Tab will take you to the Find View.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ontology-editor/search_tab_dropdown.png" alt="search tab dropdown">
</div>
<div class="title">Figure 24. Search Tab Dropdown</div>
</div>
<div class="sect5">
<h6 id="find_view">Find View</h6>
<div class="paragraph">
<p>The Find view allows you to perform a keyword search through all the entities within the saved state of the opened ontology and its imports.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ontology-editor/ontology_editor_tab_search.png" alt="ontology editor tab search">
</div>
<div class="title">Figure 25. Ontology Editor Search Tab</div>
</div>
<div class="paragraph">
<p>The left side of the Find view contains a simple search bar and a list of search results. To perform a search, type a string into the search bar and press the <kbd>ENTER</kbd> key. The results are separated by type headers which are collapsible. Each result is displayed with its display name. Properties are displayed with a symbol representing the data type of the range property. Clicking on a result will load that entity&#8217;s information into the right section of this tab. The right section displays the entity&#8217;s display name, IRI, types, and properties. The parts of the property values that match the search text will be highlighted. The right section also includes a <b class="button">Go To</b> button that will open the entity in the appropriate tab. Double clicking on an entity in the list will also open that entity in the appropriate tab.</p>
</div>
</div>
<div class="sect5">
<h6 id="query_view">Query View</h6>
<div class="paragraph">
<p>The Query view allows you to perform a SPARQL query against the opened ontology. Similar to the <a href="#query">Discover Query Page</a>, the ontology Query view provides a SPARQL query editor powered by the <a href="https://triply.cc/docs/yasgui/">YASGUI</a> SPARQL library. The top section of the page contains the query editor (powered by <a href="https://triply.cc/docs/yasgui-api#yasqe">YASQE</a>), a toggle of whether to include data from the entire imports closure, and a <b class="button">Submit</b> button. Clicking <b class="button">Submit</b> executes the entered query against the ontology and updates the bottom section with the results.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ontology-editor/search_tab_query.png" alt="search tab query">
</div>
<div class="title">Figure 26. Query View</div>
</div>
<div class="paragraph">
<p>The bottom section displays the results of the most recently submitted SPARQL query (powered by <a href="https://triply.cc/docs/yasgui-api#yasr">YASR</a>). The section has separate tabs for rendering the query result set depending on the type of SPARQL query submitted. SELECT query results are displayed under the Table tab where the headers of the table are the variables specified in the SPARQL query. The Table comes with features such as filtering, page size, sorting and pagination. CONSTRUCT query results can be displayed under the Turtle, JSON-LD and RDF/XML tabs. The query results are limited to 500 triples/rows for rendering, but the entire result set can be downloaded using the button in the upper right corner of the bottom section.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ontology-editor/search_tab_query_construct.png" alt="search tab query construct">
</div>
<div class="title">Figure 27. Construct Query</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="visualization_tab">Visualization Tab</h5>
<div class="paragraph">
<p>The Visualization Tab depicts the ontology in a force-directed graph layout. Each node represents a class, with dotted lines symbolizing the relationship between parent class and subclass, and solid lines representing the object properties.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ontology-editor/visualization/pizza_graph.png" alt="pizza graph">
</div>
<div class="title">Figure 28. Pizza Ontology Graph</div>
</div>
<div class="paragraph">
<p>The ontology visualization feature enables users to easily understand data within an Ontology by allowing them to navigate across the classes and their relationships. The feature allows users to zoom, pan, select, drag, hover, and click nodes and links.</p>
</div>
<div class="paragraph">
<p>The number of classes displayed is limited to 500. Any in progress changes you have will not be rendered until they are committed. After initial graph calculation, the state of the graph will persist while users keep the Ontology open. The graph will only be re-rendered when there is a new commit.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ontology-editor/visualization/warning_commit_inprogress.png" alt="warning commit inprogress">
</div>
<div class="title">Figure 29. Uncommitted changes state</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ontology-editor/visualization/warning_over_node_limit.png" alt="warning over node limit">
</div>
<div class="title">Figure 30. Over the limit state</div>
</div>
<div class="paragraph">
<p>The side panel of the Visualization tab displays a searchable list of all the classes in the import closure (i.e. direct and imported) grouped by parent ontology. The checkboxes next to each class indicate whether a class is currently shown in the visualization and can be toggled to customize the displayed graph. Selecting the checkbox next to a class will update the graph by adding a new node with the class name, subclass relationships with other displayed classes, and object properties with other displayed classes. Deselecting the checkbox next to a class will remove these three things. Selecting a class in the side panel will highlight the node in the graph if displayed. Selecting a node in the graph will also highlight in the side panel. The side panel also includes a "Filter" dropdown with three options to help find the classes of interest in the list.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>“All” which is the default. When selected, the list of classes contains both classes declared in the opened ontology and imported classes</p>
</li>
<li>
<p>“Local” which will filter the list of classes to only those declared in the opened ontology when selected</p>
</li>
<li>
<p>“Imported” which will filter the list of classes to only those from imported ontologies</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ontology-editor/visualization/sidebard_imported_open.png" alt="sidebard imported open">
</div>
<div class="title">Figure 31. Side Panel: classes grouped by parent ontology</div>
</div>
<div class="paragraph">
<p>The side panel can be hidden or shown with a button.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ontology-editor/visualization/sidepanel_close_button.png" alt="sidepanel close button">
</div>
<div class="title">Figure 32. Side Panel Close Button</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ontology-editor/visualization/sidepanel_open_button.png" alt="sidepanel open button">
</div>
<div class="title">Figure 33. Side Panel Open Button</div>
</div>
<div class="sect5">
<h6 id="imported_ontologies">Imported Ontologies</h6>
<div class="paragraph">
<p>The rendered graph will include every ontology within the imports closure. The classes in the graph are rendered with different colors based on which ontology within the imports closure they belong to. If a change to an imported Ontology is made, the changes will not be rendered until a manual refresh is triggered which will reset the Ontology cache or until a new commit is made.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ontology-editor/visualization/imported_ontology.png" alt="imported ontology">
</div>
<div class="title">Figure 34. Imported Ontologies</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ontology-editor/visualization/update_imports.png" alt="update imports">
</div>
<div class="title">Figure 35. Refresh import</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="ontology_versioning">Ontology Versioning</h4>
<div class="paragraph">
<p>Each ontology in Mobi is versioned in a manner similar to the <a href="https://git-scm.com/">Git</a> Version Control System, whereby all changes to an ontology are collected into a chain "commits" which form a commit history called a "branch". Thus, every version in the history of an ontology can be generated by selecting a commit and applying all the changes in the branch back to the initial commit.</p>
</div>
<div class="paragraph">
<p>Every ontology is initialized with a MASTER branch that contains the initial commit. Work can be done on this MASTER branch or can be split out into separate branches. Work done on these branches occur in isolation until they are merged back into the MASTER branch, joining any other changes committed in the meantime. When merging two branches, the ontology editor does its best to combine any changes made on both branches. If a conflict occurs, the editor allows the user to resolve them manually. More information on merging branches can be found in the section on <a href="#merging_branches">Merging Branches</a>.</p>
</div>
<div class="sect4">
<h5 id="checking_out_branchestagscommits">Checking Out Branches/Tags/Commits</h5>
<div class="paragraph">
<p>The check out select box located underneath the selected ontology in the left display, provides a list of all the available branches and tags on the ontology. To checkout a branch or tag, simply select the branch in the drop-down menu. Checking out a tag will open the ontology at the tagged commit in read-only mode. If you have checked out a commit from the <a href="#commits_tab">Commits Tab</a>, the commit will be in the dropdown list and show as selected. Note that the select box will be disabled if you have any uncommitted changes on the current branch. To edit a branch name or description, click on the edit icon next to the branch in the drop-down menu. You cannot edit the master branch of an ontology.</p>
</div>
<table class="tableblock frame-none grid-none stretch center">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="images/ontology-editor/check_out_select.png" alt="check out select"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="images/ontology-editor/check_out_select_commit.png" alt="check out select commit"></span></p></td>
</tr>
</tbody>
</table>
<div class="imageblock">
<div class="content">
<img src="images/ontology-editor/check_out_tag.png" alt="check out tag">
</div>
<div class="title">Figure 36. Ontology checked out at a tag</div>
</div>
<div class="paragraph">
<p>To delete a branch or tag, click on the delete icon next to the branch/tag in the drop-down menu. If a branch is deleted, all commits on that branch that are not part of another branch will be removed, as well as the branch itself. If a tag is deleted, the commit is not removed. Note that these actions cannot be undone.</p>
</div>
</div>
<div class="sect4">
<h5 id="viewing_saved_changes">Viewing Saved Changes</h5>
<div class="paragraph">
<p>Every edit made to an entity within an ontology is automatically saved and an indicator is shown in the top right if the most recent changes have been saved successfully. The Changes Tab displays all saved and uncommitted changes in the opened ontology. Saving changes without committing allows a user to edit an ontology through a number of browser sessions before making any commits to the commit history. These changes are unique to the user, and are available to other users once a commit is performed.  They are grouped by individual entity and display the triples on the entity grouped by property.  When a “Show Full” toggle is active, the changes display is updated to include all the other triples on that changed entity.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ontology-editor/ontology_editor_tab_changes.png" alt="ontology editor tab changes">
</div>
<div class="title">Figure 37. Ontology Editor Changes Tab</div>
</div>
<div class="paragraph">
<p>Within each collapsible block in the list are the added and deleted triples for a particular entity IRI. If there are no changes to the ontology, this page will be empty. To commit these changes, select the <b class="button">Commit Changes</b> button in the <a href="#button_stack">Button Stack</a>. To remove these changes, click <b class="button">Remove All Changes</b>.</p>
</div>
<div class="paragraph">
<p>If new commits have been made to the branch by other users while you are editing or viewing an ontology, a warning symbol will be displayed in the section title and a message will be displayed in the section notifying you that there are new commits on the branch. If you have no saved changes, there will be a link to update the current ontology by pulling in the latest changes. If you have saved changes, there will be a message notifying you to either commit your changes or remove them. If you choose to commit your changes, you can still continue working and there will be a link to pull in the latest changes and re-sync with the branch.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ontology-editor/pull_latest_changes.png" alt="pull latest changes">
</div>
<div class="title">Figure 38. Pull in latest changes message</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ontology-editor/behind_head.png" alt="behind head">
</div>
<div class="title">Figure 39. Behind the head with saved changes</div>
</div>
</div>
<div class="sect4">
<h5 id="merging_branches">Merging Branches</h5>
<div class="paragraph">
<p>The Ontology Editor also supports merging the head commit of the branch you are currently viewing into the head commit of another branch. Two branches can only be merged if there are no conflicts between the head commits of each branch. To perform a merge, select the green <b class="button">Merge Branches</b> button in the button stack.</p>
</div>
<div class="paragraph">
<p>The merge view displays the name of the current (source) branch, a select box for the branch (target) you want to merge into, and a checkbox for whether or not you want the source branch to be deleted after it is merged. The view also shows an aggregated view of all changes made in the source branch that will be merged into the target branch along with a list of all the commits that will be added to the target branch from the source branch.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ontology-editor/merge_view.png" alt="merge view">
</div>
<div class="title">Figure 40. Merge branches view</div>
</div>
<div class="paragraph">
<p>Clicking <b class="button">Submit</b> will attempt to perform the merge. If there are no conflicts between the changes on both branches, a new commit will be created merging the two branches, and a success message will appear in the top right corner of the screen.</p>
</div>
<div class="paragraph">
<p>Conflicts arise when the application cannot determine how to automatically merge specific changes to entities between two branches. If conflicts exist between the two branches, the merge process will be halted and the screen will update to notify you of those conflicts and provide you a way to resolve them. Each conflict is listed by entity within the ontology and with a marker indicating whether or not it has been resolved. Click on a conflict in the list to start resolving them.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ontology-editor/merge_conflicts_main.png" alt="merge conflicts main">
</div>
<div class="title">Figure 41. List of all merge conflicts</div>
</div>
<div class="paragraph">
<p>When resolving a conflict, the tool displays the changes to the entity from both branches. To resolve the conflict, select the version of the entity you wish to keep. You can either click the <b class="button">Back to List</b> button to go back to the list of all the conflicts or the <b class="button">Previous</b> or <b class="button">Next</b> buttons to iterate through the list of conflicts.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Currently the editor only supports accepting entire changes. We are working on improvements to give more flexibility in resolving conflicts during a merge operation.
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ontology-editor/merge_conflicts_resolution.png" alt="merge conflicts resolution">
</div>
<div class="title">Figure 42. Merge conflict resolution view.</div>
</div>
<div class="paragraph">
<p>Once all conflicts have been resolved, the <b class="button">Submit with Resolutions</b> button will become active and you can complete the merge operation. Completing the merge will create a new commit that incorporates your conflict resolutions into the target branch, and displays a success message in the upper right corner of the screen.</p>
</div>
</div>
<div class="sect4">
<h5 id="commits_tab">Commits Tab</h5>
<div class="paragraph">
<p>The Commits Tab provides a graph of all the commits made in the history of the branch you are currently viewing. The username of the creator, ID, message, and date for each commit are displayed within the graph. The graph displays each commit connected to its parent commits continuing backwards until the initial commit. The graph displays any Tags associated with a commit and will also display the branch name associated with a merge if the branch still exists in the system. To view more information about a particular commit in the history, such as the added and deleted statements, click on its hash id to open an informational modal. The graph also includes commit dots for "checking out" a commit in the history. Clicking the Commit dot will open the ontology at that commit in read-only mode. This is useful for creating tags to indicate versions on the ontology (see <a href="#button_stack">Button Stack</a> and <a href="#checking_out_branchestagscommits">Checking Out Branches/Tags/Commits</a>).</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ontology-editor/commit_history_table.png" alt="commit history table">
</div>
<div class="title">Figure 43. Commit history table of a branch</div>
</div>
</div>
<div class="sect4">
<h5 id="entity_history">Entity History</h5>
<div class="paragraph">
<p>Clicking on a <b class="button">See History</b> button next to a selected entity in one of the tabs will open a view containing the change history of that specific entity in the ontology. The view is split into two columns. The left side contains a dropdown containing all the commits where that entity was changed and defaults to the latest commit. Any added triples will be green and any deleted triples will be red. The right side contains a table of all the commits where that entity was changed. The table behaves the same as the table in the <a href="#commits_tab">Commits Tab</a>, just without the graph. To return to the main editor, click the back button in the top left.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ontology-editor/entity_history.png" alt="entity history">
</div>
<div class="title">Figure 44. Entity History view</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="ontology_editor_reference">Ontology Editor Reference</h4>
<div class="sect4">
<h5 id="edit_iri_overlay">Edit IRI Overlay</h5>
<div class="paragraph">
<p>The Edit IRI overlay provides the user with a simple way to edit and create valid IRIs. The <span class="underline">Begins with</span> field (required) is the beginning of the IRI. This is more commonly known as the namespace. When editing the IRI of entities within an ontology, this value is typically the ontology IRI. The <span class="underline">Then</span> field (required) is the next character in the IRI. This value can be thought of the separator between the namespace and local name (described below). The provided values for the <span class="underline">Then</span> field are "&#35;", "/", and ":". The <span class="underline">Ends with</span> field (required) is the last part of the IRI. This value is commonly known as the local name. It is used in the drop down lists in this application as the easiest way to identify what the IRI references. Clicking the refresh button on the left will reset the three fields to their original values. You cannot create/save an edited IRI that already exists within the ontology. Clicking <b class="button">Cancel</b> will close the overlay. Clicking <b class="button">Submit</b> will save the IRI with the entered values for the selected entity and update the ontology.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ontology-editor/edit_iri_overlay.png" alt="edit iri overlay">
</div>
<div class="title">Figure 45. Edit IRI overlay</div>
</div>
</div>
<div class="sect4">
<h5 id="axiom_overlay">Axiom Overlay</h5>
<div class="paragraph">
<p>The Axiom Overlay is how you add new axioms to entities in your ontology. The <span class="underline">Axiom</span> dropdown provides a list of common axioms for the type of entity you have selected. Once selected, there are two ways to add a value. The first is choosing from a list of entities within the ontology and its imports. The second is writing out a class expression or restriction in <a href="https://www.w3.org/TR/owl2-manchester-syntax/">Manchester Syntax</a> in the Editor. Entities are referenced by their local name and must be present in the ontology or its imports.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/ontology-editor/axiom_value_editor.png" alt="axiom value editor" width="50%">
</div>
<div class="title">Figure 46. Axiom Overlay Editor with an example</div>
</div>
</div>
<div class="sect4">
<h5 id="property_value_displays">Property Value Displays</h5>
<div class="paragraph">
<p>Property Value Displays are a common way Mobi displays multiple values for a property on an entity. These properties could be data properties, object properties, annotations, axioms, etc. The display consists of the title section and the values section. The title section includes a bold title and the property IRI. The values section lists all the values set for the displayed property along with the type, if the value is a literal, and edit and delete buttons when you hover over the value. The functionality of the edit and delete buttons for values differ depending on where the Property Value Display is being used. If a value of a property is a class restriction or expression, it will be represented in a simplified format or <a href="https://www.w3.org/TR/owl2-manchester-syntax/">Manchester Syntax</a> if it is supported. These values can be deleted, but not edited.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
See the <a href="https://www.w3.org/TR/2012/REC-owl2-syntax-20121211/">W3C Specification</a> for information about blank nodes, class/property restrictions, and class/property expressions.
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ontology-editor/property_value_display.png" alt="property value display">
</div>
<div class="title">Figure 47. A property value display with multiple values</div>
</div>
</div>
<div class="sect4">
<h5 id="button_stack">Button Stack</h5>
<div class="paragraph">
<p>The Button Stack is visible in any Ontology tab in the bottom right hand corner of the screen and holds a variety of buttons that are shown when the stack is hovered over.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ontology-editor/button_stack.png" alt="button stack">
</div>
<div class="title">Figure 48. Collapsed button stack</div>
</div>
<div class="paragraph">
<p>To add a new entity to the ontology, click on the main <b class="button">Create Entity</b> button in the stack. This will open an overlay with options for what kind of entity to create and once you have selected an option, an appropriate overlay will be shown for creating that type of entity. After creating the entity, a snackbar will appear at the bottom allowing you to navigate directly to your new entity.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ontology-editor/create_entity_button.png" alt="create entity button">
</div>
<div class="title">Figure 49. Create Entity button</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ontology-editor/new_snackbar.png" alt="new snackbar">
</div>
<div class="title">Figure 50. New Entity snackbar</div>
</div>
<div class="paragraph">
<p>If you have made changes to an ontology, the <b class="button">Commit Changes</b> button will become active. Clicking on this button will bring up the Add Commit overlay.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ontology-editor/commit_changes_button.png" alt="commit changes button">
</div>
<div class="title">Figure 51. Commit button</div>
</div>
<div class="paragraph">
<p>The Add Commit overlay provides a textarea for you to enter in a <span class="underline">Comment</span> that will be associated with that commit. This commit usually specifies what changes where made in the commit so that others can read the message and understand what happened at that point in time. You can still commit your changes if you are not currently viewing the head commit of the current branch. Clicking <b class="button">Cancel</b> will close the overlay. Clicking <b class="button">Submit</b> will add all your saved changes to a new commit object whose parent is the commit you were viewing and close the overlay.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/ontology-editor/add_commit_overlay.png" alt="add commit overlay" width="50%">
</div>
<div class="title">Figure 52. Add commit overlay</div>
</div>
<div class="paragraph">
<p>See the <a href="#merging_branches">Merging Branches</a> section for details on how the merging branches works.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ontology-editor/merge_branch_button.png" alt="merge branch button">
</div>
<div class="title">Figure 53. Merge Branch button</div>
</div>
<div class="paragraph">
<p>The <b class="button">Create Branch</b> button allows you to create a new branch from the commit and branch you are viewing, including past commits. This action can be performed even if you have unsaved or saved changes. Clicking on the button will bring up the Create New Branch overlay.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ontology-editor/create_branch_button.png" alt="create branch button">
</div>
<div class="title">Figure 54. Create Branch button</div>
</div>
<div class="paragraph">
<p>The Create New Branch overlay provides fields for entering information about the branch as a whole. The <span class="underline">Title</span> field (required) will set the <code>dcterms:title</code> of the branch. The <span class="underline">Description</span> field will set the <code>dcterms:description</code> of the branch. Clicking <b class="button">Cancel</b> will close the overlay. Clicking <b class="button">Submit</b> will create a new branch with the entered information whose head commit was the commit you were viewing and close the overlay.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/ontology-editor/create_branch_overlay.png" alt="create branch overlay" width="50%">
</div>
<div class="title">Figure 55. Create new branch overlay</div>
</div>
<div class="paragraph">
<p>The <b class="button">Create Tag</b> button allows you to create a human readable and persistent pointer to the commit you are currently viewing. Clicking this button will bring up an overlay where you can type in the title for the Tag and customize it&#8217;s IRI. Once the Tag is created, the ontology will open the ontology in read-only mode at the tagged commit.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ontology-editor/create_tag_button.png" alt="create tag button">
</div>
<div class="title">Figure 56. Create Tag button</div>
</div>
<div class="paragraph">
<p>The <b class="button">Upload Changes</b> button allows you to upload a new version of your ontology from a file and apply the changes. Clicking this button will bring up an overlay where you can select the file with the changed ontology. Uploaded changes will not be automatically committed, but will allow you to review changes before making a new Commit.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ontology-editor/upload_changes_button.png" alt="upload changes button">
</div>
<div class="title">Figure 57. Upload Changes button</div>
</div>
</div>
<div class="sect4">
<h5 id="extension_mappings">Extension Mappings</h5>
<div class="paragraph">
<p>The table below describes which file extensions are mapped to which RDF Formats when an ontology file is uploaded to Mobi. In the event more than one RDF Format is possible for a single extension, all RDF Formats are attempted.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Table Extension to RDF Formats</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Extension</th>
<th class="tableblock halign-left valign-top">RDF Format Name</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">.json</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RDF/JSON, JSON-LD</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">.jsonld</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JSON-LD</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">.ttl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Turtle</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">.xml</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Rio OWL XML, RDF/XML</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">.ofn</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Rio Functional Syntax</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">.omn</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Rio Manchester Syntax</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">.owx</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Rio OWL XML</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">.rdf</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RDF/XML</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">.rdfs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RDF/XML</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">.owl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RDF/XML, Rio OWL XML</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">.trig</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TriG</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">.nt</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N-Triples</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">.nq</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N-Quads</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">.obo</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Open Biological and Biomedical Ontologies</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="vocabulary-linking">Link (ENTERPRISE)</h3>
<div class="paragraph">
<p>The Mobi Vocabulary Linking Tool is an <strong>Enterprise only</strong> feature that allows you to create semantic links between terms found in two different vocabularies. The tool uses the <a href="https://en.wikipedia.org/wiki/Levenshtein_distance">Levenshtein algorithm</a> by default to determine the similarity of labels between terms</p>
</div>
<div class="paragraph">
<p>To reach the Vocabulary Linking tool, click on the link in the left menu.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/vocabulary-linking/full_tool_initial_view.png" alt="The Vocabulary Linking Tool">
</div>
<div class="title">Figure 58. The Vocabulary Linking Tool</div>
</div>
<div class="paragraph">
<p>The initial view of the Vocabulary Linking Tool shows a form on the left for selecting the vocabularies and a space for matched terms to be displayed. To select a vocabulary, you must select the Ontology Record and a Branch. All selected semantic relations you wish to add will be committed to the selected branches for both vocabularies.</p>
</div>
<div class="paragraph">
<p>To adjust the configuration for the linking algorithm, click on <b class="button">Advanced</b> and a configuration modal will appear. The modal contains fields for the “Matching Sensitivity”, which controls the range of percentages that matching results must be within to be returned, and the “Matching Properties”, which controls which properties are analyzed for similarity by the linking tool.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/vocabulary-linking/config_modal.png" alt="The vocabulary linking configuration modal" width="50%">
</div>
<div class="title">Figure 59. The vocabulary linking configuration modal</div>
</div>
<div class="paragraph">
<p>After you have selected 2 different ontologies, click on <b class="button">Analyze</b> and the right section of the view will update with the matched terms in a paginated list.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/vocabulary-linking/linking_results.png" alt="Example vocabulary linking results">
</div>
<div class="title">Figure 60. Example vocabulary linking results</div>
</div>
<div class="paragraph">
<p>The top of the results section shows a checkbox for selecting or deselecting all the results in addition to two dropdowns. One is for filtering the results based on whether terms have already been semantically linked. The other is for sorting the results based on the highest matched percentage of all the labels of each matched term pair.</p>
</div>
<div class="paragraph">
<p>Each result in the display shows the display name for each term, which semantic relation will be committed, and the highest matched percentage between labels of both the terms. Each result is also expandable to show all the properties  for each term in the pair along with a select for which semantic relation to use. If the terms in a matched pair are already semantically linked, they will be marked as such and the checkbox on the row will be disabled.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/vocabulary-linking/matched_pair.png" alt="Example matched vocabulary terms">
</div>
<div class="title">Figure 61. Example pair of matched vocabulary terms</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/vocabulary-linking/previously_linked.png" alt="Previously linked vocabulary matches">
</div>
<div class="title">Figure 62. Matched vocabulary terms that are already linked</div>
</div>
<div class="paragraph">
<p>To mark which terms you wish to link, select which relation you wish to use from the select in the expanded section and check the box next to the pair. The options are “Exact Match”, “Close Match”, or “Related”.  Use the following as a reference for what each type of relation means:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Exact Match</dt>
<dd>
<p>Used to link two concepts that can always be used interchangeably.</p>
</dd>
<dt class="hdlist1">Close Match</dt>
<dd>
<p>Used to link two concepts that can sometimes be used interchangeably depending on the application. Not as strong of a link as “Exact Match”.</p>
</dd>
<dt class="hdlist1">Related</dt>
<dd>
<p>Represents associative (non-hierarchical) links.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>After you have selected the type of link you would like to make and checked the checkbox for the row, repeat this process for all the terms that you want linked. To commit the links, click on <b class="button">Commit</b> in the top right corner of the page, above the “Sort” dropdown. You should then see a modal open with options for how to commit the selected linking to the ontologies. You have a choice of committing to one ontology or both. Once you have selected which ontology(s) to commit to, click on <b class="button">Submit</b>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/vocabulary-linking/vocab_one_way_linking.png" alt="One Way Linking" width="50%">
</div>
</div>
<div class="paragraph">
<p>You should then get a message saying that the Linking Matches were successfully committed for each ontology.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/vocabulary-linking/success.png" alt="Successful linking" width="50%">
</div>
<div class="title">Figure 63. A success message linking vocabularies</div>
</div>
</div>
<div class="sect2">
<h3 id="shapes-editor-guide">Shapes Editor (BETA)</h3>
<div class="paragraph">
<p>The Mobi web-based shapes graph editor is an experimental feature that provides users with a Distributed Management System for local and community development of (<a href="https://www.w3.org/TR/shacl/#shapes">SHACL Shapes</a>). The Shapes Editor features a customizable user interface, constraint capture, collaboration, shapes graph reuse, and extensibility.</p>
</div>
<div class="paragraph">
<p>To reach the Shapes Editor, click on the link in the left menu.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/shacl-editor/shacl_overview.png" alt="Shapes Overview Page">
</div>
<div class="title">Figure 64. Shapes Editor Overview page</div>
</div>
<div class="paragraph">
<p>The main Shapes Editor page includes a new action-bar where all the action buttons for a shapes graph record are located. From the action-bar, users can create, filter, and open different shapes graph records, branches, and tags.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/shacl-editor/action_bar.png" alt="action bar" width="100%">
</div>
<div class="title">Figure 65. Shapes Editor Action Bar</div>
</div>
<div class="paragraph">
<p>When opening a shapes graph record, the editor will load the previous branch and/or commit you were viewing. If you have not previously opened the record or in the case that the branch you were viewing no longer exists, the editor will load the HEAD commit of the shape graph&#8217;s master branch. For an explanation of commits and branches, see the section on <a href="#shapes_graph_versioning">Shapes Graph Versioning</a>.</p>
</div>
<div class="paragraph">
<p>Once a shapes graph record has been opened, The overview page displays a list of high-level information surrounding the shapes graph. This includes a shapes graph&#8217;s annotations, properties, imports, and a preview of the shapes graph serialized as RDF in <a href="https://www.w3.org/TR/turtle/">Turtle</a> syntax. Mobi will capture this high level information about a shapes graph with an OWL ontology object, following best practices from the SHACL W3C specification (see  <a href="https://www.w3.org/TR/shacl/#sparql-prefixes">this section</a> as an example).</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/shacl-editor/shapes_details.png" alt="shapes details">
</div>
<div class="title">Figure 66. Shapes Record Details</div>
</div>
<div class="sect3">
<h4 id="creating_new_shapes_graphs">Creating New Shapes Graphs</h4>
<div class="paragraph">
<p>To create a shapes graph, select the <b class="button">Create Shapes Graph</b> button found in the dropdown for selecting a record. In the creation dialog, you are required to provide a title for the record and a file providing the initial shapes graph data (accepts all standard RDF formats). Users can also optionally provide a description and keywords which will be used to describe the shapes graph record in the local catalog.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/shacl-editor/create_shapes.png" alt="create shapes" width="50%">
</div>
<div class="title">Figure 67. New Shapes Record Form</div>
</div>
<div class="paragraph">
<p>The Title field populates the <code>dcterms:title</code> annotations of the new shapes graph record and the Description field populates the <code>dcterms:description</code> annotations of the new shapes graph record. The keywords field will attach the entered values as keywords to the new record.</p>
</div>
</div>
<div class="sect3">
<h4 id="editing_a_shapes_graph">Editing a Shapes Graph</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
In-app shapes graph editing features are coming soon. In this BETA version, updates can be uploaded using the <a href="#uploading_changes_to_shapes_graphs">Upload Changes feature</a>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="shapes_graph_versioning">Shapes Graph Versioning</h4>
<div class="paragraph">
<p>Each shapes graph in Mobi is versioned similarly to the <a href="https://git-scm.com/">Git</a> Version Control System, whereby all changes to a shapes graph are collected into a chain of "commits" which form a commit history called a "branch". Thus, every version in the history of a shapes graph can be generated by selecting a commit and applying all the changes in the branch back to the initial commit.</p>
</div>
<div class="paragraph">
<p>Every shapes graph is also initialized with a MASTER branch that contains the initial commit. Changes to the shapes graph can be uploaded to the MASTER branch or can be uploaded into separate branches. Changes uploaded on these branches exists in isolation until they are merged into the MASTER branch, joining any other changes committed in the meantime. When merging two branches, the Shapes Editor does its best to combine any changes made on both branches. If a conflict occurs, the editor allows the user to resolve them manually. More information on merging branches can be found in the section on <a href="#merging_branches_on_shapes_graphs">Merging Branches</a>.</p>
</div>
<div class="sect4">
<h5 id="branches_tags">Branches &amp; Tags</h5>
<div class="paragraph">
<p>In order to create a branch or tag, click the corresponding button in the action bar.</p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="images/shacl-editor/create_branch_button.png" alt="create branch button"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="images/shacl-editor/create_tag_button.png" alt="create tag button"></span></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">Create Branch and Create Tag buttons</div>
<p>The branches dropdown provides a searchable list of branches and tags which can be checked out. To checkout a branch or tag, simply select the branch in the drop-down menu. Checking out a tag will open the ontology at the tagged commit in read-only mode. If you have checked out a commit from the commit history table, the commit will be in the dropdown list and show as selected. Note that the ability to check out a branch or tag will be disabled if you have any uncommitted changes on the current branch.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/shacl-editor/versioning_dropdown.png" alt="versioning dropdown" width="40%">
</div>
<div class="title">Figure 68. Branches Dropdown</div>
</div>
<div class="paragraph">
<p>To delete a branch or tag, click on the delete icon next to the branch/tag in the drop-down menu. If a branch is deleted, all commits on that branch that are not part of another branch will be removed, as well as the branch itself. If a tag is deleted, the commit is not removed. Note that these actions cannot be undone.</p>
</div>
</div>
<div class="sect4">
<h5 id="viewing_saved_changes_on_shapes_graphs">Viewing Saved Changes on Shapes Graphs</h5>
<div class="paragraph">
<p>Changes that have been uploaded to a shapes graph record are automatically saved and an indicator is shown in the action-bar. Users are able to reach the changes page by clicking the <b class="button">Show Changes</b> button found in the right-hand side of the action bar.</p>
</div>
<div class="paragraph">
<p>The changes page displays all saved and uncommitted changes in the opened shape graph. Saving changes without committing allows a user to edit an shape graph through a number of browser sessions before making any commits to the commit history. These changes are unique to the user, and are available to other users once a commit is performed. They are grouped by individual entity and display the triples on the entity grouped by property.  When a “Show Full” toggle is active, the changes display is updated to include all the other triples on that changed entity.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/shacl-editor/changes_page.png" alt="changes page">
</div>
<div class="title">Figure 69. Changes Page</div>
</div>
<div class="paragraph">
<p>The Changes Page displays all the uncommitted changes and the commit history graph for the opened shapes graph record. This provides users the ability to upload changes without committing and allows a user the opportunity to review proposed changes to a shapes graph in a more digestible manner before adding any commits to the commit history. Clicking the <b class="button">Remove All Changes</b> button will clear all the changes uploaded into the shape graph, resetting to the state of the current commit.</p>
</div>
<div class="paragraph">
<p>The commit history graph displays of all the commits made in the history of the branch you are currently viewing. The username of the creator, ID, message, and date for each commit are displayed within the graph. The graph displays each commit connected to its parent commits continuing backwards until the initial commit. The graph displays any Tags associated with a commit and will also display the branch name associated with a merge if the branch still exists in the system. To view more information about a particular commit in the history, such as the added and deleted statements, click on its hash id to open an informational modal. The graph also includes commit dots for "checking out" a commit in the history. Clicking the Commit dot will open the shapes graph at that commit in read-only mode.</p>
</div>
</div>
<div class="sect4">
<h5 id="merging_branches_on_shapes_graphs">Merging Branches on Shapes Graphs</h5>
<div class="paragraph">
<p>Merging branches works much the same as the Ontology Editor. By clicking the <b class="button">Merge Branch</b> button found in the action-bar, users are brought to the merge view of the Shapes Editor.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/shacl-editor/merge_branches_button.png" alt="merge branches button">
</div>
<div class="title">Figure 70. Merge Branches button</div>
</div>
<div class="paragraph">
<p>The merge view displays the name of the current (source) branch, a select box for the branch (target) you want to merge into, and a checkbox for whether or not you want the source branch to be deleted after it is merged. The view also shows an aggregated view of all changes made in the source branch that will be merged into the target branch along with a list of all the commits that will be added to the target branch from the source branch.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/shacl-editor/merge_page.png" alt="merge page">
</div>
<div class="title">Figure 71. Merge View</div>
</div>
<div class="paragraph">
<p>Clicking <b class="button">Submit</b> will attempt to perform the merge. If there are no conflicts between the changes on both branches, a new commit will be created merging the two branches, and a success message will appear in the top right corner of the screen.</p>
</div>
</div>
<div class="sect4">
<h5 id="uploading_changes_to_shapes_graphs">Uploading Changes to Shapes Graphs</h5>
<div class="paragraph">
<p>The <b class="button">Upload Changes</b> button in the action-bar allows you to upload a new version of your shapes graph from a file and apply the changes. Clicking this button will bring up an overlay where you can select the file with the changed shapes graph. Uploaded changes will not be automatically committed, but will allow you to review changes before making a new Commit.</p>
</div>
<div class="imageblock text-left">
<div class="content">
<img src="images/shacl-editor/upload_changes_button.png" alt="upload changes button" width="10%">
</div>
<div class="title">Figure 72. Upload Changes button</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="merge-requests-guide">Merge Requests</h3>
<div class="paragraph">
<p>The Mobi Merge Requests module allows users to create long lived representations of a merge between two branches of a record to provide checks and balances before including changes into the object the record represents. Each merge request is connected to a particular Versioned RDF Record in the local Catalog and specifies a "source" and "target" branch. The request represents what would occur if the "source" branch were merged into the "target" branch.</p>
</div>
<div class="paragraph">
<p>To reach the Merge Requests module, click on the link in the left menu.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/merge-requests/full_merge_requests_initial_view.png" alt="full merge requests initial view">
</div>
<div class="title">Figure 73. The Merge Requests module</div>
</div>
<div class="paragraph">
<p>The initial view of the Merge Requests module displays a list of all currently open merge requests. The list can be searched and sorted by the issued date and title, and the list can also be filtered by multiple parameters: the request status, the creator, the assignees, or the attached Record. The search bar, sort options, and the <a href="#create_a_merge_request">create a merge request</a> button are in the page&#8217;s top right corner. Each merge request in the list displays a preview of the request metadata, an icon representing the type of Versioned RDF Record associated with the request, and a button to delete the request. Clicking on a merge request in the list displays the individual merge request.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/merge-requests/individual_request.png" alt="individual request">
</div>
<div class="title">Figure 74. An Individual Merge Request</div>
</div>
<div class="paragraph">
<p>The individual merge request view displays all information regarding the merge request. The top displays more metadata about the request including the request&#8217;s description and whether the source branch will be removed once the request is accepted. Below the metadata are a series of tabs containing the discussion on the request, the changes between the source and target branch, and commits that will be added from the source to the target branch. The bottom of the view contains a button to delete the request, a button to accept the request if it not already accepted, and a button to go back to the main list of merge requests.</p>
</div>
<div class="paragraph">
<p>The discussion tab allows users to comment and discuss the changes within the request to facilitate more collaboration in a distributed environment. You can create new comments to start new threads of communication or you can reply to existing comments and further the discussion. Comments can only be removed by the creators of the comment.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The comment editor supports GitHub flavored Markdown which you can find more information about <a href="https://guides.github.com/features/mastering-markdown/">here</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The Changes tab displays the full difference of the source branch from the target branch. They are grouped by individual entity and display the triples on the entity grouped by property.  When a “Show Full” toggle is active, the changes display is updated to include all the other triples on that changed entity.</p>
</div>
<div class="paragraph">
<p>The metadata of a request can be edited by hovering over the area and clicking the pencil button. In the resulting overlay, you can change the <span class="underline">Title</span>, <span class="underline">Description</span>, target branch, <span class="underline">Assignees</span>, and whether the source branch should be removed on acceptance.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/merge-requests/edit_merge_request.png" alt="edit merge request" width="50%">
</div>
<div class="title">Figure 75. Editing Merge Request Metadata</div>
</div>
<div class="sect3">
<h4 id="create_a_merge_request">Create a Merge Request</h4>
<div class="paragraph">
<p>To create a merge request, click <b class="button">New Request</b> on the initial view of the Merge Requests module. Creating a merge request is a three part process. The first step is to select which record in Mobi to attached to the new request by searching within the displayed paginated list of records. All types of Versioned RDF Records are supported by the tool. This currently includes: Ontology Records, Shapes Graph Records, Mapping Records, and Workflow Records. Once you have selected a record, click <b class="button">Next</b>.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
If the record a request is attached to is deleted, that request is removed. If the source branch of a request is removed, that request will also be removed.
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="images/merge-requests/step1.png" alt="step1">
</div>
<div class="title">Figure 76. Creating a Merge Request: Step 1 - Select a Record</div>
</div>
<div class="paragraph">
<p>The second step of creating a merge request is to pick the "source" and "target" branch from the attached record. The source branch will be the branch in the first select box and the target branch will be in the second select box. Once both are selected, you will see an aggregated view of all changes made in the source branch that will be merged into the target branch along with all the commits from the source branch that will be included in the target branch. Once you have selected the branches you want to merge, click <b class="button">Next</b>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/merge-requests/step2.png" alt="step2">
</div>
<div class="title">Figure 77. Creating a Merge Request: Step 2 - Select Branches</div>
</div>
<div class="paragraph">
<p>The third step of creating a merge request is to provide any metadata you want to include about the request. This includes the required <span class="underline">Title</span>, optional <span class="underline">Description</span>, any <span class="underline">Assignees</span> of the request, and whether the source branch should be removed when the request is accepted. Once you have provided the metadata you wish to include, click <b class="button">Submit</b> and a new Merge Request with your selections will be created.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/merge-requests/step3.png" alt="step3">
</div>
<div class="title">Figure 78. Creating a Merge Request: Step 3 - Request Metadata</div>
</div>
</div>
<div class="sect3">
<h4 id="accepting_a_merge_request">Accepting a Merge Request</h4>
<div class="paragraph">
<p>A merge request can be accepted only if there are no conflicts between the source and target branch and the user accepting the request has permission to modify the target (see <a href="#Ontology Managing">[Ontology Managing]</a> though the same permission handling applies to other types of Versioned RDF Records as well). If there are conflicts between the source and target branches, a notification will be shown with the option to resolve the conflicts from within the Merge Requests module. Resolving conflicts behaves the same as in the <a href="#merging_branches">Ontology Editor</a>, except that the resolution will become a commit on the source branch.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/merge-requests/conflicts.png" alt="conflicts">
</div>
<div class="title">Figure 79. Conflicts on a Merge Request</div>
</div>
<div class="paragraph">
<p>If a merge request is accepted, the merge will be preformed from the source into the target and the request will be moved into an Accepted state. All accepted merge requests are saved within the application for provenance and governance tracking.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="mapping-tool-guide">Mapping Tool</h3>
<div class="paragraph">
<p>The Mobi web-based Mapping Tool allows users to define custom, ontology-driven definitions to control and execute input data transformations to the Resource Description Framework (<a href="https://www.w3.org/RDF/">RDF</a>) semantic data model. User-defined mappings load semantic data into the Mobi store for analysis, sharing and linking.</p>
</div>
<div class="paragraph">
<p>To reach the Mapping Tool, click on the link in the left menu.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/mapping-tool/full_mapping_tool_initial_view.png" alt="full mapping tool initial view">
</div>
<div class="title">Figure 80. Mapping Tool button</div>
</div>
<div class="paragraph">
<p>To use the Mapping Tool to map data, an ontology must be in the Mobi repository, but it does not have to be opened to access it. If there are no available ontologies, you will not be able to map delimited data. To upload an ontology go to the <a href="#ontology_editor">[ontology_editor]</a> and follow the steps for uploading ontologies or creating a new ontology.</p>
</div>
<div class="paragraph">
<p>The initial view of the Mapping Tool shows the Mapping Select Page which contains a searchable paginated list of the mappings within the local Mobi repository. Each mapping is displayed with a portion of its metadata along with a dropdown menu with buttons to preview, <a href="#duplicating_a_mapping">duplicate</a>, <a href="#editing_a_mapping">edit</a>, <a href="#running_a_mapping">run</a>, download, and delete the mapping. The Preview button will bring up a display of the mapped classes and properties along with the title of the source ontology. If the selected source ontology no longer exists in the local Mobi repository, you will not be able to edit, run, or duplicate the mapping. Click <b class="button">New Mapping</b> to <a href="#creating_a_mapping">create</a>.</p>
</div>
<div class="sect3">
<h4 id="creating_a_mapping">Creating a Mapping</h4>
<div class="paragraph">
<p>To create a new mapping, click <b class="button">Create Mapping</b> on the Mapping Select Page. The creation overlay requires you to enter a <span class="underline">Title</span> which will populate the <code>dcterms:title</code> annotation of the new mapping record. The <span class="underline">Description</span> field populates the <code>dcterms:description</code> annotation of the new mapping record. The <span class="underline">Keywords</span> field will attach the entered values as keywords to the new mapping record.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/mapping-tool/create_mapping_overlay.png" alt="create mapping overlay" width="50%">
</div>
<div class="title">Figure 81. Create Mapping Overlay</div>
</div>
<div class="paragraph">
<p>Clicking <b class="button">Submit</b> brings you to the File Upload Page to continue the process of creating a mapping. You must upload a delimited file to use as a standard for the mapping. You can also check whether or not the file contains a header row and select the separator character if the file is CSV. The accepted file formats are <code>.csv</code>, <code>.tsv</code>, <code>.xls</code>, and <code>.xlsx</code>. Selecting a file in the form on the left loads a preview of the first 50 rows and columns of the delimited file into the table on the right. Clicking <b class="button">Continue</b> brings you to the Edit Mapping Page.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/mapping-tool/file_upload_create.png" alt="file upload create">
</div>
<div class="title">Figure 82. File Upload Page for Creating a Mapping</div>
</div>
<div class="paragraph">
<p>The Edit Mapping Page contains three tabs: Edit, Preview, and Commits. The Edit tab contains a section for displaying the currently selected source ontology, the list of class mappings, and a list of property mappings for a particular class. For every row in the delimited data, an instance of a mapped class will be made according to each class mapping. Each created class instance will have a set of properties as defined by the property mappings associated with the class mapping. The values of data properties will have assigned datatypes based on the range of the mapped data property unless otherwise specified. The Preview tab allows you to map the first 10 rows of the selected delimited file using the current state of the mapping in a variety of different RDF serializations. Just like <a href="#ontology-editor-guide">ontologies</a>, mappings are versioned with commits which can be viewed in the Commits tab.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
To learn about the structure of a mapping, refer to the <a href="#mobi_mappings">Mobi Mappings</a> Appendix.
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="images/mapping-tool/edit_mapping_edit.png" alt="edit mapping edit">
</div>
<div class="title">Figure 83. Edit Mapping Page Edit Tab</div>
</div>
<div class="paragraph">
<p>When creating a mapping, the first thing you will see is the <a href="#source_ontology_overlay">Source Ontology Overlay</a>. This setting can always be changed by clicking the pencil button next to the ontology name in the Edit tab. The <span class="underline">Class</span> section contains a select box with all the class mappings, a button to delete a specific class mapping, and a button to create a new class mapping. Clicking <b class="button">Add Class</b> opens an overlay where you can select a class in the imports closure of the source ontology that has not been deprecated.</p>
</div>
<div class="paragraph">
<p>The <span class="underline">IRI Template</span> section displays the template Mobi will use when generating IRIs for the created class instances from the selected class mapping. The value within the <code>${}</code> indicates what will be used for the local name of each class instance&#8217;s IRI. "UUID" means that a unique identifier will be generated for each class instance. An integer means that Mobi will grab the value from the column with that index (zero-based) for each row and use each value with all white space removed as the local name for the class instance. This template can be edited by clicking the pencil button next to the section title and filling in the fields in the <a href="#iri_template_overlay">IRI Template Overlay</a>.</p>
</div>
<div class="paragraph">
<p>The <span class="underline">Properties</span> section lists all the property mappings for the selected class mapping with a button to add a new property mapping. Object property mappings are displayed with the name of the class mapping whose instances will be used as the range of the property. Data or Annotation property mappings are displayed with the name of the column whose values will be used as the range of the property, a preview of what the first value would be, the datatype for the mapped value, and the language for the values if specified. Each property mapping also provides a button to edit and delete. If a data property mapping is invalid, meaning it points to a column that does not exist in the delimited file, it must be handled before the mapping can be saved or run.</p>
</div>
<div class="paragraph">
<p>Clicking <b class="button">Add Property</b> opens an overlay where you can select a property in the imports closure of the source ontology that has not been deprecated or a common annotation. The common annotations that can be mapped are <code>rdfs:label</code>, <code>rdfs:comment</code>, <code>dcterms:title</code>, and <code>dcterms:description</code>. The list of properties from the imports closure is determined by searching for properties that meet the following criteria.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The class (or a superclass) of the class mapping is a direct <code>rdfs:domain</code> on the property (or one of the property&#8217;s super properties)</p>
</li>
<li>
<p>The class (or a superclass) of the class mapping is enumerated in a <code>owl:unionOf</code> restriction on the <code>rdfs:domain</code> of the property (or one of the property&#8217;s super properties)</p>
</li>
<li>
<p>The property and none of its super properties has no <code>rdfs:domain</code> defined</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you select a data property or an annotation, a select box appears containing identifiers for each column in the delimited file along with a preview of the first value of the selected column. At this point, you can also specify a manual datatype override which the mapper will use over the range of the property if set. If a property has more than one <code>rdfs:range</code> value, the datatype override box will be displayed and you must select which type the generated values must be. You can also specify the language for the property values by selecting <code>rdfs:langString</code> as the type and then a language select will appear underneath. If you select an object property, a select box appears containing the titles of all class mappings of the appropriate types along with an option to create a new class mapping.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/mapping-tool/create_property_mapping_overlay_data.png" alt="create property mapping overlay data" width="50%">
</div>
<div class="title">Figure 84. Create Property Mapping Overlay for a Data/Annotation Property</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/mapping-tool/create_property_mapping_overlay_object.png" alt="create property mapping overlay object" width="50%">
</div>
<div class="title">Figure 85. Create Property Mapping Overlay for an Object Property</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/mapping-tool/language_selection.png" alt="language selection" width="50%">
</div>
<div class="title">Figure 86. Language Selection for a Data/Annotation Property</div>
</div>
<div class="paragraph">
<p>Clicking the main <b class="button">Save</b> button at the bottom of either the Edit or Preview tab saves the current state of the mapping and brings you back to the Mapping Select Page. Clicking on the arrow to the right of the <b class="button">Save</b> button provides you options for running the mapping in addition to saving it. These options are downloading the mapped data, uploading the mapped data into a data within a Mobi repository, or committing the mapped data to a specific branch of an ontology. Each option will bring up an appropriate overlay for choosing a RDF format and file name, a dataset, or an ontology and branch respectively. Clicking <b class="button">Submit</b> in an overlay will save the current state of the mapping and run it.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
To learn about datasets in Mobi, refer to the <a href="#datasets-manager-guide">Datasets Manager</a>.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
For more information about running a mapping into an ontology, refer to <a href="#mapping_into_an_ontology">Mapping into an Ontology</a>.
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="images/mapping-tool/save_run_options.png" alt="save run options">
</div>
<div class="title">Figure 87. Options for saving and running a mapping</div>
</div>
</div>
<div class="sect3">
<h4 id="editing_a_mapping">Editing a Mapping</h4>
<div class="paragraph">
<p>To edit a mapping, click <b class="button">Edit</b> on the Mapping Select Page. The application performs a quick check to see if the source ontology or its imported ontologies changed in such a way that the mapping is no longer valid. If this check does not pass, an overlay is displayed informing you of the error. If it passes, you are brought to the File Upload Page where you must upload a delimited file to use as a standard for the mapping. If the delimited file you choose does not contain enough columns for the mapping&#8217;s data property mappings, a list of the missing columns are displayed under the file select. However, you can still edit the mapping as long as those data properties are fixed. From there, editing the mapping works the same as <a href="#creating_a_mapping">creating a mapping</a>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/mapping-tool/file_upload_edit.png" alt="file upload edit">
</div>
<div class="title">Figure 88. File Upload Page for Editing a Mapping</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/mapping-tool/file_upload_edit_missing_columns.png" alt="file upload edit missing columns">
</div>
<div class="title">Figure 89. File Upload Page for Editing a Mapping with missing columns</div>
</div>
</div>
<div class="sect3">
<h4 id="duplicating_a_mapping">Duplicating a Mapping</h4>
<div class="paragraph">
<p>To duplicate a mapping, click <b class="button">Duplicate</b> on the Mapping Select Page. The application performs a quick check to see if the source ontology or its imported ontologies changed in such a way that the mapping is no longer valid. If this check does not pass, an overlay is displayed informing you of the error. If it passes, the Create Mapping overlay will appear allowing you to choose new values for the <span class="underline">Title</span>, <span class="underline">Description</span>, and <span class="underline">Keywords</span>. The rest of the process is the same as <a href="#editing_a_mapping">editing a mapping</a> including how missing columns are handled.</p>
</div>
</div>
<div class="sect3">
<h4 id="running_a_mapping">Running a Mapping</h4>
<div class="paragraph">
<p>To run a mapping against delimited data without editing it, click <b class="button">Run</b> on the Mapping Select Page. The application performs a quick check to see if the source ontology or its imported ontologies changed in such a way that the mapping is no longer valid. If this check does not pass, an overlay is displayed informing you of the error. If it passes, you are brought to the File Upload Page where you must upload a delimited file to be used when generating RDF data. You can also check whether or not the file contains a header row and select the separator character if the file is CSV. The accepted file formats are <code>.csv</code>, <code>.tsv</code>, <code>.xls</code>, and <code>.xlsx</code>. The classes and properties that will be created using the mapping are displayed under the file select. The columns that must be present in the delimited file are highlighted in the table on the right. Selecting a file in the form on the left loads a preview of the first 50 rows and columns of the delimited file into the table. If the delimited file you choose does not contain enough columns for the mapping’s data property mappings, the properties that are missing columns turn red and you will not be able to run the mapping.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
To learn about datasets in Mobi, refer to the <a href="#datasets-manager-guide">Datasets Manager</a>.
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="images/mapping-tool/file_upload_run.png" alt="file upload run">
</div>
<div class="title">Figure 90. File Upload Page for Running a Mapping</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/mapping-tool/file_upload_run_missing_columns.png" alt="file upload run missing columns">
</div>
<div class="title">Figure 91. File Upload Page for Running a Mapping with missing columns</div>
</div>
<div class="paragraph">
<p>Clicking <b class="button">Run Mapping</b> will provide you with options for downloading the mapped data, uploading the mapped data into a data within a Mobi repository, or committing the mapped data to a specific branch of an ontology. Each option will bring up an appropriate overlay for choosing a RDF format and file name, a dataset, or an ontology and branch respectively.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
For more information about running a mapping into an ontology, refer to <a href="#mapping_into_an_ontology">Mapping into an Ontology</a>.
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="images/mapping-tool/run_options.png" alt="run options">
</div>
<div class="title">Figure 92. Options for saving and running a mapping</div>
</div>
</div>
<div class="sect3">
<h4 id="mapping_tool_reference">Mapping Tool Reference</h4>
<div class="sect4">
<h5 id="source_ontology_overlay">Source Ontology Overlay</h5>
<div class="paragraph">
<p>The Source Ontology Overlay allows you to select the source ontology for the mapping from all uploaded ontologies in the local Mobi repository.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/mapping-tool/source_ontology_overlay.png" alt="source ontology overlay" width="50%">
</div>
<div class="title">Figure 93. Source Ontology Overlay</div>
</div>
<div class="paragraph">
<p>The left side of the overlay contains a searchable list of all the ontologies in the local Mobi repository and a select for the version of the ontology to use. For most ontologies, this will only contain the "Latest" value. However, if an ontology was previously selected for a mapping and that ontology has changed since then, there will be an option for the "Saved" version of the ontology. The right side of the overlay displays information about the ontology from its record in the <a href="#catalog-guide">Catalog</a> and a sample of the classes in that ontology. Setting the source ontology will remove any class and property mappings in the mapping that are incompatible. The criteria for incompatible mappings are as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The referenced class or property no longer exists in the imports closure of the source ontology</p>
</li>
<li>
<p>The referenced class or property is now deprecated</p>
</li>
<li>
<p>The referenced property has changed from a datatype property to an object property or vice versa</p>
</li>
<li>
<p>The range of the referenced object property has changed such that the target class mapping is no longer valid</p>
</li>
<li>
<p>The class of the range class mapping of the referenced object property is incompatible</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="iri_template_overlay">IRI Template Overlay</h5>
<div class="paragraph">
<p>The IRI Template overlay provides you a way to edit each portion of the IRI template of a class mapping. The template will be used to generate the IRIs for each instance created by a class mapping.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/mapping-tool/iri_template_overlay.png" alt="iri template overlay" width="50%">
</div>
</div>
<div class="paragraph">
<p>The <span class="underline">Begins with</span> field (required) is the beginning of the IRI. This is more commonly known as the namespace. The <span class="underline">Then</span> field (required) is the next character in the IRI. This value can be thought of the separator between the namespace and local name (described below). The provided values for the <span class="underline">Then</span> field are "&#35;", "/", and ":". The <span class="underline">Ends with</span> dropdown field (required) is the last part of the IRI. This value is commonly known as the local name. The values in this dropdown are "UUID", which represents generating a unique identifier as the local name for each generated instance of each row, and the title of each column, which represents using the value of that column as the local name for each generated instance of each row. Clicking <b class="button">Cancel</b> will close the overlay. Clicking <b class="button">Submit</b> will save the IRI template.</p>
</div>
</div>
<div class="sect4">
<h5 id="mapping_into_an_ontology">Mapping into an Ontology</h5>
<div class="paragraph">
<p>The overlay for mapping into an ontology contains several configurations on how the mapping result data will be committed. First, you must select the <span class="underline">Ontology</span> and <span class="underline">Branch</span> that will receive the new commit. After that, there are radio buttons that will determine how the mapping result data will be treated when the commit is made. The first option will treat all the mapping result data as new data, meaning no existing data in the ontology branch will be removed. The second option will treat all the mapping result data as changes to the existing data on the ontology branch. This means that if there are entities or properties on entities in the ontology that are not present in the mapping result data, they will be removed.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/mapping-tool/map_into_ontology.png" alt="map into ontology" width="50%">
</div>
</div>
<div class="paragraph">
<p>A sample workflow using this tool would be to create an ontology in the <a href="#ontology-editor-guide">Ontology Editor</a> and create a branch that will received all mapped data commits. Then run your mapping from the Mapping Tool, committing to the new branch as additions. Finally in the Ontology Editor, merge that branch with the mapped data commit into the MASTER branch. Then any subsequent runs of the mapping with updated data would be committed as changes to the mapped data branch and merged into the MASTER branch.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="datasets-manager-guide">Datasets Manager</h3>
<div class="paragraph">
<p>The Mobi Datasets Manager allows users to create, edit, clear, and delete datasets within the application to group and store Resource Description Framework (<a href="https://www.w3.org/RDF/">RDF</a>) semantic data into various graphs for enhanced query isolation, data segmentation, and management.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
To learn more about the structure of a dataset, refer to the <a href="#mobi_datasets">Mobi Datasets</a> Appendix.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To reach the Datasets Manager, click on the link in the left menu.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/datasets-manager/full_datasets_manager_initial_view.png" alt="full datasets manager initial view">
</div>
<div class="title">Figure 94. The Datasets Manager</div>
</div>
<div class="paragraph">
<p>The page displays a searchable paginated list of all the datasets within the local Mobi repository. Each dataset in the list displays a preview of the dataset metadata and a dropdown menu with upload data, edit, clear, and delete buttons. Deleting a dataset deletes the dataset, catalog record, and all associated data graphs. Clearing a dataset removes all associated data graphs except the system default named graph. Clearing a dataset does not remove the dataset or the catalog record. Editing a dataset allows to you to change some information about the dataset. The <b class="button">Upload Data</b> button allows you to upload graph data to the dataset from a file.</p>
</div>
<div class="paragraph">
<p>To create a new dataset, click <b class="button">New Dataset</b> and fill out the information in the creation overlay.</p>
</div>
<div class="sect3">
<h4 id="create_dataset">Create Dataset</h4>
<div class="imageblock text-center">
<div class="content">
<img src="images/datasets-manager/new_dataset_overlay.png" alt="new dataset overlay" width="50%">
</div>
<div class="title">Figure 95. New Dataset Overlay</div>
</div>
<div class="paragraph">
<p>The Create New Dataset overlay contains several sections. The <span class="underline">Title</span> field populates the <code>dcterms:title</code> annotation of the new dataset record. The <span class="underline">Dataset IRI</span> field allows you to specify what the IRI of the new dataset should be. If not provided, the system will create a unique one for you. The <span class="underline">Description</span> field populates the <code>dcterms:description</code> annotation of the new dataset record. The <span class="underline">Keywords</span> field will attach the entered values as keywords to the new dataset record. The <span class="underline">Repository</span> field allows you to specity the identifier of the repository registered within AVM where the dataset and all associated named graphs will be stored. The default option is the system repository and should be used in most cases. Finally, you can select which ontologies should be used as the basis for the data. Select an ontology from the searchable list of ontologies to add it to the dataset. To remove a selected ontology, click the x next to the ontology name. Clicking <b class="button">Cancel</b> will close the overlay. Clicking <b class="button">Submit</b> will create the dataset with the provided metadata.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The ability to create new repositories in Mobi is coming soon!
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="edit_dataset">Edit Dataset</h4>
<div class="imageblock text-center">
<div class="content">
<img src="images/datasets-manager/edit_dataset_overlay.png" alt="edit dataset overlay" width="50%">
</div>
<div class="title">Figure 96. Edit Dataset Overlay</div>
</div>
<div class="paragraph">
<p>The Edit Dataset overlay allows you to modify information about the dataset. The <span class="underline">Title</span> field modifies the value of the <code>dcterms:title</code> annotation of the dataset record. The <span class="underline">Description</span> field modifies the value of the <code>dcterms:description</code> annotation of the dataset record. The <span class="underline">Keywords</span> field allows you to add/remove keywords attached to the dataset record. The ontologies area allows you to modify the ontologies associated with the dataset record; just as during creation. Clicking <b class="button">Update</b> will update the dataset record with the new metadata.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<div class="title">Caution</div>
</td>
<td class="content">
Datasets are associated with specific versions (commits) of an ontology record. In order to update a dataset to the latest version of an ontology record, you&#8217;ll need to remove the ontology, click <b class="button">Submit</b>, then add that ontology back to the dataset.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="discover-guide">Discover</h3>
<div class="paragraph">
<p>The Mobi web-based Discover module allows users to quickly search and explore their knowledge graphs. The <a href="#explore">Explore</a> tab provides an intuitive interface for quickly navigating through ontology-defined entities. The <a href="#query">Query</a> tab allows users to develop and execute SPARQL queries.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
To learn more about SPARQL queries, see the <a href="https://www.w3.org/TR/sparql11-query/">W3C Specification</a>.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The ability to save, publish, share and reuse SPARQL queries as part of applications or larger workflows is coming soon!
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To reach the Discover page, click on the link in the left menu. The first tab shown is the <a href="#explore">Explore tab</a>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/discover/full_discover_page_initial_view.png" alt="full discover page initial view">
</div>
<div class="title">Figure 97. The Discover Page</div>
</div>
<div class="sect3">
<h4 id="explore">Explore</h4>
<div class="paragraph">
<p>The Explore tab of the Discover page allows you to get a high-level overview of the structure of your data within a <a href="#datasets-manager-guide">dataset</a>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/discover/explore_classes.png" alt="explore classes">
</div>
<div class="title">Figure 98. Explore tab with classes</div>
</div>
<div class="paragraph">
<p>The Explore tab opens with a view of all the classes found within the selected dataset and a button to create a new instance. Each card displays the label and a brief description about a class, the number of instances defined as that class, a few of those instances, and a button to explore the instances themselves. Clicking <b class="button">Explore Data</b> opens the instances view.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/discover/explore_instances.png" alt="explore instances">
</div>
<div class="title">Figure 99. Explore Tab with instances</div>
</div>
<div class="paragraph">
<p>The instances view contains a paginated list of all the instances defined as a particular class. Each card displays the label, brief description about an instance, a button to explore the instance itself, and a button to delete the instance. The label is determined based on the values of the <code>rdfs:label</code>, <code>dc:title</code>, or <code>dcterms:title</code> properties on the instance. The description is based on the values of the <code>rdfs:comment</code>, <code>dc:description</code>, or <code>dcterms:description</code> properties on the instance. You can navigate back to the classes view using the breadcrumb trail in the top left. Clicking <b class="button">View <em>Class Name</em></b> opens the single instance view. Clicking <b class="button">Create <em>Class Name</em></b> opens the single instance editor. If the particular class has been deprecated in the ontology, you will not be able to create a new instance.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/discover/explore_single_instance.png" alt="explore single instance">
</div>
<div class="title">Figure 100. Explore Tab with single instance</div>
</div>
<div class="paragraph">
<p>The single instance view displays the IRI, label, brief description, and list of all properties associated with the selected instance. Each property will only show one value by default; however, you can view more values, if there are any, by clicking the "Show More" link for that property. The instance view can also display any assertions on a reification of a property value statement by clicking on the small downward arrow on the right side of a property value. Clicking <b class="button">Edit</b> opens the single instance editor.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/discover/explore_single_instance_editor.png" alt="explore single instance editor">
</div>
<div class="title">Figure 101. Explore Tab with single instance editor</div>
</div>
<div class="paragraph">
<p>The single instance editor displays the IRI and a list of all properties associated with the selected instance in an editable format. The IRI can be edited by clicking the pencil button next to the IRI which will open the <a href="#edit_iri_overlay">Edit IRI Overlay</a>. If the instance being edited does not have all the required properties set, as described by cardinality restrictions in the ontology, the instance cannot be saved. To add a another property value, type in the provided input and press the <kbd>ENTER</kbd> key. To remove a property value, click on the "X" button of the associated chip. To view a complete property value and add assertions to its reification, click on the associated chip.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<div class="title">Caution</div>
</td>
<td class="content">
Editing the instance IRI might break relationships within the dataset.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To add a new property to the instance, click <b class="button">Add New Property</b> and select the property in the overlay. After all edits have been made, clicking <b class="button">Cancel</b> will discard the current changes and go back to the single instance view. Clicking <b class="button">Save</b> will save the current changes to the repository and then go back to the single instance view.</p>
</div>
</div>
<div class="sect3">
<h4 id="query">Query</h4>
<div class="paragraph">
<p>The Query tab of the Discover page allows you to submit SPARQL query against the Mobi repository and optionally a specific <a href="#datasets-manager-guide">dataset</a>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/discover/discover_query_editor_overview.png" alt="discover query editor overview">
</div>
<div class="title">Figure 102. Query tab</div>
</div>
<div class="paragraph">
<p>The Query tab provides a SPARQL query editor powered by the <a href="https://triply.cc/docs/yasgui/">YASGUI</a> SPARQL library. The top section of the page contains the query editor (powered by <a href="https://triply.cc/docs/yasgui-api#yasqe">YASQE</a>), a Dataset field and a <b class="button">Submit</b> button. The <span class="underline">Dataset</span> field contains a list of all available <a href="#datasets-manager-guides">datasets</a> within the Mobi repository. Selecting a dataset limits the query to search through the data within the selected dataset. Clicking <b class="button">Submit</b> executes the entered query against the Mobi repository, optionally limited by the selected dataset, and updates the bottom section with the results.</p>
</div>
<div class="paragraph">
<p>The bottom section displays the results of the most recently submitted SPARQL query (powered by <a href="https://triply.cc/docs/yasgui-api#yasr">YASR</a>). The section has separate tabs for rendering the query result set depending on the type of SPARQL query submitted. SELECT query results are displayed under the Table tab where the headers of the table are the variables specified in the SPARQL query. The Table comes with features such as filtering, page size, sorting and pagination. CONSTRUCT query results can be displayed under the Turtle, JSON-LD and RDF/XML tabs. The query results are limited to 500 triples/rows for rendering, but the entire result set can be downloaded using the button in the upper right corner of the bottom section.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/discover/discover_construct_query.png" alt="discover construct query">
</div>
<div class="title">Figure 103. Construct query</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="my-account-guide">My Account</h3>
<div class="paragraph">
<p>The My Account page of Mobi provides users with a way to configure their own account and customize various aspects of the application to suit their needs.</p>
</div>
<div class="paragraph">
<p>To reach the My Account page, click on the display of your username in the left menu.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/my-account/my_account_link.png" alt="my account link" width="50%">
</div>
<div class="title">Figure 104. My Account link</div>
</div>
<div class="paragraph">
<p>The My Account page contains four main tabs for configuring your account:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#profile">Profile</a></p>
</li>
<li>
<p><a href="#groups">Groups</a></p>
</li>
<li>
<p><a href="#password">Password</a></p>
</li>
<li>
<p><a href="#preferences">Preferences</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="profile">Profile</h4>
<div class="paragraph">
<p>The Profile tab contains a form for viewing and editing your basic profile information. This information includes your <span class="underline">First Name</span>, <span class="underline">Last Name</span>, and <span class="underline">Email</span> address. None of this information is required. Your current settings for these fields will be displayed to start. To edit, simply change the values in one or more of the fields and and click <b class="button">Save</b> in the bottom right. If the change was successful, you will see a success message at the top of the section.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/my-account/profile_tab.png" alt="profile tab">
</div>
<div class="title">Figure 105. Profile Tab</div>
</div>
</div>
<div class="sect3">
<h4 id="groups">Groups</h4>
<div class="paragraph">
<p>The Groups tab contains a list of all the groups you belong to. Next to each group title is an indicator of how many users are within that group. If a group has the admin role, an indicator will be next to the group&#8217;s title.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/my-account/groups_tab.png" alt="groups tab">
</div>
<div class="title">Figure 106. Groups Tab</div>
</div>
</div>
<div class="sect3">
<h4 id="password">Password</h4>
<div class="paragraph">
<p>The Password tab contains a form for updating your password. To change it, you must first input your <span class="underline">Current Password</span> in the first field. Then enter your desired <span class="underline">New Password</span> in the second field and click <b class="button">Save</b> in the bottom right. If the change was successful, you will see a success message at the top of the tab.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/my-account/password_tab.png" alt="password tab">
</div>
<div class="title">Figure 107. Password Tab</div>
</div>
</div>
<div class="sect3">
<h4 id="preferences">Preferences</h4>
<div class="paragraph">
<p>The Preferences tab will dynamically populate with user preference definitions added to the repository (see documentation <a href="#settings_framework">here</a>). These preferences are specific to your user.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/my-account/preferences_tab.png" alt="preferences tab">
</div>
<div class="title">Figure 108. Preferences Tab</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Default preferences coming soon!
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="administration">Administration</h3>
<div class="paragraph">
<p>The Administration page provides administrators with a portal to create, edit, and remove users and groups in Mobi. From this module, you can also assign high level access control for common actions within the application.</p>
</div>
<div class="paragraph">
<p>To reach the Administration page, click on <b class="button">Administration</b> in the left menu. This option is not available to non-administrators.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/user-management/administration_link.png" alt="administration link" width="50%">
</div>
<div class="title">Figure 109. Administration link</div>
</div>
<div class="paragraph">
<p>There are four main tabs of the Administration page:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#users">Users</a></p>
</li>
<li>
<p><a href="#groups">Groups</a></p>
</li>
<li>
<p><a href="#permissions">Permissions</a></p>
</li>
<li>
<p><a href="#application_settings">Application Settings</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you are running a Mobi Enterprise installation, there is a fifth tab for <a href="#licensing">Licensing</a> available as well.</p>
</div>
<div class="sect3">
<h4 id="users">Users</h4>
<div class="paragraph">
<p>The Users tab allows you to create, edit, and remove users from the application.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/user-management/users_tab.png" alt="users tab">
</div>
<div class="title">Figure 110. Users Tab</div>
</div>
<div class="paragraph">
<p>The left side of the tab contains a list of all the users in Mobi. Each user is displayed using their first and last names, if available, or their username. If a user is an administrator, whether by having the admin role or by being a part of a group with the admin role, an indicator will be next to their username in the list. At the top of the list is a search bar that will filter the list of users based on their first name, last name, or username. Clicking on a user will load that user&#8217;s information into the right side of the section.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The default Admin user can not be deleted.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The middle of the Users tab contains the username of the selected user, a block for viewing and editing the user&#8217;s profile information, and a block for resetting the user&#8217;s password. Resetting a user&#8217;s password cannot be undone.</p>
</div>
<div class="paragraph">
<p>The right side of the tab contains blocks for viewing and editing the selected user&#8217;s permissions and viewing the user&#8217;s groups. Clicking on the title of a group will open it in the <a href="#groups">Groups section</a>.</p>
</div>
<div class="paragraph">
<p>To create a user, click <b class="button">Create User</b> and the Create User overlay will appear. The <span class="underline">Username</span> field (required) must be unique within the application. The <span class="underline">Password</span> fields (required) allow you to enter in the password for the new user. The <span class="underline">First Name</span>, <span class="underline">Last Name</span>, and <span class="underline">Email</span> fields are not required, but allow you to enter in basic profile information for the new user. The last section contains a checkbox for setting whether the new user is an administrator. Clicking <b class="button">Cancel</b> will close the overlay. Clicking <b class="button">Submit</b> will create a new user with the entered information.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/user-management/create_user_overlay.png" alt="create user overlay" width="50%">
</div>
<div class="title">Figure 111. Create User Overlay</div>
</div>
</div>
<div class="sect3">
<h4 id="groups_2">Groups</h4>
<div class="paragraph">
<p>The Groups tab allows you to create, edit, and remove groups from the application. Groups allow you to associate users with one another and apply the same permissions and roles to all members.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/user-management/groups_tab.png" alt="groups tab">
</div>
<div class="title">Figure 112. Groups Tab</div>
</div>
<div class="paragraph">
<p>The left side of the tab contains a list of all the groups in Mobi. Next to each group title is an indicator of how many users are within that group. At the top of the list is a search bar that will filter the list of groups based on their title. Clicking on a group title will load that group&#8217;s information into the right side of the section.</p>
</div>
<div class="paragraph">
<p>The right side of the tab contains the selected group&#8217;s title and two rows of blocks. The top row contains blocks that allow you to edit the group&#8217;s description and permissions. If a group has the "Admin" role, all members within that group are considered administrators.</p>
</div>
<div class="paragraph">
<p>The bottom row contains a block that allows you to view, add, and remove the group&#8217;s members. To add another user to the group, click <b class="button">Add Member</b> and that line in the table will transform into a drop down selector of all the users in Mobi that have not already been selected. Selecting a user in this drop down will automatically add them to the group. To remove a user from the table, click on the corresponding delete button at the end of the row. Any changes in this table will immediately be applied. Clicking on a username in this table will open that user&#8217;s information in the <a href="#users">Users section</a>.</p>
</div>
<div class="paragraph">
<p>To create a group, click <b class="button">Create Group</b> and the Create Group overlay will appear. The <span class="underline">Group Title</span> field (required) allows you to specify a name for the group. The <span class="underline">Description</span> field allows you to enter in a description about what the group represents. At the bottom of the overlay is a table for adding users to the group. Your user account will be added automatically. To add others to the group, click <b class="button">Add Member</b> and that line in the table will transform into a drop down selector of all the users in Mobi that have not already been selected. To remove a user from the table, click on the corresponding delete button at the end of the row. Clicking <b class="button">Cancel</b> will close the overlay. Clicking <b class="button">Submit</b> will create a new group with the entered information and add the listed users to it.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/user-management/create_group_overlay.png" alt="create group overlay" width="50%">
</div>
<div class="title">Figure 113. Create group overlay</div>
</div>
</div>
<div class="sect3">
<h4 id="permissions">Permissions</h4>
<div class="paragraph">
<p>The Permissions tab allows you to set high level access control for common actions in the application, such as creating Ontology Records and querying the system repository.  Permissions can be set to allow all authenticated users (the <span class="underline">Everyone</span> slider) or limit access to specific users and groups. To set the permission to a user or group, unselect the <span class="underline">Everyone</span> permission, find a user or group in the search box underneath the appropriate box, and select it. To remove a user or group from the permission, click the <code>X</code> button next to the username or group title. After you have finished making the changes you want, make sure to click the save button in the bottom right.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
More permissions coming soon!
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="images/user-management/permissions_tab.png" alt="permissions tab">
</div>
<div class="title">Figure 114. Permissions Tab</div>
</div>
</div>
<div class="sect3">
<h4 id="application_settings">Application Settings</h4>
<div class="paragraph">
<p>The Application Settings tab enables you to alter/maintain system-wide settings. Below are descriptions of the settings currently available in the application.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
More Application Settings coming soon!
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Default Ontology Namespace</dt>
<dd>
<p>The namespace to be used when generating default IRIs for new ontologies/vocabularies in the <a href="#ontology-editor-guide">Ontology Editor</a>.</p>
</dd>
</dl>
</div>
<div class="imageblock">
<div class="content">
<img src="images/user-management/application_settings_tab.png" alt="application settings tab">
</div>
<div class="title">Figure 115. Application Settings Tab</div>
</div>
</div>
<div class="sect3">
<h4 id="licensing">Licensing (ENTERPRISE)</h4>
<div class="paragraph">
<p>The Licensing tab available in enterprise installations allows you to view and update the current license of the server (see the section on <a href="#server-id-license-file">adding a license file</a>). The values displayed are pulled from the current license file contents on the installation server and any updates made will be persisted back to that file. The page displays the unique Server ID of the installation, the Owner of the license, the expiration date of the license, the policy attached to the license metadata (older licenses may not have this set), and the full license string that is stored within the license file. To update the license contents, click the pencil button shown on hover, replace the field contents with the complete new license string, and click the save icon.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/user-management/licensing_tab.png" alt="licensing tab">
</div>
<div class="title">Figure 116. Application Settings Tab</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configuration-guide">Configuration</h3>
<div class="paragraph">
<p>All default configuration files for Apache Karaf and Mobi are located inside the <code>$MOBI_HOME/etc</code> directory.</p>
</div>
<div class="sect3">
<h4 id="mobi">Mobi</h4>
<div class="sect4">
<h5 id="service_configuration">Service Configuration</h5>
<div class="paragraph">
<p>The basic Mobi services can be configured using the following files:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. Mobi Service Configuration Files</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Configuration File</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>com.mobi.catalog.config.CatalogConfigProvider.cfg</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configurations for the Mobi Catalog</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>com.mobi.platform.config.state.StateManager.cfg</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configurations for the Mobi State Manager</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>com.mobi.service.repository.native-system.cfg</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configurations for the Mobi System Repository</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>com.mobi.service.repository.native-prov.cfg</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configurations for the Mobi Provenance Repository</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>By default, all resources besides provenance data are stored in the system repository which is an RDF triplestore located in the <code>data/repos/system</code> directory of the Mobi distribution. The provenance data is stored within the prov repository. Each repository in Mobi is uniquely identified by its id. To change the data location, id, or title of either repository, edit the <span class="underline">dataDir</span>, <span class="underline">id</span>, and <span class="underline">title</span> properties respectively in the appropriate file. Apache Karaf will dynamically reload any changes made to this existing file.</p>
</div>
<div class="paragraph">
<p>You can create new repositories to be used for storage in Mobi. First, choose either a "native" repository or a "memory" repository. These two types of repositories are defined in the <code>NativeRepositoryConfig</code> and <code>MemoryRepositoryConfig</code> classes in the <code>com.mobi.repository.impl.sesame</code> module. Once you have chosen the type of repository, make a new <code>.cfg</code> file in the <code>$MOBI_HOME/etc</code> directory with a file name that starts with either "com.mobi.service.repository.native" or "com.mobi.service.repository.memory". In the file, set the <span class="underline">id</span>, <span class="underline">title</span>, and <span class="underline">dataDir</span> properties you wish for the repository. The file should look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">id=demo
title=Demonstration
dataDir=path/to/directory</code></pre>
</div>
</div>
<div class="paragraph">
<p>Apache Karaf will automatically recognize the new configuration file and create the new repository.</p>
</div>
<div class="paragraph">
<p>The repository that all Catalog resources are stored with is controlled within the <code>com.mobi.catalog.config.CatalogConfigProvider.cfg</code> file. The storage repository for all other types of data are controlled individually in other configuration files. To change each of these repository configurations, open the associated <code>.cfg</code> file and change the id of the <span class="underline">repository.target</span> property to be the id of the new repository. For example to change the repository for storing Catalog resources to the repository in the example above, you would open the <code>com.mobi.catalog.config.CatalogConfigProvider.cfg</code> file and edit the repository target line to be:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">repository.target = (id=demo)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Apache Karaf will automatically detect the changes and reload the new configuration.</p>
</div>
</div>
<div class="sect4">
<h5 id="core_security_configuration">Core Security Configuration</h5>
<div class="paragraph">
<p>The configuration for user authentication, authorization, and management are stored in the following files in the <code>$MOBI_HOME/etc</code> directory:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. Mobi Security Configuration Files</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Configuration File</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>com.mobi.jaas.engines.RdfEngine.cfg</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configurations for the Mobi RDF Engine</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>com.mobi.security.policy.api.xacml.XACMLPolicyManager.cfg</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configurations for the XACML security policy manager</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Mobi utilizes JAAS for user authentication and basic authorization. By default, user credentials and information are managed by the <code>RdfEngine</code> service which is configured with the <code>com.mobi.jaas.engines.RdfEngine.cfg</code> file. The file contains an id of the repository to be used for storage, the encryption settings for JAAS which are enabled to start, and the two default roles: "user" and "admin". Apache Karaf will automatically detect any changes and reload the updated configurations.</p>
</div>
<div class="paragraph">
<p>The default user for Mobi is "admin" with password "admin". To change the credentials of the "admin" user or perform any other user management activities, utilize the <a href="#administration-guide">Administration</a> page, the <a href="#my-account-guide">My Account</a> page, or the appropriate REST endpoints.</p>
</div>
<div class="paragraph">
<p>For more advanced authorization functionality, Mobi uses the an Attribute Based Access Control (ABAC) system called <a href="https://www.oasis-open.org/committees/xacml/">XACML</a>. Policies describing the attributes for allowing or denying individual access requests are managed by the <code>XACMLPolicyManager</code> service which is configured with the <code>com.mobi.security.policy.api.xacml.XACMLPolicyManager.cfg</code> file. The file contains an id of the repository to be used for storage, the location the XACML policy files should be stored in, and whether the policy file location should be created if it does not already exist. Apache Karaf will automatically detect any changes and reload the updated configurations.</p>
</div>
</div>
<div class="sect4">
<h5 id="configure_default_authentication_token_jwt_duration">Configure Default Authentication Token (JWT) Duration</h5>
<div class="paragraph">
<p>To configure the web authentication token duration, you must create a file called <code>com.mobi.jaas.SimpleTokenManager.cfg</code> with the property detailed below and put it in the <code>etc/</code> directory of your Mobi installation before starting the application, otherwise the token duration will use the default of 24 hours.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
In Enterprise deployments, this is only applied to non-SSO based authentication.
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Property Name</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
<th class="tableblock halign-left valign-top"><strong>Required</strong></th>
<th class="tableblock halign-left valign-top"><strong>Default</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>tokenDurationMins</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Token Duration time in minutes</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1440</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>An example file would look like this.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">### 1 day token duration
tokenDurationMins = 1440</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
.p12 and .jks files should both be supported
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="ldap_configuration_enterprise">LDAP Configuration (ENTERPRISE)</h5>
<div class="paragraph">
<p>In Enterprise deployments only, Mobi can be configured so that users can log into the application with the Users/Groups defined in your organization&#8217;s directory, you must create a file called <code>com.mobi.enterprise.ldap.impl.engine.LDAPEngine.cfg</code> with the following properties and put it in the <code>$MOBI_HOME/etc/</code> directory before starting the application. If a property is not required, you can delete the line from the config file. The list of possible fields for the config file are shown in the table below.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Property Name</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
<th class="tableblock halign-left valign-top"><strong>Required</strong></th>
<th class="tableblock halign-left valign-top"><strong>Default</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>repository.target</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Should always be (id=system)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#x2713;</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ldap.server</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The hostname of the ldap server (ex: localhost)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#x2713;</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ldap.port</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The port of the LDAP server (ex: <code>10389</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#x2713;</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ldap.timeout</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of seconds it will keep trying to reach the LDAP server before it gives up (ex: <code>30</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#x2713;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">30</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ldap.ssl</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether to connect to the LDAP engine with SSL (ex: false)</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ldap.disable-auth</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether direct authentication to the LDAP engine is disabled (ex: <code>false</code>)</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ldap.expiry</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of milliseconds before a LDAPUser should be retrieved (ex: <code>3600000</code>)</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3600000</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ldap.admin.dn</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The admin DN on your LDAP server (ex: <code>uid=admin,ou=system</code>). The admin account is expected to have appropriate permissions to query all users, groups, and attributes desired.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ldap.admin.password</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The admin password on your LDAP server (ex: <code>secret</code>)</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ldap.users.base</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The base DN at which to start looking for users on the LDAP server (<code>ex: ou=people,dc=example,dc=com</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#x2713;</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ldap.users.filter</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An optional LDAP filter for retrieved users. (ex: <code>(businessCategory=Managers)</code> )</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ldap.users.id</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The field name on users that the Mobi application will use as the username to log in (ex: <code>uid</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#x2713;</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ldap.users.firstName</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The field name on users whose value is the first name of the user (ex: <code>givenName</code>)</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ldap.users.lastName</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The field name on users whose value is the last name of the user (ex: <code>sn</code>)</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ldap.users.email</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The field name on users whose value is the email address of the user (ex: <code>mail</code>)</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ldap.users.membership</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The field name on users whose values are the groups they are a part of (ex: <code>memberOf</code>). If the field not available, it can be left blank.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#x2713;</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ldap.users.membership.search</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The format of the user membership field. Should be set to the field name on groups that the values of the user membership field uses. If this is not set, assume the values are full group DNs. (ex: <code>cn</code>)</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ldap.groups.base</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The base DN at which to start looking for groups on the LDAP server (ex: <code>ou=groups,dc=example,dc=com</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#x2713;</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ldap.groups.filter</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An optional LDAP filter for retrieved groups (ex: <code>(businessCategory=Managers)</code> )</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ldap.groups.id</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The field name for groups' ids (ex: <code>dn</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#x2713;</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ldap.groups.name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The field name for groups' names/titles (ex: <code>title</code>)</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ldap.groups.description</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The field name on groups whose value is the description of the group (ex: <code>description</code>)</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ldap.groups.membership</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The field name on groups whose values are the users that are a part of the group (ex: <code>member</code>).  If the field not available, it can be left blank.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#x2713;</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ldap.groups.membership.search</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The format of the group membership field. Should be set to the field name on users that the values of the group membership field uses. If this is not set, assume the values are full user DNs. (ex: <code>uid</code>)</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>An example file would look like this.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">repository.target = (id=system)
ldap.server = localhost
ldap.port = 10389
ldap.timeout = 30
ldap.admin.dn = uid=admin,ou=system
ldap.admin.password = secret
ldap.users.base = ou=people,dc=example,dc=com
ldap.users.filter = (businessCategory=Superhero)
ldap.users.id = uid
ldap.users.firstName = givenName
ldap.users.lastName = sn
ldap.users.membership = memberOf
ldap.groups.base = ou=groups,dc=example,dc=com
ldap.groups.id = cn
ldap.groups.name = cn
ldap.groups.description = description
ldap.groups.membership = member</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sso_configuration_enterprise">SSO Configuration (ENTERPRISE)</h5>
<div class="paragraph">
<p>In Enterprise deployments only, Mobi can be configured to integrate with an SSO provider for authentication. LDAP can be configured alongside the SSO provider to retrieve additional user details, but it is not required. If configured, it is recommended to disable direct authentication against the LDAP directory by adding <code>ldap.disable-auth = false</code> to the <code>com.mobi.enterprise.ldap.impl.engine.LDAPEngine.cfg</code> file. Mobi supports SAML, OAuth 2.0, and OpenID SSO providers.</p>
</div>
<div class="sect5">
<h6 id="saml_configuration">SAML Configuration</h6>
<div class="paragraph">
<p>In order to configure Mobi to use SAML, you will need to create a file called <code>com.mobi.enterprise.auth.saml.api.SAMLConfigProvider.cfg</code> to the <code>$MOBI_HOME/etc/</code> directory. The must have the following fields.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<code>${karaf.etc}</code> is a reference to the <code>$MOBI_HOME/etc/</code> directory that the
application will understand and replace
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
In order for the <code>certFile</code> to ba valid format, it must contain the appropriate <code>-----BEGIN CERTIFICATE-----</code> header and <code>-----END CERTIFICATE-----</code> footer
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Property Name</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
<th class="tableblock halign-left valign-top"><strong>Required</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>title</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The title for the SSO provider. This title will be used in the UI for triggering the SSO authentication in the format of “Login with <em>title”</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#x2713;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>entityId</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The SP EntityId. The SSO provider must be configured to expect requests with this SP EntityId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#x2713;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>certFile</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The file path to a file containing the X509 certificate for verifying the signature of SAML responses. Best practice is to put the file in the <code>$MOBI_HOME/etc/</code> directory and make this value <code>${karaf.etc}/&lt;INSERT-FILE-NAME&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#x2713;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>keyFile</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The optional file path to a file containing the PKCS8 key for verifying the signature of SAML responses. Best practice is to put the
file in the <code>$MOBI_HOME/etc/</code> directory and make this value <code>${karaf.etc}/&lt;INSERT-FILE-NAME&gt;</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ssoUrl</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The URL for the SingleSignOnService from the IdP. This is where Mobi will redirect to.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#x2713;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>idAttribute</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the <code>Attribute</code> in the SAML response where the username can be found. Defaults to using the <code>&lt;UserId&gt;</code>.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ssoBinding</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The full URN of the binding to be used for the SAML Requests. Defaults to <code>urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Redirect</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>standalone</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether the SAML configuration should be considered by itself or with a LDAP backend as well. Defaults to <code>false</code>. If <code>true</code>, the properties below are applied.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>firstNameAttribute</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An optional property to specify the name of the attribute in the SAML responses that contains the first name of the authenticated user. Only applicable if <code>standalone</code>.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>lastNameAttribute</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An optional property to specify the name of the attribute in the SAML responses that contains the last name of the authenticated user. Only applicable if <code>standalone</code>.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>emailAttribute</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An optional property to specify the name of the attribute in the SAML responses that contains the email of the authenticated user. Only applicable if <code>standalone</code>.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>groupAttribute</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An optional property to specify the name of the attribute in the SAML responses that contains the groups that the authenticated user is a part of. The values of this attribute will be used as the Group&#8217;s title in Mobi. Only applicable if <code>standalone</code>.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>An example file with an LDAP backend would look like this.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">title=Samling
entityId=https://localhost:8443/mobi/#/login
certFile=${karaf.etc}/samling.cert
keyFile=${karaf.etc}/samling_pkcs8.key
ssoUrl=https://capriza.github.io/samling/samling.html
idAttribute=ShortName
ssoBinding=urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST</code></pre>
</div>
</div>
<div class="paragraph">
<p>An example <code>standalone</code> configuration would look like this.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">title=Samling
entityId=https://localhost:8443/mobi/#/login
certFile=${karaf.etc}/samling.cert
keyFile=${karaf.etc}/samling_pkcs8.key
ssoUrl=https://capriza.github.io/samling/samling.html
idAttribute=ShortName
ssoBinding=urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST
standalone=true
firstNameAttribute=FirstName
lastNameAttribute=LastName
emailAttribute=MBox
groupAttribute=Groups</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="default_saml_token_duration">Default SAML Token Duration</h6>
<div class="paragraph">
<p>In order to configure the token duration for SAML logins, you must create a file called <code>com.mobi.enterprise.auth.rest.SAMLRest.cfg</code> with the following properties and put it in the <code>$MOBI_HOME/etc/</code> directory before starting the application, otherwise the token duration will use the default of one day. There is only one possible field for the config file as shown in the table below that is configurable and not required to set the token duration value.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Property Name</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
<th class="tableblock halign-left valign-top"><strong>Required</strong></th>
<th class="tableblock halign-left valign-top"><strong>Default</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>tokenDurationMins</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Token Duration time in minutes</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1440</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>An example file would look like this.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">### 1 day token duration
tokenDurationMins = 1440</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="oauthopenid_configuration">OAuth/OpenID Configuration</h6>
<div class="paragraph">
<p>In order to configure Mobi to use OAuth or OpenID, you will need to create two files in the <code>$MOBI_HOME/etc</code> directory: <code>com.mobi.enterprise.auth.oauth.api.OAuthConfigProvider.cfg</code> and <code>com.mobi.enterprise.auth.oauth.impl.token.OAuthTokenLoginModuleProvider.cfg</code>. The latter must be an empty file. The former can be used to configure a generic OAuth 2.0 Provider or an OpenID Provider. For either, the file must have the following fields.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Property Name</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
<th class="tableblock halign-left valign-top"><strong>Required</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>title</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The title for the SSO provider. This title will be used in the UI for triggering the SSO authentication in the format of “Login with <em>title”</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#x2713;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>clientId</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The ID for the Mobi installation. The OAuth/OpenID provider must be configured to expect requests with this clientId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#x2713;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>scope</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The OAuth scopes to include in the authentication request</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#x2713;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>clientSecret</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The optional client secret to use in requests to the OAuth/OpenID provider.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>userIdentifierClaim</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An optional property to specify which claim in the returned JWT contains the user&#8217;s username. These values must match what is configured for the LDAP users id. Defaults to using the <code>sub</code> of the JWT</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>standalone</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether the OAuth/OpenID configuration should be considered by itself or with a LDAP backend as well. Defaults to <code>false</code>. If <code>true</code>, the property below is applied.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>groupClaim</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An optional property to specify which claim in the returned JWT contains the groups the user is a part of. The values of this attribute will be used as the Group&#8217;s title in Mobi. Only applicable if <code>standalone</code>.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>For OAuth 2.0, the file must also contain these fields.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Property Name</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
<th class="tableblock halign-left valign-top"><strong>Required</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>grantType</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The OAuth 2.0 grant type to use for authentication. Mobi currently supports the CODE and IMPLICIT flows.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#x2713;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>redirectUrl</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The URL for the OAuth/OpenID provider. This is where Mobi will redirect to.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#x2713;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>tokenUrl</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The URL to hit to retrieve the token in the CODE flow.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>keyFile</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The file path to a file containing the PKCS8 key for verifying the signature of JWT tokens. Best practice is to put the file in the <code>$MOBI_HOME/etc/</code> directory and make this value <code>${karaf.etc}/&lt;INSERT-FILE-NAME&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#x2713;</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>An example file would look like this.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">title=Mock OAuth
clientId=mobi
scope=read,openid
grantType=CODE
redirectUrl=http://localhost:8080/authorize
tokenUrl=http://localhost:8080/token
keyFile=${karaf.etc}/NTs4oGbx1A-cROpjgUKdKtzTEkHUhhSwQ7xdhN6FdlQ_pub.pem</code></pre>
</div>
</div>
<div class="paragraph">
<p>For OpenID, the file must also contain these fields.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Property Name</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
<th class="tableblock halign-left valign-top"><strong>Required</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>openidConfigHostname</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The hostname of the OpenID provider. The standard <code>/.well-known/openid-configuration</code> path will be appended to this value.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#x2713;</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>An example file would look like this.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">title=Mock OAuth
clientId=mobi
scope=read,openid
openidConfigHostname=http://localhost:8080</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="azure_ad_openid_setup">Azure AD OpenID Setup</h6>
<div class="paragraph">
<p>If you want to configure OpenID integration with Azure AD, there are a few extra steps that need to be taken due to the unique structure of the returned JWTs.</p>
</div>
<div class="paragraph">
<p>The complementary LDAP configuration for an Azure AD OpenID provider must set the <code>userPrincipalName</code> as the <code>ldap.users.id</code> property in the <code>com.mobi.enterprise.ldap.impl.engine.LDAPEngine.cfg</code> as the Azure AD JWTs do not contain the typical <code>samAccountName</code> values.</p>
</div>
<div class="paragraph">
<p>In addition, v2.0 of Azure AD adds an additional field to the header of the JWT after signing it, thus making the signature incapable of being verified by the algorithms returned from the JWKS endpoint. In order to stop Azure AD from adding this additional field, you can add a new custom scope to the App registration. The steps to do this are described in this article (<a href="https://medium.com/@abhinavsonkar/making-azure-ad-oidc-compliant-5734b70c43ff" class="bare">https://medium.com/@abhinavsonkar/making-azure-ad-oidc-compliant-5734b70c43ff</a>) under “Problem 1”.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="password_encryption_configuration">Password Encryption Configuration</h5>
<div class="paragraph">
<p>Mobi provides a way to automatically encrypt plaintext passwords stored within service configurations on startup and subsequent updates. The setup for this is very short. All you have to do is ensure that a file called <code>com.mobi.security.api.EncryptionService.cfg</code> exists in the <code>$MOBI_HOME/etc</code> directory and contains the following fields:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">enabled=true
password=ENTER_A_UNIQUE_PASSWORD_HERE</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This password is not the password you want to encrypt, rather it is a unique master password used for encrypt and decrypt operations.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This encryption config is present and enabled by default, meaning your passwords will be automatically encrypted. An alternate way of providing an encryption master password is via environment variable. To configure the use of an environment variable, use the following fields:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">enabled=true
variable=MY_CHOSEN_ENVIRONMENT_VARIABLE</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you use an environment variable, make sure before you start Mobi that you have stored a
unique password as the value for that environment variable.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
If there is a default password in the Encryption Config (i.e. <code>CHANGEME</code>) make sure you change it to a unique password before starting Mobi, otherwise your passwords will be easy to decrypt.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Once the encryption config is added, start Mobi and if a Mobi service configuration includes a plaintext password, it will encrypt the value and update the configuration file. To change an encrypted value, simply replace it with the new plaintext value in the configuration file and after a few seconds it will be automatically re-encrypted and the file will be updated.</p>
</div>
<div class="sect5">
<h6 id="services_that_use_encryption">Services that use Encryption</h6>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Service</strong></th>
<th class="tableblock halign-left valign-top"><strong>Config File</strong></th>
<th class="tableblock halign-left valign-top"><strong>Field that gets encrypted</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LDAP (ENTERPRISE)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>com.mobi.enterprise.ldap.impl.engine.LDAPEngine.cfg</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ldap.admin.password</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SSO OAuth/OpenId (ENTERPRISE)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>com.mobi.enterprise.auth.oauth.api.OAuthConfigProvider.cfg</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>clientSecret</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Email</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>com.mobi.email.api.EmailService.cfg</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>emailPassword</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>To update the encryption master password, change the password field in the <code>com.mobi.security.api.EncryptionService.cfg</code> file while Mobi is running. After a few seconds have passed, all passwords will be automatically re-encrypted using the new master password.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If the master password is changed while Mobi is not running, all previously encrypted passwords must be re-entered in plain text for the encryption service to re-encrypt.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect4">
<h5 id="ontology_cache_configuration">Ontology Cache Configuration</h5>
<div class="paragraph">
<p>Mobi utilizes a caching mechanism within a triple store to improve performance when retrieving ontology data. The maintenance and cleanup of that cache is configured in the <code>com.mobi.cache.impl.repository.CleanupRepositoryCache.cfg</code> file in the <code>$MOBI_HOME/etc</code> directory.</p>
</div>
<div class="paragraph">
<p>This file is responsible for deleting stale ontologies within the repository after a specified period in order to preserve resources and improve processing. The format looks like the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">repoId = ontologyCache
expiry = 1800
scheduler.expression=0 0 * * * ?</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="banner_configuration_enterprise">Banner Configuration (ENTERPRISE)</h5>
<div class="paragraph">
<p>In Enterprise deployments only, Mobi can be configured to show a banner at the top of every page with custom HTML and background color.  To enable the banner and configure the content, edit the <code>com.mobi.enterprise.branding.rest.BrandingRest.cfg</code> file in the <code>$MOBI_HOME/etc</code> directory. The default contents will look like this.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">enabled=false
htmlBody=&lt;div&gt;Change me&lt;/div&gt;
backgroundColor=white</code></pre>
</div>
</div>
<div class="paragraph">
<p>There are three properties in the file that control how the banner is shown to the user. The <code>enabled`</code> property controls whether the banner should be shown and accepts either “true” or “false”. The <code>htmlBody</code> property accepts any valid HTML string that will be the body of the banner. The <code>backgroundColor</code> property accepts any valid hex string representing a color. This <a href="https://www.w3schools.com/colors/colors_picker.asp">W3School site</a> provides a helpful tool for picking HTML color that will output a hex string for you.</p>
</div>
<div class="paragraph">
<p>An example configuration could look like this which will result in the the screenshots below. Note that hyperlinks are supported within the HTML body.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">enabled=false
htmlBody=&lt;div&gt;Change me&lt;/div&gt;
backgroundColor=white</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/configuration/login-banner.png" alt="login banner">
</div>
<div class="title">Figure 117. Mobi Login Screen with a banner</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/configuration/home-banner.png" alt="home banner">
</div>
<div class="title">Figure 118. Mobi Home Page with a banner</div>
</div>
<div class="sect5">
<h6 id="multi_line_html_template">Multi-Line HTML Template</h6>
<div class="paragraph">
<p>To use a multiline value for htmlBody, add a <code>\</code> (backslash) to the end of each line. See an example below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">enabled=true
htmlBody= &lt;div&gt;\
   Change me \
   &lt;a href="url"&gt;http://www.google.com&lt;/a&gt; \
 &lt;/div&gt;
backgroundColor=#99ffce</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="inline_css">Inline CSS</h6>
<div class="paragraph">
<p>The <code>htmlBody</code> property supports inline CSS such as <code>&lt;p style=”color:red”&gt;This is RED.&lt;/p&gt;</code>. Inline CSS can be useful for adding custom styling to specific elements in the custom content and will override internal or external style sheets.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Because inline styles take precedence, you could accidentally override internal or external styles that you did not intend to. For example, changing the element positioning like in the configuration below could break the general layout of the application.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">enabled=true
htmlBody= &lt;div style="position:absolute; top:80px; width:300px; height:300px;right:50%;background: black;"&gt;\
   Change me \
   &lt;a href="url"&gt;http://www.google.com&lt;/a&gt; \
 &lt;/div&gt;
backgroundColor=#99ffce</code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="email_service_configuration">Email Service Configuration</h5>
<div class="paragraph">
<p>The configuration for the Mobi Email Service is stored in the <code>com.mobi.email.api.EmailService.cfg</code> file in the <code>$MOBI_HOME/etc</code> directory The Mobi Email Service is built on the Apache Commons Email API. The Email Service provides the ability to connect to a provided SMTP server and send an email using a configured email account. By default, the service is configured to connect to a Gmail SMTP server. The service has configurations for <code>smtpServer</code>, <code>port</code>, <code>emailAddress</code>, <code>emailPassword</code>, <code>security</code>, and <code>emailTemplate</code>. Please see below for different configurations of popular email services.</p>
</div>
<div class="sect5">
<h6 id="gmail">Gmail</h6>
<div class="paragraph">
<p>To send emails with Gmail, you must also follow the steps <a href="https://myaccount.google.com/lesssecureapps">here</a> to allow less secure apps to access the gmail account. Gmail also has <a href="https://support.google.com/a/answer/166852">strict sending limits</a> that can impair functionality as your organization grows. Additionally, Gmail may flag a machine that it does not recognize and prevent access. If this occurs, log in to your gmail and <a href="https://myaccount.google.com/device-activity">grant the device access</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">smtpServer = smtp.gmail.com
emailAddress = my.email@gmail.com
emailPassword = my-password
port = 587
security = STARTTLS
emailTemplate = emailTemplate.html</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="outlook">Outlook</h6>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">smtpServer = smtp-mail.outlook.com
emailAddress = my.email@outlook.com
emailPassword = my-password
port = 587
security = STARTTLS
emailTemplate = emailTemplate.html</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="office_365">Office 365</h6>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">smtpServer = smtp.office365.com
emailAddress = my.email@yourdomain.com
emailPassword = my-password
port = 587
security = STARTTLS
emailTemplate = emailTemplate.html</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="yahoo">Yahoo</h6>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">smtpServer = smtp.mail.yahoo.com
emailAddress = my.email@yahoo.com
emailPassword = my-password
port = 465
security = STARTTLS
emailTemplate = emailTemplate.html</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="mailgun">Mailgun</h6>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">smtpServer = smtp.mailgun.org
emailAddress = my.email@mg.gitlab.com
emailPassword = my-password
port = 587
security = STARTTLS
emailTemplate = emailTemplate.html</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="email_template">Email Template</h6>
<div class="paragraph">
<p>The Mobi Email Email Service supplies a default email template that works across most email clients. The default file is located in the <code>$MOBI_HOME/etc</code> directory. If you want to provide your own email template, modify the <code>emailTemplate</code> configuration to the new email template with either a relative or absolute path to the file. The email service will resolve relative file paths for an email template using the <code>$MOBI_HOME/etc</code> directory as the base directory.</p>
</div>
<div class="paragraph">
<p>The email service provides a method for doing a simple string replace on the <code>!|$MESSAGE!|$</code> binding within the template. For more complex HTML inserts, the service provides a method to replace all HTML between the two <code>!|$BODY!|$</code> bindings. Custom templates must have the aforementioned bindings (<code>!|$MESSAGE!|$</code> &amp; <code>!|$BODY!|$</code>). The <code>!|$MESSAGE!|$</code> binding must be between two <code>!|$BODY!|$</code> bindings. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">&lt;html lang="en" xmlns="http://www.w3.org/1999/xhtml"&gt;
...
&lt;body&gt;
!|$BODY!|$
&lt;table&gt;
    &lt;tbody&gt;
    &lt;tr&gt;
        &lt;td&gt;
            &lt;p&gt;
                &lt;!-- A simple message to replace --&gt;
                !|$MESSAGE!|$
            &lt;/p&gt;
        &lt;/td&gt;
    &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;
!|$BODY!|$
...
&lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="apache_karaf">Apache Karaf</h4>
<div class="paragraph">
<p>The Karaf instance that runs Mobi can be configured using the configuration files located in the <code>$MOBI_HOME/etc</code>
 directory.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 4. Relevant Karaf Configuration Files</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Configuration File</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.ops4j.pax.url.mvn.cfg</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configurations for Maven repositories used for bundle resolution and deployment</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.ops4j.pax.web.cfg</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configurations for HTTPS connections</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The <code>org.ops4j.pax.url.mvn.cfg</code> file specifies how Apache Karaf will resolve Maven URLs. This file is set up so that
Apache Karaf will use the basic Maven repositories along with your local Maven repository and the public Mobi remote
repository to resolve artifacts.</p>
</div>
<div class="paragraph">
<p>The <code>org.ops4j.pax.web.cfg</code> file configures the web service Apache Karaf uses to run Mobi. By default, Mobi only
runs HTTPS on port 8443.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="mobi-shell-guide">Mobi Shell</h3>
<div class="paragraph">
<p>The Mobi Shell is a wrapper around the Karaf shell which provides additional commands and tools for working with Mobi data. To access the shell, run the <code>bin/client</code> script in <code>$MOBI_HOME</code> (that&#8217;s <code>bin\client.bat</code> for you Windows users). The startup screen of the Mobi shell looks like the following.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-plaintext hljs" data-lang="plaintext">                 @#@@
                @###@
               @@@@@                   _     _
   @@@       @@@@      _ __ ___   ___ | |__ (_)
  @,,,@@@@@&amp;    @     | '_ ` _ \ / _ \| '_ \| |
  @,,&amp;&amp;     @  @      | | | | | | (_) | |_) | |
              @@      |_| |_| |_|\___/|_.__/|_|
               @@
              @///@
              @////&amp;
               @@@@


  mobi (x.x.x)
  Powered by Apache Karaf (4.0.6)

Hit '&lt;tab&gt;' for a list of available commands
and '[cmd] --help' for help on a specific command.
Hit '&lt;ctrl-d&gt;' or 'osgi:shutdown' to shutdown mobi.

karaf@mobi&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Mobi specific commands all start with <code>mobi:</code>. To view the list of available commands, type <code>mobi:</code> and hit <kbd>TAB</kbd>. To get information about a particular command, type the name of the command and <code>--help</code> afterwards and run it. For example, running <code>mobi:import --help</code> would show you this.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-plaintext hljs" data-lang="plaintext">karaf@mobi&gt;mobi:import --help
DESCRIPTION
        mobi:import

	Imports objects to a repository or dataset

SYNTAX
        mobi:import [options] ImportFile

ARGUMENTS
        ImportFile
                The file to be imported into the repository

OPTIONS
        -c, --continueOnError
                If true, continue parsing even if there is an error on a line.
        -d, --dataset
                The id of the DatasetRecord the file will be imported to
        -r, --repository
                The id of the repository the file will be imported to
        --help
                Display this help message
        -b, --batchSize
                The number representing the triple transaction size for importing.
                (defaults to 10000)</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also run commands in the Mobi shell without opening it by running <code>bin/client "command"</code>. For example, to run the <code>mobi:repository-list</code> command, you would run <code>bin/client "mobi:repository-list"</code>. If the command you are running involves files with spaces in the name, make sure the spaces are escaped, meaning use <code>"\ "</code> instead of <code>" "</code>. The same goes for commands that include text within quotes, make sure the quotes are escaped as well.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="administration-guide">Administration Guide</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Mobi is made available as a compressed distribution package available <a href="https://mobi.inovexcorp.com/features/#download">here</a>. Deployment consists of unpacking this distribution to an appropriate location on the filesystem and modifying included configuration files. Mobi comes pre-bundled with an open-source, file-based RDF database. By default, all data, logs, and configurations will be stored in the extracted file location.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Mobi Enterprise will not start without a valid license file. You will need to collect your server ID from the installation and provide it to the sales or support team so they can create your unique license file.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="mobi_requirements">Mobi Requirements</h3>
<div class="sect3">
<h4 id="hardware_requirements">Hardware Requirements</h4>
<div class="paragraph">
<p>We provide recommended hardware requirements as a guideline. These specifications are based on standard deployment environments. Larger production data or user requirements may require more powerful hardware configurations.</p>
</div>
<div class="paragraph">
<p>The table below provides a summary of the recommended hardware for production servers and the minimum requirements for test servers.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Component</strong></th>
<th class="tableblock halign-left valign-top"><strong>Minimum</strong></th>
<th class="tableblock halign-left valign-top"><strong>Recommended</strong></th>
<th class="tableblock halign-left valign-top"><strong>Guidelines</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Available RAM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 GB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8 GB or more</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mobi needs enough RAM to load large
ontology and data files and run Mobi processes. The configurations
provided refer to maximum Java heap size.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Disk Space</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10 GB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">40 GB or more</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">By default, Mobi stores all data and
configurations in the extracted file location.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CPU</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 core</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 cores or more</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Multi-core configurations dramatically
improve performance of the bundled application server and database.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="software_requirements">Software Requirements</h4>
<div class="paragraph">
<p>The table below provides a summary of the software requirements.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Component</strong></th>
<th class="tableblock halign-left valign-top"><strong>Minimum</strong></th>
<th class="tableblock halign-left valign-top"><strong>Recommended</strong></th>
<th class="tableblock halign-left valign-top"><strong>Guidelines</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Operating System</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RHEL/CentOS 6<br>
Windows 7<br>
OSX</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RHEL/CentOS 8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mobi runs within standard Java runtimes; however, we
recommend RHEL/CentOS operating systems for on-premise or cloud-based
server environments.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Java</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.17</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.17 (latest)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The latest versions of Java 17 include security
and performance updates.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Web Browser</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Chrome<br>
Firefox<br>
Safari<br>
Edge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Chrome</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Use the latest versions of web browsers for best
compatibility, performance, and security.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="firewall_requirements">Firewall Requirements</h4>
<div class="paragraph">
<p>The table below lists the TCP ports to open on the Mobi host.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Port</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">8443</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Application HTTPS port.</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
We recommend running Mobi on the default port 8443 and using firewall configuration or a proxy server for SSL (port 443) termination and redirection. Mobi does not run on non-SSL ports by default.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="installing_mobi">Installing Mobi</h3>
<div class="sect3">
<h4 id="pre_installation_configuration">Pre-Installation Configuration</h4>
<div class="sect4">
<h5 id="create_service_account">Create Service Account</h5>
<div class="paragraph">
<p>Before installing Mobi, create a service account on the host server. The account will be used to run Mobi. The service account should meet the following requirements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The service account must have read and write permissions for the Mobi installation directory. On Linux, this is typically <code>/opt/mobi/mobi-distribution-&lt;version&gt;</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>On a standard RHEL/CentOS system, this can be created using the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">sudo useradd -d /opt/mobi mobi</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="install_java_17">Install Java 17</h5>
<div class="paragraph">
<p>Mobi requires the latest version of Java 1.17 to operate. On a standard RHEL/CentOS system, there is no package available via <code>yum</code> to install. So we suggest Downloading the Oracle installer from <a href="https://www.oracle.com/java/technologies/downloads/#java17">here</a> and running it manually using the following commands:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">wget https://download.oracle.com/java/17/latest/jdk-17_linux-x64_bin.rpm
sudo rpm -Uvh jdk-17_linux-x64_bin.rpm</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If you are using a Red Hat system, you can install Java 17 with <code>sudo yum install java-17-openjdk</code>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>JAVA_HOME</code> environment variable must be set for the user running Mobi. On a standard RHEL/CentOS system (after running the rpm above) this can be set using the following commands:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">sudo su - mobi
echo 'export JAVA_HOME=/usr/java/jdk-17.0.4.1' &gt;&gt; ~/.bashrc
exit</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="install_mobi">Install Mobi</h4>
<div class="paragraph">
<p>Follow the instructions below to install Mobi. These instructions assume that you have copied the Mobi distribution to the server.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
These instructions are prepared for a standard RHEL/CentOS deployment
server.
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Unpack Mobi to the installation parent directory (e.g. <strong>/opt/mobi</strong>)</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">sudo su - mobi
tar -xf $MOBI_HOME.tar.gz</code></pre>
</div>
</div>
</li>
<li>
<p>Create a symlink to the latest distribution</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">ln -s $MOBI_HOME latest</code></pre>
</div>
</div>
</li>
<li>
<p>Start the Mobi server</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">cd latest
./bin/start</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>All Mobi prepackaged bundles, services, and required artifacts and dependencies will be automatically deployed by the runtime once started. The Mobi web application should now be accessible at <code><a href="https://localhost:8443/avm/index.html" class="bare">https://localhost:8443/avm/index.html</a></code> (or substitute <code>localhost</code> with the hostname/IP address of the machine running the process dependant on firewall configurations). The default login credentials are <code>admin:admin</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Due to the self-signed SSL certificate that Mobi comes with, your browser will likely show you a certificate warning when first loaded. This is safe to proceed past. See <a href="#configure_custom_ssl_certificates">Configure Custom SSL Certificates</a> for more details.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To stop the Mobi server, run the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./bin/stop</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="server-id-license-file">Server ID and License File (ENTERPRISE)</h5>
<div class="paragraph">
<p>If you are running Mobi Enterprise, then the installation will have stopped immediately after attempting to start in the previous section. This is because Mobi Enterprise requires a valid license file to run. Follow the steps below to collect your Mobi Server ID and get a add a license file to your installation.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Running the <code>bin/start</code> script from the previous section will output your unique server ID to the <code>$MOBI_HOME/etc/com.mobi.platform.server.cfg</code> file. Open that file and copy the Server ID from the <code>serverId</code> property. It should look like the following.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">serverId = "{UUID}"</code></pre>
</div>
</div>
</li>
<li>
<p>Send this Server ID to the sales or support team so they can generate you a valid license file.</p>
</li>
<li>
<p>Copy the provided license file to the <code>$MOBI_HOME/etc/</code> directory.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">cp license.lic $MOBI_HOME/etc/</code></pre>
</div>
</div>
</li>
<li>
<p>Now you can start the Mobi installation.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">cd latest
./bin/start</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="post_installation_configuration">Post-Installation Configuration</h4>
<div class="paragraph">
<p>In addition to the steps below, Mobi supports a number of configurations to customize your installation and users' experience. See the <a href="#mobi">Mobi Configurations</a> section for more details.</p>
</div>
<div class="sect4">
<h5 id="change_the_default_java_heap_size">Change the Default Java Heap Size</h5>
<div class="paragraph">
<p>Set the max heap size in <code>$MOBI_HOME/bin/setenv</code> (e.g. <code>JAVA_MAX_MEM=4G</code>). In version 1.21, to include the <code>JAVA_MAX_MEM</code> and <code>JAVA_MIN_MEM</code> variables in the Mobi startup, add the following line beneath them in the <code>setenv</code> file.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
All versions from 1.22 onwards have this line already added.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">export JAVA_OPTS="-Xms${JAVA_MIN_MEM} -Xmx${JAVA_MAX_MEM}"</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="set_the_host_name">Set the Host Name</h5>
<div class="paragraph">
<p>If the Mobi installation will be communicating with external systems, most of those connections utilize a core hostname configuration in order to build the appropriate callback URLs. This setting is within <code>$MOBI_HOME/etc/com.mobi.platform.server.cfg</code> and defaults to <a href="https://localhost:8443" class="bare">https://localhost:8443</a>. If your external systems are not hosted on the same machine, this needs to be a resolvable host that can be reached, for example a DNS record you have configured in your enterprise.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">hostName = &lt;APP_HOST_NAME&gt;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="change_the_default_web_port">Change the Default Web Port</h5>
<div class="paragraph">
<p>If required, change the default SSL port in <code>$MOBI_HOME/etc/org.ops4j.pax.web.cfg</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">org.osgi.service.http.port.secure = &lt;SSL_APPLICATION_PORT&gt;</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
We recommend running Mobi on the default port 8443 and using firewall configuration or a proxy server for SSL (port 443) termination and redirection. Mobi does not run on non-SSL ports by default.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="configure_custom_ssl_certificates">Configure Custom SSL Certificates</h5>
<div class="paragraph">
<p>Mobi comes bundled with default self-signed SSL certificates stored in a <a href="https://www.sslshopper.com/article-most-common-java-keytool-keystore-commands.html">Java Keystore</a> file in <code>etc/keystore</code>. <strong>This self-signed certificate is why your browser will most likely show you a certificate warning when browsing to the web application.</strong></p>
</div>
<div class="paragraph">
<p>To provide your own SSL certificates, simply replace the default keystore file with your own:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">cp mycerts.jks $MOBI_HOME/etc/keystore</code></pre>
</div>
</div>
<div class="paragraph">
<p>If there is a keystore password, it can be configured in the <code>$MOBI_HOME/etc/org.ops4j.pax.web.cfg</code> file using the following configuration properties:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Configuration Property</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.ops4j.pax.web.ssl.keystore.password</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The password used for keystore
integrity check</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.ops4j.pax.web.ssl.key.password</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The password used for keystore</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<code>.p12</code> and <code>.jks</code> files should both be supported
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="installing_mobi_as_a_service">Installing Mobi as a Service</h5>
<div class="paragraph">
<p>We recommend that you configure Mobi as a Linux service for starting Mobi automatically as the service user. Follow the instructions below to implement the service on a standard RHEL/CentOS environment.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The below steps should be run as the root user.
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
Be sure to correctly configure the file locations and user.
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a file called <strong>mobi.service</strong> in the <code>/usr/lib/systemd/system</code> directory. For example:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ini hljs" data-lang="ini">[Unit]
Description=Mobi Service.
After=network.target
StartLimitIntervalSec=30

[Service]
Type=forking
PIDFile=/install_path/latest/karaf.pid
User=mobi
ExecStart=/install_path/latest/bin/start
ExecStop=/install_path/latest/bin/stop
ExecReload=/install_path/latest/bin/stop; /install_path/latest/bin/start
Restart=always

[Install]
WantedBy=default.target</code></pre>
</div>
</div>
</li>
<li>
<p>Save and close the file, and then run the following commands to start
and enable the new service:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">systemctl start mobi
systemctl enable mobi</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Once the service is enabled, Mobi should be running. The Mobi process will start and stop automatically with the server. Any time you start and stop Mobi manually, run the following systemctl commands: <code>sudo systemctl stop mobi</code> and <code>sudo systemctl start mobi</code>.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="upgrading_mobi">Upgrading Mobi</h3>
<div class="paragraph">
<p>Upgrades of the Mobi platform are performed via a backup/restore process where a <code>.zip</code> file is created of all the system data of the current installation and loaded into the new version installation. This process will handle any migration steps required when migrating to newer versions. The basic steps are outlined below and are applicable for any upgrades within major version (e.g. 2.1 to 2.4).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<code>$MOBI_HOME</code> is the extracted directory from your current Mobi distribution (e.g. <code>/path/to/mobi-distribution-2.3.2</code>).
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Run the following command to create a zipped backup of your old distribution. The name of the backup can be whatever you choose as long as it is a valid zip file name.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$MOBI_HOME/bin/client "mobi:backup -f /path/to/mobi-backup.zip"</code></pre>
</div>
</div>
</li>
<li>
<p>Shut down your old installation. If you installed Mobi as service, then use the appropriate <code>systemctl stop mobi</code> command.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$MOBI_HOME/bin/stop</code></pre>
</div>
</div>
</li>
<li>
<p>Unpack and start up the new distribution. If you created a symlink for your installation, make sure to update that link with <code>ln -sfn $NEW_MOBI_HOME latest</code>. If you installed Mobi as a service, the use the appropriate <code>systemctl start mobi</code> command after updating the symlink.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">tar -xf $NEW_MOBI_HOME.tar.gz
$NEW_MOBI_HOME/bin/start</code></pre>
</div>
</div>
</li>
<li>
<p>Run the following command with the path to your zipped backup to restore your data into the new installation. This process can take several minutes, but when it completes you will see a message that looks like "Restarting all services" and the application will restart with the new data.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$NEW_MOBI_HOME/bin/client "mobi:restore /path/to/mobi-backup.zip"</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The Mobi server can take several seconds to start up. If the <code>client</code> script fails, try again after a few seconds. If the server is not starting, check the logs in <code>$NEW_MOBI_HOME/data/log/karaf.log</code>.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
There are two files which are not included in the backup whose contents will need to be manually updated in the new distribution. The <code>$NEW_MOBI_HOME/bin/setenv</code> file contains the Java Max and Min Memory settings that should be updated to the desired levels post upgrade (See <a href="#change_the_default_java_heap_size">Change the Default Java Heap Size</a>). The <code>$NEW_MOBI_HOME/etc/com.mobi.platform.server.cfg</code> file holds a variable for the <span class="underline">hostName</span> of the application (See <a href="#set_the_host_name">Set the Host Name</a>). This will need to be manually updated to the previous value to support certain connections with other applications.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="developer_guide">Developer Guide</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="prerequisites_2">Prerequisites</h3>
<div class="paragraph">
<p>To build the Mobi source code, you must have the following software and tools installed.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Technology</th>
<th class="tableblock halign-left valign-top">Version</th>
<th class="tableblock halign-left valign-top">Download Link</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Java</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">17</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html" class="bare">http://www.oracle.com/technetwork/java/javase/downloads/index.html</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maven</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3.6+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://maven.apache.org/download.cgi" class="bare">https://maven.apache.org/download.cgi</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Node.js</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">14+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://nodejs.org/en/download/" class="bare">https://nodejs.org/en/download/</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Google Chrome</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">105+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://www.google.com/chrome/" class="bare">https://www.google.com/chrome/</a></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="build_from_source">Build from Source</h3>
<div class="paragraph">
<p>Clone the Mobi project from <a href="https://github.com/matonto/matonto">GitHub</a> and navigate to that directory on your machine. Run the following command to build the source:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">mvn clean install</code></pre>
</div>
</div>
<div class="paragraph">
<p>The build creates the Mobi distribution as both a <code>.tar.gz</code> file and a <code>.zip</code> file in the <code>mobi-distribution/target</code> directory. Extract one of the files and navigate into that directory.</p>
</div>
<div class="paragraph">
<p>Inside the extracted distribution directory, start up the Mobi Karaf instance. For Unix/Linux:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">bin/start</code></pre>
</div>
</div>
<div class="paragraph">
<p>or for Windows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-powershell hljs" data-lang="powershell">bin\start.bat</code></pre>
</div>
</div>
<div class="paragraph">
<p>All the Mobi bundles and services and their dependencies will be automatically deployed using OBR.</p>
</div>
<div class="paragraph">
<p>The Mobi web application should now be accessible at <code><a href="https://localhost:8443/mobi/index.html" class="bare">https://localhost:8443/mobi/index.html</a></code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="load_dataset_data">Load Dataset Data</h3>
<div class="paragraph">
<p>Data can be manually loaded into an existing <a href="#datasets-manager-guide">Dataset</a> using the Mobi shell. You will need the full path to the data file and the IRI of the target DatasetRecord.</p>
</div>
<div class="paragraph">
<p>Open the <a href="#mobi-shell-guide">Mobi shell</a> and run the <code>mobi:import</code> command passing the IRI of the DatasetRecord and the path to the data file. For example, if you wanted to load data located at <code>/Users/tester/Documents/testData.trig</code> into the <code>https://mobi.com/records/my-dataset</code> DatasetRecord, you would run the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-plaintext hljs" data-lang="plaintext">mobi:import --dataset https://mobi.com/records/my-dataset /Users/tester/Documents/testData.trig</code></pre>
</div>
</div>
<div class="paragraph">
<p>All triples that are not within a named graph will be loaded into the <a href="#systemdefaultnamedgraph">system default named graph</a>. All triples within named graphs will be added and their named graphs associated with the Dataset.</p>
</div>
</div>
<div class="sect2">
<h3 id="accessing_swagger_rest_api_documentation">Accessing Swagger REST API Documentation</h3>
<div class="paragraph">
<p>Every installation of Mobi provides <a href="https://swagger.io/">Swagger</a> Documentation for the full suite of Mobi REST APIs. This documentation is provided as a standard Swagger YAML file as well as a fully interactive hosted version. The Swagger YAML file can be downloaded at <code>$MOBI_HOST/swagger-ui/mobi-swagger.yaml</code>. To reach the Swagger Documentation UI, navigate to <code>$MOBI_HOST/swagger-ui/index.html</code>. For example, in a default deployment these URLs would look like <a href="https://localhost:8443/swagger-ui/mobi-swagger.yaml" class="bare">https://localhost:8443/swagger-ui/mobi-swagger.yaml</a> and <a href="https://localhost:8443/swagger-ui/index.html" class="bare">https://localhost:8443/swagger-ui/index.html</a>, respectively. If the browser session is already logged into Mobi, there is no need to click the Authorize button.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/developer-guide/swagger-docs.png" alt="Swagger REST API Documentation">
</div>
</div>
</div>
<div class="sect2">
<h3 id="translating_documents">Translating Documents</h3>
<div class="paragraph">
<p>Files in the xml, json, or csv formats can be transformed into an ontology and corresponding instance data using Mobi&#8217;s
document translation tool. This experimental feature can be utilized via REST endpoint, the <a href="#mobi-shell-guide">Mobi shell</a>,
or from the <a href="#accessing_swagger_rest_api_documentation">Swagger UI</a>, with all methods providing users configuration
options to alter the generated files.</p>
</div>
<div class="sect3">
<h4 id="utilizing_the_mobi_shell">Utilizing the Mobi Shell</h4>
<div class="paragraph">
<p>The tool can be run from the Mobi shell with the <code>mobi:document-translate</code> command. The command accepts the full path
to both the input file to translate and output location for the result. Below is an example call to the command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-plaintext hljs" data-lang="plaintext">mobi:document-translate /Users/tester/Documents/example.json /Users/tester/Documents/outputDir</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Document Translate command accepts several additional configuration options to tailor the way the input file is
processed. These options currently include the ability to set the default namespace of the generated ontology and
instance data, specify the type of file being translated, and set a number of rows in a CSV to be analyzed before
identifying a data property range. The command result is a zip file located at the output destination that contains two
turtle files: ontology.ttl which will contain an ontology describing the structure of the input file and data.ttl which
will contain the data within your input file translated into RDF data conforming to the ontology.</p>
</div>
</div>
<div class="sect3">
<h4 id="utilizing_the_rest_endpoints_and_swagger_ui">Utilizing the REST endpoints and Swagger UI</h4>
<div class="paragraph">
<p>Mobi&#8217;s REST endpoints &amp; Swagger UI provide additional ways to use the document translation tool. When using either a
direct REST call or the Swagger UI, users are able to select an input file from their filesystem and convert it to valid RDF.
If successful, output is returned as a downloadable zip file. Similar to the output generated by the Mobi shell, this
zip file contains two turtle files containing the generated ontology and conforming instance data respectively.
Additionally, these two methods provides users the same configurable options that the Mobi shell does, with one
additional option. When using Rest endpoints or the Swagger UI to translate a document, users are able to also
specify the name of the output file. If one is not specified, the name of the input file will be used with a timestamp
added on to the end.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/developer-guide/translate-swagger-ui.png" alt="Document Translation Swagger Documentaion">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/developer-guide/translate-postman-ui.png" alt="Document Translation Postman Documentaion">
</div>
</div>
</div>
<div class="sect3">
<h4 id="translating_different_file_types">Translating Different File Types</h4>
<div class="sect4">
<h5 id="xml">XML</h5>
<div class="paragraph">
<p>The XML translator uses the hierarchical structure of the XML input file in order to construct classes and object
properties.</p>
</div>
<div class="imageblock text-left">
<div class="content">
<img src="images/developer-guide/XML_input_file.png" alt="XML Input File">
</div>
<div class="title">Figure 119. XML Example File</div>
</div>
<div class="paragraph">
<p>When generating the ontology, each element is simultaneously treated as a class and object property if it
has child elements and is regarded as a datatype property if it does not. The output will resemble a file similar
to the one below.</p>
</div>
<div class="imageblock text-left">
<div class="content">
<img src="images/developer-guide/XML_ont_file.png" alt="XML Ontology Ouput File">
</div>
<div class="title">Figure 120. XML Example Ontology File</div>
</div>
<div class="paragraph">
<p>The generated data file is composed of elements that have been deemed a class and that have literal values attached to it.
Each instance is given a unique IRI based on the namespace of the ontology with a trailing UUID attached at the end.</p>
</div>
<div class="imageblock text-left">
<div class="content">
<img src="images/developer-guide/XML_data_file.png" alt="XML Data Output File">
</div>
<div class="title">Figure 121. XML Example Data File</div>
</div>
</div>
<div class="sect4">
<h5 id="json">JSON</h5>
<div class="paragraph">
<p>Given a JSON file like below, the JSON translator will use the nested structure of JSON objects in order to construct
classes and object properties.</p>
</div>
<div class="imageblock text-left">
<div class="content">
<img src="images/developer-guide/JSON_file_input.png" alt="JSON Input File">
</div>
<div class="title">Figure 122. JSON Example File</div>
</div>
<div class="paragraph">
<p>An output ontology is then generated using the passed in IRI or a UUID as the namespace. Classes and object properties
relating these classes are created based on the keys present in the input file.</p>
</div>
<div class="imageblock text-left">
<div class="content">
<img src="images/developer-guide/JSON_ont_output.png" alt="JSON Ontology Output File">
</div>
<div class="title">Figure 123. JSON Example Ontology File</div>
</div>
<div class="paragraph">
<p>The generated data file is created by utilizing the literal values of each key object. For each instance of a JSON
object there is in the input file an RDF entity is created with the same namespace as the ontology.</p>
</div>
<div class="imageblock text-left">
<div class="content">
<img src="images/developer-guide/JSON_data_output.png" alt="JSON Data Output File">
</div>
<div class="title">Figure 124. JSON Example Data File</div>
</div>
</div>
<div class="sect4">
<h5 id="csv">CSV</h5>
<div class="paragraph">
<p>The CSV translation tool is the only translator that does not create multiple classes or any object properties. A
singular class is generated per file, with the name of the file being used as the name of the class.</p>
</div>
<div class="imageblock text-left">
<div class="content">
<img src="images/developer-guide/CSV_input_file.png" alt="CSV Input File">
</div>
<div class="title">Figure 125. CSV Example File</div>
</div>
<div class="paragraph">
<p>Each column header is treated as a different datatype property, with the translator parsing a certain number of rows to
determine the range of the property.</p>
</div>
<div class="imageblock text-left">
<div class="content">
<img src="images/developer-guide/CSV_ont_output.png" alt="CSV Ontology Ouput File">
</div>
<div class="title">Figure 126. CSV Example Ontology File</div>
</div>
<div class="paragraph">
<p>When creating the instance data, each row within the file is treated as an instance of the class with
the cell values being the object of the triples generated by the datatype properties.</p>
</div>
<div class="imageblock text-left">
<div class="content">
<img src="images/developer-guide/CSV_data_output.png" alt="CSV Data Output File">
</div>
<div class="title">Figure 127. CSV Example Data File</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="mobi_mappings">Appendix A: Mobi Mappings</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Mobi mappings are used to convert delimited data into RDF and are made up of instances of classes defined in a custom ontology found in the <code>com.mobi.etl.api/src/main/resources/delimited.ttl</code> file in the source code. These main classes are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code><a href="#mapping">Mapping</a></code></p>
</li>
<li>
<p><code><a href="#classmapping">ClassMapping</a></code></p>
</li>
<li>
<p><code><a href="#datamapping">DataMapping</a></code></p>
</li>
<li>
<p><code><a href="#objectmapping">ObjectMapping</a></code></p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>All examples in this Appendix will be in Turtle RDF serialization and use the following prefixes:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Prefix</th>
<th class="tableblock halign-left valign-top">Namespace</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>example</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">http://guide.org/</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>delim</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">http://mobi.com/ontologies/delimited#</p></td>
</tr>
</tbody>
</table>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="mapping">Mapping</h3>
<div class="paragraph">
<p>The <code>delim:Mapping</code> class represents the mapping itself. Every mapping must have one and only one instance of the <code>Mapping</code> class. Properties associated with this class provide information about the mapping that are needed for the <a href="#mapping-tool-guide">Mapping Tool</a> to have context. These properties are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code><a href="#sourcerecord">sourceRecord</a></code></p>
</li>
<li>
<p><code><a href="#sourcebranch">sourceBranch</a></code></p>
</li>
<li>
<p><code><a href="#sourcecommit">sourceCommit</a></code></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="sourcerecord">sourceRecord</h4>
<div class="paragraph">
<p>The <code>delim:sourceRecord</code> property specifies the <code>OntologyRecord</code> a mapping uses for its classes and properties. The <a href="#mapping-tool-guide">Mapping Tool</a> requires this property along with <code><a href="#sourcebranch">sourceBranch</a></code> and <code><a href="#sourcecommit">sourceCommit</a></code> to retrieve a specific version of an ontology saved in Mobi. A mapping will have access to all entities defined in ontologies within the imports closure of the source ontology. The Mapping Tool utilizes all class and property definitions to validate the class and property mappings and apply the correct datatypes to data property values.</p>
</div>
<div class="exampleblock">
<div class="title">Example 1. <code>sourceRecord</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="nowrap">example:DocumentExample delim:sourceRecord &lt;http://mobi.com/records/uhtc&gt; .</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sourcebranch">sourceBranch</h4>
<div class="paragraph">
<p>The <code>delim:sourceBranch</code> property specifies the <code>Branch</code> of the <code><a href="#sourcerecord">sourceRecord</a></code> a mapping uses for its classes and properties. The <a href="#mapping-tool-guide">Mapping Tool</a> requires this property along with <code><a href="#sourcerecord">sourceRecord</a></code> and <code><a href="#sourcecommit">sourceCommit</a></code> to retrieve a specific version of an ontology saved in Mobi. A mapping will have access to all entities defined in ontologies within the imports closure of the source ontology. The Mapping Tool utilizes all class and property definitions to validate the class and property mappings and apply the correct datatypes to data property values.</p>
</div>
<div class="exampleblock">
<div class="title">Example 2. <code>sourceBranch</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="nowrap">example:DocumentExample delim:sourceBranch &lt;http://mobi.com/branches/master&gt; .</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sourcecommit">sourceCommit</h4>
<div class="paragraph">
<p>The <code>delim:sourceCommit</code> property specifies the <code>Commit</code> of the <code><a href="#sourcebranch">sourceBranch</a></code> a mapping uses for its classes and properties. The <a href="#mapping-tool-guide">Mapping Tool</a> requires this property along with <code><a href="#sourcerecord">sourceRecord</a></code> and <code><a href="#sourcebranch">sourceBranch</a></code> to retrieve a specific version of an ontology saved in Mobi. A mapping will have access to all entities defined in ontologies within the imports closure of the source ontology. The Mapping Tool utilizes all class and property definitions to validate the class and property mappings and apply the correct datatypes to data property values.</p>
</div>
<div class="exampleblock">
<div class="title">Example 3. <code>sourceCommit</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="nowrap">example:DocumentExample delim:sourceCommit &lt;http://mobi.com/commits/0&gt; .</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="classmapping">ClassMapping</h3>
<div class="paragraph">
<p>The <code>delim:ClassMapping</code> class represents a blueprint for creating an instance of a class. Every <code>ClassMapping</code> defined in a mapping will create an instance of the class it maps to for every row in a set of delimited data. Each class instance created will have a generated IRI. Properties associated with this class specify how the class instance it creates should be constructed. These properties are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code><a href="#mapsto">mapsTo</a></code></p>
</li>
<li>
<p><code><a href="#dataproperty">dataProperty</a></code></p>
</li>
<li>
<p><code><a href="#objectproperty">objectProperty</a></code></p>
</li>
<li>
<p><code><a href="#hasprefix">hasPrefix</a></code></p>
</li>
<li>
<p><code><a href="#localname">localName</a></code></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="mapsto">mapsTo</h4>
<div class="paragraph">
<p>The <code>delim:mapsTo</code> property specifies the class a <code>ClassMapping</code> will create. This is a required property for a <code>ClassMapping</code> since otherwise, the <a href="#mapping-tool-guide">Mapping Tool</a> will not know which class to create an instance of. It must point to a class that is defined either within the source ontology of the mapping or one of the ontologies in the source ontology&#8217;s imports closure.</p>
</div>
<div class="exampleblock">
<div class="title">Example 4. <code>mapsTo</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="nowrap">example:ClassMappingExample delim:mapsTo &lt;http://mobi.com/ontologies/uhtc&gt; .</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="dataproperty">dataProperty</h4>
<div class="paragraph">
<p>The <code>delim:dataProperty</code> property specifies a <code><a href="#datamapping">DataMapping</a></code> that is associated with a <code>ClassMapping</code>. It must point to a <code><a href="#datamapping">DataMapping</a></code> instance defined within the mapping. A <code>ClassMapping</code> can have one or more of this property. Every instance of a class created from a <code>ClassMapping</code> will have the property specified in the <code><a href="#datamapping">DataMapping</a></code> specified by <code>dataProperty</code>.</p>
</div>
<div class="exampleblock">
<div class="title">Example 5. <code>dataProperty</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="nowrap">example:ClassMappingExample delim:dataProperty example:DataMapping1 ;
    delim:dataProperty example:DataMapping2 .</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="objectproperty">objectProperty</h4>
<div class="paragraph">
<p>The <code>delim:objectProperty</code> property specifies an <code><a href="#objectmapping">ObjectMapping</a></code> that is associated with a <code>ClassMapping</code>. It must point to a <code><a href="#objectmapping">ObjectMapping</a></code> instance defined within the mapping. A <code>ClassMapping</code> can have one or more of this property. Every instance of a class created from a <code>ClassMapping</code> will have the property specified in the <code><a href="#objectmapping">ObjectMapping</a></code> specified by <code>objectProperty</code>.</p>
</div>
<div class="exampleblock">
<div class="title">Example 6. <code>objectProperty</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="nowrap">example:ClassMappingExample delim:objectProperty example:ObjectMapping1 ;
    delim:objectProperty example:ObjectMapping2 .</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="hasprefix">hasPrefix</h4>
<div class="paragraph">
<p>The <code>delim:hasPrefix</code> property specifies the namespace of the IRI for every class instance created by a <code>ClassMapping</code>. This property is required by the <a href="#mapping-tool-guide">Mapping Tool</a> so it knows how to construct the IRI for each class instance created by the <code>ClassMapping</code>. The value of this property is a string and must be a valid namespace.</p>
</div>
<div class="exampleblock">
<div class="title">Example 7. <code>hasPrefix</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="nowrap">example:ClassMappingExample delim:hasPrefix "http://guide.org/example/" .</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="localname">localName</h4>
<div class="paragraph">
<p>The <code>delim:localName</code> property specifies how the local name of the IRI will be generated for every class instance created by a <code>ClassMapping</code>. This property points to a string literal and must be in the following format. The string must start with a dollar sign ($) and contain either the string "UUID" or a number surrounded by curly braces "{}". The "UUID" string will generate a unique identifier for every class instance created by the <code>ClassMapping</code>. A number will grab the value of the column at that zero-based index in the row being mapped. If the column specified has duplicate values, the <a href="#mapping-tool-guide">Mapping Tool</a> will combine the properties of every class instance with that IRI and combine them into a single instance. If this property is not set on a <code>ClassMapping</code>, the <a href="#mapping-tool-guide">Mapping Tool</a> will default to generating a UUID for every class instance.</p>
</div>
<div class="exampleblock">
<div class="title">Example 8. <code>localName</code></div>
<div class="content">
<div class="paragraph">
<p>This means every class instance will have a unique identifier for a local name.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">example:ClassMappingExample1 delim:localName "${UUID}" .</pre>
</div>
</div>
<div class="paragraph">
<p>This means every class instance will have the value from the third column for a local name.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">example:ClassMappingExample2 delim:localName "${2}" .</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="datamapping">DataMapping</h3>
<div class="paragraph">
<p>The <code>delim:DataMapping</code> class represents a blueprint for creating a data property on a class instance. Since data properties in an ontology point to literal values, a <code>DataMapping</code> specifies a column whose value in the row being mapped will be used as the value of the generated data property. Properties associated with this class define how a data property will be created. These properties are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code><a href="#columnindex">columnIndex</a></code></p>
</li>
<li>
<p><code><a href="#data-hasProperty">hasProperty</a></code></p>
</li>
<li>
<p><code><a href="#datatypespec">datatypeSpec</a></code></p>
</li>
<li>
<p><code><a href="#languagespec">languageSpec</a></code></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="columnindex">columnIndex</h4>
<div class="paragraph">
<p>The <code>delim:columnIndex</code> property specifies which column a <code>DataMapping</code> should pull the value from to set as the value of the generated data property. This property is required for a <code>DataMapping</code> so that the <a href="#mapping-tool-guide">Mapping Tool</a> knows where to get the value of a data property. All column values retrieved by this property are interpreted as strings. The value of this property must be a string and all the column indexes are zero-based.</p>
</div>
<div class="exampleblock">
<div class="title">Example 9. <code>columnIndex</code></div>
<div class="content">
<div class="paragraph">
<p>This will retrieve the value from the first column.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">example:DataMapping1 delim:columnIndex "0" .</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="data-hasProperty">hasProperty</h4>
<div class="paragraph">
<p>The <code>delim:hasProperty</code> property specifies which data property a <code>DataMapping</code> will create. This property is required for a <code>DataMapping</code> so that the <a href="#mapping-tool-guide">Mapping Tool</a> knows what property to create. It must point to a data property defined either within the source ontology of the mapping or one of the ontologies in the source ontology&#8217;s imports closure. This property can be associated with either a <code>DataMapping</code> or a <code><a href="#objectmapping">ObjectMapping</a></code>.</p>
</div>
<div class="exampleblock">
<div class="title">Example 10. <code>hasProperty</code> for <code>DataMapping</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="nowrap">example:DataMapping1 delim:hasProperty &lt;http://mobi.com/ontologies/uhtc/aDataProperty&gt; .</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="datatypespec">datatypeSpec</h4>
<div class="paragraph">
<p>The <code>delim:datatypeSpec</code> property specifies a manual override for the datatype of generated data property values resulting from a <code>DataMapping</code>. By default, the datatype will be determined from the range of the property if found with a fallback of string. This setting has precedence over the range of the property. This property is optional for a <code>DataMapping</code>. The value of this property must be the IRI of a standard XSD datatype.</p>
</div>
<div class="exampleblock">
<div class="title">Example 11. <code>datatypeSpec</code></div>
<div class="content">
<div class="paragraph">
<p>This will set the datatype of all values to xsd:double.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">example:DataMapping1 delim:datatypeSpec xsd:double .</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="languagespec">languageSpec</h4>
<div class="paragraph">
<p>The <code>delim:languageSpec</code> property specifies a language for all generated data property values resulting from a <code>DataMapping</code>. If this property is set, the mapper will manually change the datatype of the value to be <code>rdfs:langString</code>. Any datatype specified by the range of the property will be ignored. This property is optional for a <code>DataMapping</code>. The value of this property must be a valid language tag string (found <a href="https://en.wikipedia.org/wiki/List_of_ISO_639-1_codes">here</a> under the ISO 639-1 column).</p>
</div>
<div class="exampleblock">
<div class="title">Example 12. <code>languageSpec</code></div>
<div class="content">
<div class="paragraph">
<p>This will set the language of all values to be English.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">example:DataMapping1 delim:languageSpec "en" .</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="objectmapping">ObjectMapping</h3>
<div class="paragraph">
<p>The <code>delim:ObjectMapping</code> class represents a blueprint for creating an object property on a class instance. Since object properties in an ontology point to other classes or class expressions, an <code>ObjectMapping</code> specifies a <code>ClassMapping</code> that will be created for the same row and whose generated class instance will be used as the value of the generated object property. Properties associated with this class define how an object property will be created. These properties are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code><a href="#classmapping_2">classMapping</a></code></p>
</li>
<li>
<p><code><a href="#object-hasProperty">hasProperty</a></code></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="classmapping_2">classMapping</h4>
<div class="paragraph">
<p>The <code>delim:classMapping</code> property specifies which class instance generated from a <code>ClassMapping</code> will be used as the value of the generated object property. This property is required for an <code>ObjectMapping</code> so that the <a href="#mapping-tool-guide">Mapping Tool</a> knows which class should be the value of the object property. The generated value will be the class instance created by the specified <code>ClassMapping</code> for the row being mapped. The value must be a <code>ClassMapping</code> defined within the mapping.</p>
</div>
<div class="exampleblock">
<div class="title">Example 13. <code>classMapping</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="nowrap">example:ObjectMapping1 delim:classMapping delim:ClassMappingExample .</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="object-hasProperty">hasProperty</h4>
<div class="paragraph">
<p>The <code>delim:hasProperty</code> property specifies which object property an <code>ObjectMapping</code> will create. This property is required for an <code>ObjectMapping</code> so that the <a href="#mapping-tool-guide">Mapping Tool</a> knows what property to create. It must point to a object property defined either within the source ontology of the mapping or one of the ontologies in the source ontology&#8217;s imports closure. This property can be associated with either a <code>ObjectMapping</code> or a <code><a href="#datamapping">DataMapping</a></code>.</p>
</div>
<div class="exampleblock">
<div class="title">Example 14. <code>hasProperty</code> for <code>ObjectMapping</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="nowrap">example:ObjectMapping1 delim:hasProperty &lt;http://mobi.com/ontologies/uhtc/aObjectProperty&gt; .</pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="mobi_datasets">Appendix B: Mobi Datasets</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Mobi datasets are used to group and store RDF data into various graphs for enhanced query isolation, data segmentation, and management. The Mobi dataset structure is defined in a custom ontology found in the <code>com.mobi.dataset.api/src/main/resources/dataset.ttl</code> file in the source code. This design is loosely based on the <a href="https://www.w3.org/TR/rdf-sparql-query/#rdfDataset">W3C Specification for SPARQL Datasets</a> wherein a collection of graphs can be queried as default named graphs or named graphs. The primary class is <code>dataset:Dataset</code>, and the properties associated with this class provide information about all the named graphs within the dataset. These properties are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code><a href="#systemdefaultnamedgraph">systemDefaultNamedGraph</a></code></p>
</li>
<li>
<p><code><a href="#defaultnamedgraph">defaultNamedGraph</a></code></p>
</li>
<li>
<p><code><a href="#namedgraph">namedGraph</a></code></p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>All examples in this Appendix will be in TriG RDF serialization and use the following prefixes:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Prefix</th>
<th class="tableblock halign-left valign-top">Namespace</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>example</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">http://guide.org/</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>dataset</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">http://mobi.com/ontologies/dataset#</p></td>
</tr>
</tbody>
</table>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="systemdefaultnamedgraph">systemDefaultNamedGraph</h3>
<div class="paragraph">
<p>The <code>dataset:systemDefaultNamedGraph</code> property specifies the default named graph that Mobi will use when loading data that does not specify a graph (e.g. data from a Turtle file). For example, this approach is currently used for data created by the <a href="#mapping-tool-guide">Mapping Tool</a>. This named graph will be cleared, but not removed when a dataset is cleared.</p>
</div>
<div class="exampleblock">
<div class="title">Example 15. <code>systemDefaultNamedGraph</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="nowrap">GRAPH example:DatasetExample {
    example:DatasetExample a dataset:Dataset ;
        dataset:systemDefaultNamedGraph example:sdng .
}

GRAPH example:sdng {
    example:Subject a example:Object .
}</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="defaultnamedgraph">defaultNamedGraph</h3>
<div class="paragraph">
<p>The <code>dataset:defaultNamedGraph</code> property specifies a default named graph within the dataset. These graphs are not maintained by the system and can be used when data segmentation is required within a dataset. These graphs are removed when a dataset is cleared.</p>
</div>
<div class="exampleblock">
<div class="title">Example 16. <code>defaultNamedGraph</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="nowrap">GRAPH example:DatasetExample {
    example:DatasetExample a dataset:Dataset ;
        dataset:defaultNamedGraph example:dng .
}

GRAPH example:dng {
    example:Subject a example:Object .
}</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="namedgraph">namedGraph</h3>
<div class="paragraph">
<p>The <code>dataset:namedGraph</code> property specifies a named graph within the dataset. These graphs are not maintained by the system and can be used when data segmentation is required within a dataset. These graphs are removed when a dataset is cleared.</p>
</div>
<div class="exampleblock">
<div class="title">Example 17. <code>namedGraph</code></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="nowrap">GRAPH example:DatasetExample {
    example:DatasetExample a dataset:Dataset ;
        dataset:namedGraph example:ng .
}

GRAPH example:ng {
    example:Subject a example:Object .
}</pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="settings_framework">Appendix C: Settings Framework</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Settings Framework was designed to allow the tracking and editing of Settings within Mobi. The framework was designed to be easily extensible such that a new setting can be added to the platform with only some RDF and a few code changes.</p>
</div>
<div class="paragraph">
<p>The <a href="#preferences">Preferences Tab</a> is powered by the User Preference definitions stored within the system which can be tailored to populate different types of forms depending on the type of data to be stored.</p>
</div>
<div class="sect2">
<h3 id="setting_rdf_definition">Setting RDF Definition</h3>
<div class="paragraph">
<p>In order to introduce new Settings to Mobi, a developer must create an RDF representation of the Setting they want to add to the application. The Setting Framework uses <a href="https://www.w3.org/TR/shacl/">SHACL</a> to define settings. Setting RDF must consist of exactly one SHACL NodeShape and one SHACL PropertyShape in order to be recognized as a Setting by Mobi. Requirements for the structure of these SHACL shapes is outlined below.</p>
</div>
<div class="paragraph">
<p>The following prefixes will be used in the rest of this appendix:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Prefix</th>
<th class="tableblock halign-left valign-top">Namespace</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>owl:</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">http://www.w3.org/2002/07/owl#</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>rdfs</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">http://www.w3.org/2000/01/rdf-schema#</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sh:</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">http://www.w3.org/ns/shacl#</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>setting:</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">http://mobi.com/ontologies/setting#</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>wf:</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">https://mobi.solutions/ontologies/form#</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>xsd:</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">http://www.w3.org/2001/XMLSchema#</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>For an explanation of what each SHACL class and property represent, read the descriptions given <a href="https://www.w3.org/TR/shacl/">here</a>. The following are descriptions of Mobi specific properties.</p>
</div>
<div class="sect3">
<h4 id="settingpreference">setting:Preference</h4>
<div class="paragraph">
<p>The <code>setting:Preference</code> class acts as the parent class of all preferences within Mobi. Mobi preferences always have an <code>rdfs:subClassOf</code> <code>setting:Preference</code> and are also of type <code>sh:NodeShape</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="settingapplicationsetting">setting:ApplicationSetting</h4>
<div class="paragraph">
<p>The <code>setting:ApplicationSetting</code> class acts as the parent class of all application settings within Mobi. Mobi application settings always have an <code>rdfs:subClassOf</code> <code>setting:ApplicationSetting</code> and are also of type <code>sh:NodeShape</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
From here on, when referring to either <code>setting:Preference</code> or <code>setting:ApplicationSetting</code> the phrase setting subType may be used.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="settingpreferencegroup">setting:PreferenceGroup</h4>
<div class="paragraph">
<p>Every Mobi preference must have a <code>setting:inGroup</code> of a instance of <code>setting:PreferenceGroup</code>. These preference groups are meant to group together semantically related preferences.</p>
</div>
</div>
<div class="sect3">
<h4 id="settingapplicationsettinggroup">setting:ApplicationSettingGroup</h4>
<div class="paragraph">
<p>Every Mobi application setting must have a <code>setting:inGroup</code> of a instance of <code>setting:ApplicationSettingGroup</code>. These application setting groups are meant to group together semantically related application settings.</p>
</div>
</div>
<div class="sect3">
<h4 id="wfformfield">wf:FormField</h4>
<div class="paragraph">
<p>Instances of the <code>wf:FormField</code> class are used by Mobi settings to specify the form input that is used by the UI to select setting values.</p>
</div>
</div>
<div class="sect3">
<h4 id="settinghasdatavalue">setting:hasDataValue</h4>
<div class="paragraph">
<p>The <code>setting:hasDataValue</code> property is used by instances of setting subTypes to point to the current value of that setting. All Settings must point to a Property Shape that has an <code>sh:path</code> of <code>setting:hasDataValue</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="wfusesformfield">wf:usesFormField</h4>
<div class="paragraph">
<p>The <code>wf:usesFormField</code> property is used by the required <code>sh:PropertyShape</code> of a Mobi Setting to designate the type of form input that will be used by the frontend to accept setting values for that specific setting.</p>
</div>
</div>
<div class="sect3">
<h4 id="settingingroup">setting:inGroup</h4>
<div class="paragraph">
<p>The <code>setting:inGroup</code> property specifies either the <code>setting:PreferenceGroup</code> or <code>setting:ApplicationSettingGroup</code> that a Mobi Setting belongs too. It is used to semantically group related Settings in the UI.</p>
</div>
<div class="sect4">
<h5 id="required_shacl_nodeshape">Required SHACL NodeShape</h5>
<div class="ulist">
<ul>
<li>
<p>Must be of type <code>owl:Class</code> as well as type <code>sh:Nodeshape</code>.</p>
</li>
<li>
<p>Must have an <code>rdfs:subClassOf</code> of <code>setting:Preference</code> or <code>setting:ApplicationSetting</code>.</p>
</li>
<li>
<p>Must have an <code>sh:description</code> that will be shown above the Setting in the UI.</p>
</li>
<li>
<p>Must have a <code>sh:property</code> that points to the required SHACL PropertyShape for the setting.</p>
</li>
<li>
<p>Must have a <code>setting:inGroup</code> of an IRI in the system of type <code>setting:PreferenceGroup</code> or <code>setting:ApplicationSettingGroup</code>.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="required_shacl_propertyshape">Required SHACL PropertyShape</h5>
<div class="ulist">
<ul>
<li>
<p>Must be of type <code>sh:PropertyShape</code>.</p>
</li>
<li>
<p>Must have an <code>sh:path</code> of <code>setting:hasDataValue</code>.</p>
</li>
<li>
<p>A <code>sh:datatype</code> of one of the following values:</p>
<div class="ulist">
<ul>
<li>
<p><code>xsd:boolean</code></p>
</li>
<li>
<p><code>xsd:string</code></p>
</li>
<li>
<p><code>xsd:integer</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>Must have a <code>wf:usesFormField</code> that has one of the following values that will affect which type of form input is shown in the UI for this preference:</p>
<div class="ulist">
<ul>
<li>
<p><code>wf:ToggleInput</code></p>
</li>
<li>
<p><code>wf:TextInput</code></p>
</li>
<li>
<p><code>wf:CheckboxInput</code></p>
</li>
<li>
<p><code>wf:RadioInput</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>If using a <code>wf:CheckboxInput</code> or <code>wf:RadioInput</code>, must have a <code>sh:in</code> with a list of the valid values for the input.</p>
</li>
<li>
<p>Must have a <code>setting:inGroup</code> of a valid instance of the <code>setting:PreferenceGroup</code> or <code>setting:ApplicationSettingGroup</code> class.</p>
</li>
<li>
<p>May have optional <code>sh:minCount</code> and/or <code>sh:maxCount</code> fields denoting the min and max number of possible values for the preference which will be enforced in the UI.</p>
</li>
<li>
<p>May have optional <code>sh:pattern</code> which may have a regex that controls what values may be used and will be enforced by the UI.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Support for more datatypes and form fields coming soon!
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="required_preferencegroupapplicationsettinggroup">Required PreferenceGroup/ApplicationSettingGroup</h5>
<div class="ulist">
<ul>
<li>
<p>At least one instance of <code>setting:PreferenceGroup</code> or <code>setting:ApplicationSettingGroup</code> must exist which has an <code>rdfs:label</code>.</p>
<div class="ulist">
<ul>
<li>
<p>Preference/ApplicationSetting Groups already in the system can be reused.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Predefined Property Groups coming soon
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following diagram illustrates the relationship between the various preference related classes and properties:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/my-account/preference_diagram.png" alt="preference diagram">
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="example_rdf">Example RDF</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">@prefix owl: &lt;http://www.w3.org/2002/07/owl#&gt;.
@prefix xsd: &lt;http://www.w3.org/2001/XMLSchema#&gt;.
@prefix rdfs: &lt;http://www.w3.org/2000/01/rdf-schema#&gt;.
@prefix sh: &lt;http://www.w3.org/ns/shacl#&gt;.
@prefix setting: &lt;http://mobi.com/ontologies/setting#&gt;.
@prefix wf: &lt;https://mobi.solutions/ontologies/form#&gt;.
@prefix : &lt;http://mobi.com/ontologies/test#&gt;.
@base &lt;http://mobi.com/ontologies/test&gt;.

:MyBooleanPreference a owl:Class, sh:NodeShape;
    rdfs:subClassOf setting:Preference;
    sh:description "What value do you want for your Boolean Preference?" ;
    sh:property :MyBooleanPreferencePropertyShape;
    setting:inGroup :MyTestPreferenceGroup .

:MyBooleanPreferencePropertyShape a sh:PropertyShape;
    sh:path setting:hasDataValue;
    sh:datatype xsd:boolean;
    sh:minCount 1 ;
    sh:maxCount 1 ;
    wf:usesFormField wf:ToggleInput .

:MyTestPreferenceGroup a setting:PreferenceGroup ;
    rdfs:label "My Test Preference Group"@en .</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="adding_custom_settings">Adding Custom Settings</h3>
<div class="paragraph">
<p>In order to create new custom settings in Mobi, there are 3 steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create Setting RDF to model the new Setting</p>
</li>
<li>
<p>Generate Java classes from the Setting RDF using the Mobi <code>rdf-orm-plugin</code></p>
</li>
<li>
<p>Load the Setting RDF into the Mobi Repository</p>
</li>
</ol>
</div>
<div class="sect3">
<h4 id="generate_java_classes_from_setting_rdf">Generate Java Classes from Setting RDF</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create an RDF file with your custom setting definition in the <code>src/main/resources</code> directory of a Mobi bundle. This can be any valid RDF format, such a Turtle. A list of supported RDF formats can be found under <a href="#uploading_existing_ontologies">Uploading Existing Ontologies</a>.</p>
</li>
<li>
<p>Create a <code>pom.xml</code> based on the following example XML in the appropriate Mobi bundle. Replace <code>${mobi.version}</code> with the appropriate version of Mobi the bundle will be deployed to.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
    &lt;groupId&gt;org.example&lt;/groupId&gt;
    &lt;artifactId&gt;test&lt;/artifactId&gt;
    &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
    &lt;name&gt;${project.groupId}.${project.artifactId}&lt;/name&gt;
    &lt;packaging&gt;bundle&lt;/packaging&gt;
    &lt;parent&gt;
        &lt;artifactId&gt;mobi-parent&lt;/artifactId&gt;
        &lt;groupId&gt;com.mobi&lt;/groupId&gt;
        &lt;version&gt;${mobi.version}&lt;/version&gt;
        &lt;relativePath&gt;&lt;/relativePath&gt;
    &lt;/parent&gt;
    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.mobi&lt;/groupId&gt;
            &lt;artifactId&gt;rdf.orm&lt;/artifactId&gt;
            &lt;version&gt;${mobi.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.mobi&lt;/groupId&gt;
            &lt;artifactId&gt;setting.api&lt;/artifactId&gt;
            &lt;version&gt;${mobi.version}&lt;/version&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;
    &lt;repositories&gt;
        &lt;repository&gt;
            &lt;id&gt;inovex&lt;/id&gt;
            &lt;url&gt;http://nexus.inovexcorp.com/nexus/content/repositories/public-maven-prod-group/&lt;/url&gt;
        &lt;/repository&gt;
    &lt;/repositories&gt;
    &lt;pluginRepositories&gt;
        &lt;pluginRepository&gt;
            &lt;id&gt;inovex&lt;/id&gt;
            &lt;url&gt;http://nexus.inovexcorp.com/nexus/content/repositories/public-maven-prod-group/&lt;/url&gt;
        &lt;/pluginRepository&gt;
    &lt;/pluginRepositories&gt;
    &lt;build&gt;
        &lt;plugins&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.apache.felix&lt;/groupId&gt;
                &lt;artifactId&gt;maven-bundle-plugin&lt;/artifactId&gt;
                &lt;version&gt;3.5.1&lt;/version&gt;
                &lt;extensions&gt;true&lt;/extensions&gt;
                &lt;configuration&gt;
                    &lt;obrRepository&gt;NONE&lt;/obrRepository&gt;
                &lt;/configuration&gt;
            &lt;/plugin&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
                &lt;artifactId&gt;maven-checkstyle-plugin&lt;/artifactId&gt;
                &lt;configuration&gt;
                    &lt;skip&gt;true&lt;/skip&gt;
                &lt;/configuration&gt;
            &lt;/plugin&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;com.mobi.orm&lt;/groupId&gt;
                &lt;artifactId&gt;rdf-orm-maven-plugin&lt;/artifactId&gt;
                &lt;version&gt;${mobi.version}&lt;/version&gt;
                &lt;executions&gt;
                    &lt;execution&gt;
                        &lt;id&gt;generateOrmSources&lt;/id&gt;
                        &lt;phase&gt;generate-sources&lt;/phase&gt;
                        &lt;goals&gt;
                            &lt;goal&gt;generate-orm&lt;/goal&gt;
                        &lt;/goals&gt;
                        &lt;inherited&gt;false&lt;/inherited&gt;
                        &lt;configuration&gt;
                            &lt;generates&gt;
                                &lt;ontology&gt;
                                    &lt;ontologyFile&gt;${project.basedir}/src/main/resources/myontologyfile.ttl&lt;/ontologyFile&gt;
                                    &lt;outputPackage&gt;org.example.test.ontologies&lt;/outputPackage&gt;
                                    &lt;ontologyName&gt;MyOntologyName&lt;/ontologyName&gt;
                                &lt;/ontology&gt;
                            &lt;/generates&gt;
                            &lt;references&gt;
                                &lt;ontology&gt;
                                    &lt;ontologyFile&gt;jar:http://nexus.inovexcorp.com/nexus/repository/public-maven-prod-group/com/mobi/rdf.orm.ontologies/${mobi.version}/rdf.orm.ontologies-${mobi.version}.jar!shacl.ttl&lt;/ontologyFile&gt;
                                    &lt;outputPackage&gt;com.mobi.ontologies.shacl&lt;/outputPackage&gt;
                                &lt;/ontology&gt;
                                &lt;ontology&gt;
                                    &lt;ontologyFile&gt;jar:http://nexus.inovexcorp.com/nexus/repository/public-maven-prod-group/com/mobi/setting.api/${mobi.version}/setting.api-${mobi.version}.jar!setting.ttl&lt;/ontologyFile&gt;
                                    &lt;outputPackage&gt;com.mobi.setting.api.ontologies&lt;/outputPackage&gt;
                                    &lt;ontologyName&gt;Setting&lt;/ontologyName&gt;
                                &lt;/ontology&gt;
                            &lt;/references&gt;
                            &lt;outputLocation&gt;${project.basedir}/src/main/java&lt;/outputLocation&gt;
                        &lt;/configuration&gt;
                    &lt;/execution&gt;
                &lt;/executions&gt;
            &lt;/plugin&gt;
        &lt;/plugins&gt;
    &lt;/build&gt;
&lt;/project&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Be sure to replace references to "My ontology" and "My bundle" with your actual ontology and bundle. Also make sure to have the <code>&lt;packaging&gt;bundle&lt;/packaging&gt;</code> and the <code>com.mobi.rdf.orm</code> dependency. On your next Mobi build, interfaces, implementation classes, and factory classes will be created based on your ontology.</p>
</div>
</div>
<div class="sect3">
<h4 id="load_setting_rdf_into_mobi_repo">Load Setting RDF into Mobi Repo</h4>
<div class="paragraph">
<p>In order for Setting RDF to be recognized by Mobi, it must be loaded into the <code>http://mobi.com/setting-management</code> graph. This can be done one of two ways. The first option is to upload the RDF via Mobi Command Line. To do this, create a trig file with a graph of <code>http://mobi.com/setting-management</code> that has the same contents as your setting RDF. The following is an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">@prefix owl: &lt;http://www.w3.org/2002/07/owl#&gt;.
@prefix xsd: &lt;http://www.w3.org/2001/XMLSchema#&gt;.
@prefix rdfs: &lt;http://www.w3.org/2000/01/rdf-schema#&gt;.
@prefix sh: &lt;http://www.w3.org/ns/shacl#&gt;.
@prefix setting: &lt;http://mobi.com/ontologies/preference#&gt;.
@prefix wf: &lt;https://mobi.solutions/ontologies/form#&gt;.
@prefix : &lt;http://mobi.com/ontologies/test#&gt;.
@base &lt;http://mobi.com/ontologies/test&gt;.

&lt;http://mobi.com/setting-management&gt; {
:MyBooleanPreference a owl:Class, sh:NodeShape;
    rdfs:subClassOf setting:Preference;
    sh:description "What value do you want for your Boolean Preference?";
    sh:property :MyBooleanPreferencePropertyShape;
    setting:inGroup :MyTestPreferenceGroup.

    :MyBooleanPreferencePropertyShape a sh:PropertyShape;
        sh:path setting:hasDataValue;
        sh:datatype xsd:boolean;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        wf:usesFormField wf:ToggleInput .

    :MyTestPreferenceGroup a setting:PreferenceGroup ;
        rdfs:label "My Test Preference Group"@en .
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Next, start up Mobi, and run the following command in the Mobi Shell: <code>mobi:import -r system /path/to/my/trigfile.trig</code>. At this point, the preference should now be present and editable in the Mobi UI.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This will only work if you have already built using the <code>rdf-orm-plugin</code> described earlier in the documentation to generate Java classes for the setting RDF.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The second option to load your Setting RDF into the Mobi Repository is to add code to the activate method of a service in your corresponding Mobi bundle. The following methods can be used to help add code into the Mobi Repository.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>Models.createModel()</code> method to turn an <code>InputStream</code> into a <code>Model</code>.</p>
</li>
<li>
<p><code>getRepository().getConnection().add(&#8230;&#8203;)</code> from the <code>CatalogConfigProvider</code> class used to add a model to the repo. Be sure to pass the <code>http://mobi.com/setting-management</code> iri as the context parameter value.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">settingUtilsService.updateRepoWithSettingDefinitions(MY_ONTOLOGY_INPUT_STREAM, MY_ONTOLOGY_NAME);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="using_a_stored_setting">Using a Stored Setting</h3>
<div class="paragraph">
<p>In order to use the value of a stored setting, the setting service will be used in conjunction with one or more of the ORM generated classes (classes generated in the <a href="#generate_java_classes_from_setting_rdf">Generate Java Classes from Setting RDF</a> section). The following is an example of how to extract the value of a boolean preference that exists in the system:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">boolean myBooleanPreferenceValue = false;
Optional&lt;Preference&gt; myPreferenceOptional = preferenceService.getSetting(valueFactory.createIRI(MyPreference.TYPE), user;
if (myPreferenceOptional.isPresent()) {
    MyPreference myPreference = (MyPreference) myPreferenceOptional.get();
    myBooleanPreferenceValue = myPreference.getHasDataValue().orElseThrow(() -&gt; new IllegalStateException("Some message")).booleanValue();
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="mobi_security_policies">Appendix D: Mobi Security Policies</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Mobi utilizes <a href="https://www.oasis-open.org/committees/tc_home.php?wg_abbrev=xacml">XACML</a> standards to support Attribute-Based Access Control (ABAC). See the ABAC section for more detail.</p>
</div>
<div class="sect2">
<h3 id="attribute_based_access_control">Attribute-Based Access Control</h3>
<div class="paragraph">
<p>Attribute-Based Access Control is an alternative to the traditional Role-Based Access Control (RBAC) - an authorization model where users are permitted to access resources based on the roles assigned to the user. As the name implies, ABAC evaluates a combination of Attributes to determine the user&#8217;s access permissions.</p>
</div>
<div class="paragraph">
<p>The base Attributes in Mobi&#8217;s ABAC model are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Subject</strong>: The subject is the user requesting access to a resource in order to perform an action. These are typically
gathered from a token or an existing database/HR system.</p>
</li>
<li>
<p><strong>Resource</strong>: The resource is an object or asset (e.g., files, records, metadata, application, etc.) that the user wants
to access. Resource attributes in Mobi are typically the IRIs of object.</p>
</li>
<li>
<p><strong>Action</strong>: The action is what the user wants to do with the resource. The typical actions in Mobi are "Create", "Read",
"Update", "Delete", and "Modify".</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="attribute_based_access_control_workflow">Attribute-Based Access Control Workflow</h4>
<div class="paragraph">
<p>As an example, a policy in Mobi may state "Only users who have the admin role may view Ontology Record 1." When a request is made, Mobi&#8217;s XACML Engine (discussed below) will evaluate the request and grant view permission if the request has the following attributes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Subject is the IRI of the User making the request</p>
</li>
<li>
<p>Subject <code>hasUserRole</code> of <code>admin</code></p>
</li>
<li>
<p>Action is the "Read" action</p>
</li>
<li>
<p>Resource is the IRI of Ontology Record 1</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="xacml">XACML</h3>
<div class="paragraph">
<p>eXtensible Access Control Markup Language (XACML) is an XML based language that enables security policy definitions and request evaluation to determine if a user has access to given resource. It is composed of the following components:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Policy Decision Point (PDP)</strong>: Evaluates requests against authorization policies before issuing access decisions</p>
</li>
<li>
<p><strong>Policy Enforcement Point (PEP)</strong>: Intercepts user&#8217;s access request to a resource, makes a decision request to the PDP to obtain the access decision (i.e. access to the resource is approved or rejected), and acts on the received decision</p>
</li>
<li>
<p><strong>Policy Information Point (PIP)</strong>: The system entity that acts as a source of attribute values (i.e. a resource, subject, environment)</p>
</li>
<li>
<p><strong>Policy Retrieval Point (PRP)</strong>: Point where the XACML access authorization policies are stored, typically a database or the filesystem.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="images/xacml/XACML_Workflow.png" alt="XACML Evaluation Engine">
</div>
</div>
<div class="paragraph">
<p>The XACML specification supports both Attribute-Based Access Control and Role-Based Access Control. Mobi&#8217;s implementation of XACML only supports ABAC. Request make to the PEP are evaluated in the PDP and return whether or not a user can access a Resource based on the ABAC schema defined above.</p>
</div>
<div class="paragraph">
<p>Mobi&#8217;s XACML definitions are structured using combinations of the following top level elements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Policy</strong>: contains a set of Rule elements and a specified procedure for combining the results of their evaluation. It is the basic unit of the policy used by the PDP, and so it is intended to form the basis of an authorization decision</p>
</li>
<li>
<p><strong>Rule</strong>: contains a Boolean expression that can be evaluated in isolation, but that is not intended to be accessed in isolation by a PDP. A Rule can be comprised of the following sub-elements:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Target</strong>: defines the set of requests to which the rule is intended to apply in the form of a logical expression on attributes in the request.</p>
</li>
<li>
<p><strong>Effect</strong>: indicates the rule-writer&#8217;s intended consequence of a "True" evaluation for the rule.  Two values are allowed: "Permit" and "Deny".</p>
</li>
<li>
<p><strong>Condition</strong>: represents a Boolean expression that refines the applicability of the rule beyond the predicates implied
by its target.  Therefore, it may be absent.</p>
</li>
<li>
<p><strong>Obligation Expressions</strong>: An operation specified in a rule, policy or policy set that should be performed by the PEP in conjunction with the enforcement of an authorization decision.  These are currently unused in Mobi policies.</p>
</li>
<li>
<p><strong>Advice Expressions</strong>: A supplementary piece of information in a policy or policy set which is provided to the PEP with the decision of the PDP. These are currently unused in Mobi policies.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="xacml_example">XACML Example</h4>
<div class="paragraph">
<p>Here is an example policy that is used in Mobi to control what users may create an Ontology Record:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17" PolicyId="http://mobi.com/policies/ontology-creation" RuleCombiningAlgId="urn:oasis:names:tc:xacml:3.0:rule-combining-algorithm:deny-unless-permit" Version="1.0"&gt;
    &lt;Description&gt;Who can create an OntologyRecord in the Local Catalog?&lt;/Description&gt;
    &lt;Target&gt;
        &lt;AnyOf&gt;
            &lt;AllOf&gt;
                &lt;Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal"&gt;
                    &lt;AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string"&gt;http://mobi.com/catalog-local&lt;/AttributeValue&gt;
                    &lt;AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/&gt;
                &lt;/Match&gt;
                &lt;Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal"&gt;
                    &lt;AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string"&gt;http://mobi.com/ontologies/policy#Create&lt;/AttributeValue&gt;
                    &lt;AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/&gt;
                &lt;/Match&gt;
                &lt;Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal"&gt;
                    &lt;AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string"&gt;http://mobi.com/ontologies/ontology-editor#OntologyRecord&lt;/AttributeValue&gt;
                    &lt;AttributeDesignator AttributeId="http://www.w3.org/1999/02/22-rdf-syntax-ns#type" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/&gt;
                &lt;/Match&gt;
            &lt;/AllOf&gt;
        &lt;/AnyOf&gt;
    &lt;/Target&gt;
    &lt;Rule RuleId="urn:createOntologyRecord" Effect="Permit"&gt;
        &lt;Target&gt;
            &lt;AnyOf&gt;
                &lt;AllOf&gt;
                    &lt;Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal"&gt;
                        &lt;AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string"&gt;http://mobi.com/roles/user&lt;/AttributeValue&gt;
                        &lt;AttributeDesignator AttributeId="http://mobi.com/ontologies/user/management#hasUserRole" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/&gt;
                    &lt;/Match&gt;
                &lt;/AllOf&gt;
            &lt;/AnyOf&gt;
        &lt;/Target&gt;
    &lt;/Rule&gt;
    &lt;Rule RuleId="urn:createOntologyRecordAdmin" Effect="Permit"&gt;
        &lt;Target&gt;
            &lt;AnyOf&gt;
                &lt;AllOf&gt;
                    &lt;Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal"&gt;
                        &lt;AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string"&gt;admin&lt;/AttributeValue&gt;
                        &lt;AttributeDesignator Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" AttributeId="http://mobi.com/ontologies/user/management#username" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/&gt;
                    &lt;/Match&gt;
                &lt;/AllOf&gt;
            &lt;/AnyOf&gt;
        &lt;/Target&gt;
    &lt;/Rule&gt;
&lt;/Policy&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>Target</code> of this policy matches requests where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The Resource is the Mobi Catalog <code>http://mobi.com/catalog-local</code></p>
</li>
<li>
<p>The Action is Create <code>http://mobi.com/ontologies/policy#Create</code></p>
</li>
<li>
<p>The Action Attribute for the RDF Type is an Ontology Record <code>http://mobi.com/ontologies/ontology-editor#OntologyRecord</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Any request that have these 3 criteria are evaluated against the rule section. If either rule resolves to be True, then the request&#8217;s response is a <code>Permit</code> as defined in the <code>Effect</code> field in each <code>Rule</code> element.</p>
</div>
<div class="paragraph">
<p>The first <code>Rule</code> states that the user making the request must be a user in Mobi:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>hasUserRole</code> (<code>http://mobi.com/ontologies/user/management#hasUserRole</code>) of <code>user</code> (<code>http://mobi.com/roles/user</code>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The second <code>Rule</code> states that the user must be the <code>admin</code> user:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>username</code> (<code>http://mobi.com/ontologies/user/management#username</code>) must equal <code>admin</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These match operator is defined by the <code>MatchId</code> field of the <code>Match</code> element. Most Mobi policies use the basic <code>equals</code> operator <code>urn:oasis:names:tc:xacml:1.0:function:string-equal</code>. See the <a href="http://docs.oasis-open.org/xacml/3.0/xacml-3.0-core-spec-os-en.html#_Toc325047234">XACML Functions</a> section of the specification to see other possible operations.</p>
</div>
</div>
<div class="sect3">
<h4 id="xacml_workflow">XACML Workflow</h4>
<div class="paragraph">
<p>Let&#8217;s modify our previous example to only allow the <code>admin</code> user to create Ontology Records by deleting the <code>Rule</code> with the <code>hasUserRole</code> section. Our new modified policy now looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17" PolicyId="http://mobi.com/policies/ontology-creation" RuleCombiningAlgId="urn:oasis:names:tc:xacml:3.0:rule-combining-algorithm:deny-unless-permit" Version="1.0"&gt;
    &lt;Description&gt;Who can create an OntologyRecord in the Local Catalog?&lt;/Description&gt;
    &lt;Target&gt;
        &lt;AnyOf&gt;
            &lt;AllOf&gt;
                &lt;Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal"&gt;
                    &lt;AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string"&gt;http://mobi.com/catalog-local&lt;/AttributeValue&gt;
                    &lt;AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/&gt;
                &lt;/Match&gt;
                &lt;Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal"&gt;
                    &lt;AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string"&gt;http://mobi.com/ontologies/policy#Create&lt;/AttributeValue&gt;
                    &lt;AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/&gt;
                &lt;/Match&gt;
                &lt;Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal"&gt;
                    &lt;AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string"&gt;http://mobi.com/ontologies/ontology-editor#OntologyRecord&lt;/AttributeValue&gt;
                    &lt;AttributeDesignator AttributeId="http://www.w3.org/1999/02/22-rdf-syntax-ns#type" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/&gt;
                &lt;/Match&gt;
            &lt;/AllOf&gt;
        &lt;/AnyOf&gt;
    &lt;/Target&gt;
    &lt;Rule RuleId="urn:createOntologyRecordAdmin" Effect="Permit"&gt;
        &lt;Target&gt;
            &lt;AnyOf&gt;
                &lt;AllOf&gt;
                    &lt;Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal"&gt;
                        &lt;AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string"&gt;admin&lt;/AttributeValue&gt;
                        &lt;AttributeDesignator Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" AttributeId="http://mobi.com/ontologies/user/management#username" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/&gt;
                    &lt;/Match&gt;
                &lt;/AllOf&gt;
            &lt;/AnyOf&gt;
        &lt;/Target&gt;
    &lt;/Rule&gt;
&lt;/Policy&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following request is for a user that is not the admin user and is attempting to create an Ontology Record:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Resource is <code>http://mobi.com/catalog-local</code></p>
</li>
<li>
<p>Action is <code>http://mobi.com/ontologies/policy#Create</code></p>
</li>
<li>
<p>Action Attribute for Type is <code>http://mobi.com/ontologies/ontology-editor#OntologyRecord</code></p>
</li>
<li>
<p>Subject is user with username <code>batman</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Let&#8217;s now go through the typical XACML workflow from request to evaluation to response.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>A REST request is made to a Mobi endpoint where the request is intercepted by the Policy Enforcement Point</p>
<div class="ulist">
<ul>
<li>
<p>Relevant user information is extracted from the request</p>
</li>
<li>
<p>Action and Resource information is extracted from the targeted endpoint</p>
<div class="ulist">
<ul>
<li>
<p>These are defined by Java Annotations on the endpoints in the Mobi source code.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>A XACML request is generated from the data extracted from the REST request.</p>
</li>
<li>
<p>The XACML request is then passed along to the Policy Decision Point</p>
</li>
<li>
<p>The Policy Decision Point reaches out to the Policy Information Point and Policy Retrieval Point to retrieve additional attributes and relevant policies to evaluate against.</p>
</li>
<li>
<p>The Policy Decision Point evaluates the request against any relevant policies. In this case it is our policy listed above.</p>
</li>
<li>
<p>The Policy Decision Point sees that the User making the request is <code>batman</code> and not <code>admin</code>. Using a deny unless permit model the Policy Decision Point returns <code>Deny</code> as the response to the request.</p>
</li>
<li>
<p>The Policy Enforcement Point propagates this <code>Deny</code> out, never actually entering the code for the REST request, and returns a 401 Unauthorized error to the system making the REST request.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="mobi_policies">Mobi Policies</h3>
<div class="sect3">
<h4 id="mobi_system_policies">Mobi System Policies</h4>
<div class="paragraph">
<p>Mobi stores default system policies in the <code>${karaf.etc}/policies/systemPolicies</code> directory. Custom XACML system policies should be added to this directory. On initial startup these policies are loaded into the Repository and Virtual Filesystem.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
Any edits made to these policies after initial system startup will not be applied unless a <code>mobi:reload-system-policy</code> command is run from the Karaf terminal.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="reload_system_policy_command">Reload System Policy Command</h4>
<div class="paragraph">
<p>A helper utility exists in the Karaf terminal for reloading manually edited system policies. The command take a path to a system policy.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
System policy file names must be a URI Encoding of the Policy IRI.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">karaf@mobi()&gt; mobi:reload-system-policy --help
DESCRIPTION
        mobi:reload-system-policy

	Reloads a system policy in Mobi

SYNTAX
        mobi:reload-system-policy [PolicyFilePath]

ARGUMENTS
        PolicyFilePath
                The path to the system policy file</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command will replace existing system policies with the policy file provided as an argument</p>
</div>
</div>
<div class="sect3">
<h4 id="mobi_policy_templates">Mobi Policy Templates</h4>
<div class="paragraph">
<p>Mobi makes use of policy templates for generating default policies for different Record Types. There are two main record
policy template types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Record Policy</strong>: A policy for managing the READ/DELETE/MODIFY permissions of a Record</p>
</li>
<li>
<p><strong>Policy Policy</strong>: A policy for managing the Record Policy and adjusting who can edit the permissions of a Record Policy</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Unlike System Policies, these policies do not need to be reloaded after editing. They are picked up by the Mobi Record Services when a user creates a new Record.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following policy templates can be found in the <code>${karaf.etc}/policies/policyTemplates</code> directory with their system defaults:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>datasetRecordPolicy.xml</strong>: Default policy template for Dataset Records</p>
<div class="ulist">
<ul>
<li>
<p>Read Permissions: Any user with the User role</p>
</li>
<li>
<p>Delete Permissions: The user who created the Record</p>
</li>
<li>
<p>Update/Manage Permissions: The user who created the Record</p>
</li>
<li>
<p>Modify Permissions: Any user with the User role</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>mappingRecordPolicy.xml</strong>: Default policy template for Mapping Records</p>
<div class="ulist">
<ul>
<li>
<p>Read Permissions: Any user with the User role</p>
</li>
<li>
<p>Delete Permissions: Any user with the User role</p>
</li>
<li>
<p>Update/Manage Permissions: The user who created the Record</p>
</li>
<li>
<p>Modify Permissions: Any user with the User role</p>
</li>
<li>
<p>Modify Master Branch: Any user with the User role</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>recordPolicy.xml</strong>: Default policy template for Versioned RDF Records (Ontology Records and Shapes Graph Records)</p>
<div class="ulist">
<ul>
<li>
<p>Read Permissions: Any user with the User role</p>
</li>
<li>
<p>Delete Permissions: The user who created the Record</p>
</li>
<li>
<p>Update/Manage Permissions: The user who created the Record</p>
</li>
<li>
<p>Modify Permissions: Any user with the User role</p>
</li>
<li>
<p>Modify Master Branch: The user who created the Record</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>policyPolicy.xml</strong>: The default policy template for managing access control for a Record. This policy is tied to each type of Record and is associated with the Update Permission for the Record. If the User has the Update Permission, then they can also change who else can Read/Delete/Manage/Modify a given Record.</p>
<div class="ulist">
<ul>
<li>
<p>Read Permissions: The user who created the Record</p>
</li>
<li>
<p>Update/Manage Permissions: The user who created the Record</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>These default policy templates for Records can be manually adjusted in the filesystem to reflect any organization specific need for access control for Records. The templates use a few tokens to do string replacement on when processed by the Mobi Record Services on creation. These tokens are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>%RECORDIRI%</code>: The IRI of the created Record</p>
</li>
<li>
<p><code>%USERIRI%</code>: The IRI of the User creating the Record</p>
</li>
<li>
<p><code>%POLICYIRI%</code>: The IRI of the Record Policy - this is used by the policyPolicy.xml for managing who can adjust
permissions for a given Record</p>
</li>
<li>
<p><code>%MASTER%</code>: The IRI of the Master branch if it is a Versioned RDF Record</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The most common patterns utilized within the rules of the policy templates are described below. Pay close attention to the values on the <code>AttributeDesignator</code> element as they will change for each case.</p>
</div>
<div class="sect4">
<h5 id="allow_everyone">Allow "Everyone"</h5>
<div class="paragraph">
<p>To allow any authenticated user within Mobi to execute an action, the <code>Target</code> of the <code>Rule</code> should include a <code>Match</code> block that looks like this.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal"&gt;
    &lt;AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string"&gt;http://mobi.com/roles/user&lt;/AttributeValue&gt;
    &lt;AttributeDesignator AttributeId="http://mobi.com/ontologies/user/management#hasUserRole" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/&gt;
&lt;/Match&gt;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="allow_creator_or_specific_user">Allow "Creator" or Specific User</h5>
<div class="paragraph">
<p>To allow only the creator of the Record to execute an action, the <code>Target</code> of the <code>Rule</code> should include a <code>Match</code> block that looks like this.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal"&gt;
    &lt;AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string"&gt;%USERIRI%&lt;/AttributeValue&gt;
    &lt;AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/&gt;
&lt;/Match&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you want to hardcode a specific User, change the <code>%USERIRI%</code> to that user&#8217;s IRI.</p>
</div>
</div>
<div class="sect4">
<h5 id="allow_specific_group">Allow Specific Group</h5>
<div class="paragraph">
<p>To allow only users in a specific group to execute an action, the <code>Target</code> of the <code>Rule</code> should include a <code>Match</code> block that looks like this with substituting <code>%GROUPIRI%</code> for the IRI of the Group in question (<code>%GROUPIRI%</code> is not a recognizing substitution within the platform).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal"&gt;
    &lt;AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string"&gt;%GROUPIRI%&lt;/AttributeValue&gt;
    &lt;AttributeDesignator Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" AttributeId="http://mobi.com/policy/prop-path(%5E%3Chttp%3A%2F%2Fxmlns.com%2Ffoaf%2F0.1%2Fmember%3E)" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/&gt;
&lt;/Match&gt;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="allow_admin_users">Allow admin Users</h5>
<div class="paragraph">
<p>To allow only all admin users to execute an action, the <code>Target</code> of the <code>Rule</code> should include a <code>Match</code> block that looks like this.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal"&gt;
    &lt;AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string"&gt;admin&lt;/AttributeValue&gt;
    &lt;AttributeDesignator Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" AttributeId="http://mobi.com/ontologies/user/management#username" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/&gt;
&lt;/Match&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="workflows">Appendix E: Workflows</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Mobi supports the automation of actions and activities within the platform using an extensible framework called Workflows. Workflows are defined using a simple RDF schema and managed via the Mobi Catalog via Versioned RDF Records. The framework is built to support different underlying software, or Workflow Engines, to run the actual Workflows while keeping the RDF definition agnostic of the chosen engine.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
A UI module for creating and maintaining Workflows is coming soon!
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A Workflow is made up of a central set of configurations, an optional trigger to initiate the Workflow without manual interaction, and a set of actions to be executed. This appendix will describe the RDF structure of a Workflow and the "out-of-the-box" supported functionality as well as how to extend the framework with additional types of triggers and actions.</p>
</div>
<div class="sect2">
<h3 id="workflow_rdf_definition">Workflow RDF Definition</h3>
<div class="paragraph">
<p>All workflows managed by the system must follow the same general structure that is validated via SHACL constraints. All extended types of actions and triggers comes with their own SHACL definitions to ensure compliance as well.</p>
</div>
<div class="paragraph">
<p>The following prefixes will be used in the rest of this appendix. All RDF examples will be provided in either <a href="https://www.w3.org/TR/turtle/">Turtle</a> or JSON-LD format:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Prefix</strong></th>
<th class="tableblock halign-left valign-top"><strong>Namespace</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>owl:</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">http://www.w3.org/2002/07/owl#</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>prov:</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">http://www.w3.org/ns/prov#</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>rdfs</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">http://www.w3.org/2000/01/rdf-schema#</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>shacl:</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">http://www.w3.org/ns/shacl#</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>xsd:</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">http://www.w3.org/2001/XMLSchema#</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>um:</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">http://mobi.com/ontologies/user/management#</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>vfs:</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">http://mobi.com/ontologies/documents#</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>w:</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">http://mobi.solutions/ontologies/workflows#</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>A complete example of a compliant Workflow RDF definition is shown below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">@prefix owl: &lt;http://www.w3.org/2002/07/owl#&gt;.
@prefix xsd: &lt;http://www.w3.org/2001/XMLSchema#&gt;.
@prefix rdfs: &lt;http://www.w3.org/2000/01/rdf-schema#&gt;.
@prefix sh: &lt;http://www.w3.org/ns/shacl#&gt;.
@prefix w: &lt;http://mobi.solutions/ontologies/workflows#&gt;.
@prefix : &lt;http://mobi.solutions/test#&gt;.
@base &lt;http://mobi.solutions/test&gt;.

:WorkflowA a w:Workflow ;
    w:hasAction :TestActionA .

:TestActionA a w:TestAction, w:Action ;
    w:testMessage "This is a test." .</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="wworkflow">w:Workflow</h4>
<div class="paragraph">
<p>Every Workflow RDF definition must have exactly one <code>w:Workflow</code> object with a unique subject IRI. This object is used to hold top level metadata about the Workflow&#8217;s execution as well as links to the optional <code>w:Trigger</code> used to initiate executions and the list of <code>w:Action</code> definitions to conduct when the Workflow executes. It can have a max of 1 value for <code>w:hasTrigger</code> and must have a minimum of one value for <code>w:hasAction</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="wtrigger">w:Trigger</h4>
<div class="paragraph">
<p>Instances of <code>w:Trigger</code> specify configuration details for how an execution of the Workflow can be initiated by the system outside of manual user interaction. If a workflow execution should be initiated based off an event occurring elsewhere in the platform, there is a specific subtype of <code>w:Trigger</code> called <code>w:EventTrigger</code> which provides additional functionality in the Java OSGi services side. This is one of the areas of extensibility of the framework where custom subtypes of <code>w:Trigger</code> can be loaded into the platform and made available to the core framework.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
It is recommended that each <code>w:Trigger</code> instance be defined with all super types as well.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The "out of the box" supported <code>w:Trigger</code> types are described below.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
More Trigger types coming soon!
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Trigger Type</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
<th class="tableblock halign-left valign-top"><strong>Fields</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>w:ScheduledTrigger</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enables triggering of a Workflow on a scheduled basis based on a configured cron expression.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>w:cron</code> - A string containing a valid <a href="http://www.quartz-scheduler.org/documentation/quartz-2.3.0/tutorials/crontrigger.html">Quartz compatible expression</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>w:CommitToBranchTrigger</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enables triggering of a Workflow when a Commit is made on a configured Branch on a configured Versioned RDF Record. Subtype of <code>w:EventTrigger</code>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>w:watchesRecord</code> - The IRI of the Versioned RDF Record to watch for events from<br>
<code>w:watchesBranch</code> - The IRI of the Branch to watch for new Commits to be added</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="waction">w:Action</h4>
<div class="paragraph">
<p>Instances of <code>w:Action</code> describe what a Workflow should do when it is executed. These are sequentially executed in tern. Logs are stored from the execution of each individual action in addition to the overall workflow logs. This is one of the areas of extensibility of the framework where custom subtypes of <code>w:Action</code> can be loaded into the platform and made available to the core framework. The exact implementation of each of these Actions is dependant on the chosen underlying Workflow Engine.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
It is recommended that each <code>w:Action</code> instance be defined with all super types as well.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The "out of the box" supported <code>w:Action</code> types are described below.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
More Action types are coming soon!
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Action Type</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
<th class="tableblock halign-left valign-top"><strong>Fields</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>w:TestAction</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Outputs a static log message to the workflow execution logs. Meant for testing Workflow executions.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>w:testMessage</code> - A static string to be output in the workflow execution logs.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="workflows_system_configuration">Workflows System Configuration</h3>
<div class="paragraph">
<p>The Workflows framework supports different implementations of the underlying engine used for actual execution of the defined Workflows. The chosen engine does not affect the Workflow RDF definition, but does affect how the execution logs will be structured. Workflows can thus be defined and managed by the platform, but execution of the Workflow requires a Workflow Engine to be installed and configured. By default, Mobi supports <a href="https://dagu.readthedocs.io/en/latest/index.html">Dagu</a> as the Workflow Engine of choice.</p>
</div>
<div class="sect3">
<h4 id="dagu_workflow_engine">Dagu Workflow Engine</h4>
<div class="paragraph">
<p><a href="https://dagu.readthedocs.io/en/latest/index.html">Dagu</a> is a free and open source workflow engine that defines executions as Directed Acrylic Graphs (or DAGs) and supports interaction with Mobi via REST. To utilize Dagu in executing Workflows, you will need to install the software, and then configure Mobi&#8217;s connection to Dagu.</p>
</div>
<div class="paragraph">
<p>Install Dagu according to their <a href="https://dagu.readthedocs.io/en/latest/installation.html">installation instructions</a>. Mobi supports interaction with Dagu both locally (i.e., on the same server) or remotely. The following table describes the recommended Dagu installation method based on the OS of the system Mobi is installed on and the desired Dagu location.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The default port of 8080 for Dagu is fine when installing Dagu locally on the Mobi server.
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Mobi OS</strong></th>
<th class="tableblock halign-left valign-top"><strong>Dagu Location</strong></th>
<th class="tableblock halign-left valign-top"><strong>Supported Dagu Installation</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unix</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Local</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Brew, Bash script, Binary, Docker</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unix</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Remote</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Brew, Bash script, Binary, Docker</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Windows</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Local</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Docker</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Windows</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Remote</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Brew, Bash script, Binary, Docker</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>To configure Mobi&#8217;s connection to Dagu, create a file called <code>com.mobi.workflows.impl.dagu.DaguWorkflowEngine.cfg</code> with the following properties and put it in the <code>$MOBI_HOME/etc/</code> directory.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Property Name</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
<th class="tableblock halign-left valign-top"><strong>Required</strong></th>
<th class="tableblock halign-left valign-top"><strong>Default</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>daguHost</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The full URL of the Dagu server (ex: <a href="http://localhost:8080" class="bare">http://localhost:8080</a>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#x2713;</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>logDir</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The full path to the directory where the Dagu generated Workflow execution logs should be stored. This is recommended to be somewhere in the <code>$MOBI_HOME/data</code> directory.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#x2713;</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>local</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether the Dagu installation is local to the Mobi server or remote.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#x2713;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pollInterval</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of seconds between calls to Dagu to check on a Workflow&#8217;s execution status.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pollTimeout</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of seconds before Mobi will treat the workflow execution as failed if it has not completed.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">300</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>An example file would look like this.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">daguHost=http://localhost:8080
logDir=${karaf.home}/data/virtualFiles/dagu
local=true
pollInterval=10
pollTimeout=300</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="creating_and_using_workflows">Creating and Using Workflows</h3>
<div class="paragraph">
<p>Complete management and execution of Workflows can be accomplished through Mobi&#8217;s extensive REST API suite. Common flows when maintaining Workflows are described below. The described REST requests can be performed via a REST API client like <a href="https://www.postman.com/">Postman</a> or using the provided <a href="#Swagger Documentation">Accessing Swagger REST API Documentation</a> from the installation. If you are using a separate software like Postman, be sure to authenticate either using Basic Auth or the dedicated POST <code>$MOBI_HOST/mobirest/session</code> endpoint, passing the <code>username</code> and <code>password</code> as query parameters.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
A UI module for creating and maintaining Workflows is coming soon!
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="create_a_workflow">Create a Workflow</h4>
<div class="paragraph">
<p>To create a workflow, follow the steps below.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a file containing the RDF definition of your Workflow. An example file is shown below.</p>
<div class="listingblock">
<div class="title">workflow.ttl</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">@prefix owl: &lt;http://www.w3.org/2002/07/owl#&gt;.
@prefix xsd: &lt;http://www.w3.org/2001/XMLSchema#&gt;.
@prefix rdfs: &lt;http://www.w3.org/2000/01/rdf-schema#&gt;.
@prefix sh: &lt;http://www.w3.org/ns/shacl#&gt;.
@prefix w: &lt;http://mobi.solutions/ontologies/workflows#&gt;.
@prefix : &lt;http://mobi.solutions/test#&gt;.
@base &lt;http://mobi.solutions/test&gt;.

:WorkflowA a w:Workflow ;
    w:hasAction :TestActionA .

:TestActionA a w:TestAction, w:Action ;
    w:testMessage "This is a test." .</code></pre>
</div>
</div>
</li>
<li>
<p>Send a POST REST request to <code>$MOBI_HOST/mobirest/workflows</code> with the following form data contents. The response from this endpoint will include the IRI of the newly created Workflow Record, which will the unique identifier for your Workflow needed for any further requests.</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Parameter</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>file</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The required binary RDF file containing your workflow definition</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>title</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The required title for the Workflow Record you are creating</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>description</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An optional description for the Workflow Record you are creating</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>markdown</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An optional markdown overview of the Workflow Record you are creating</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>keywords</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An optional list of keywords to associate with the Workflow Record you are creating</p></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Once created, the Workflow Record will appear in the Catalog UI in the application so record metadata and permissions can be adjusted from there.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="activatedeactivate_a_workflow">Activate/Deactivate a Workflow</h4>
<div class="paragraph">
<p>When a Workflow Record is first created, it is inactive to start, meaning that even manually initiating an execution will not succeed. This is done to ensure that all required edits to the Workflow can be performed without fear of it executing before the changes are complete. To activate a Workflow and enable it to run, you will need to update the Workflow Record metadata following the steps below.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Send a GET REST request to <code>$MOBI_HOST/mobirest/catalogs/http%3A%2F%2Fmobi.com%2Fcatalog-local/records/ENCODED_RECORD_IRI</code> where <code>ENCODED_RECORD_IRI</code> is replaced by the URL encoded version of the IRI of the target Workflow Record. This will return the full JSON-LD of your Workflow&#8217;s metadata, which should look like below.</p>
<div class="listingblock">
<div class="title">Example Workflow Record JSON-LD</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">[
    {
        "@id": "https://mobi.com/records#19ee2b35-aa29-4a86-a0b1-892633b1d0bc",
        "@type": [
            "http://www.w3.org/2002/07/owl#Thing",
            "http://mobi.solutions/ontologies/workflows#WorkflowRecord",
            "http://mobi.com/ontologies/catalog#VersionedRecord",
            "http://mobi.com/ontologies/catalog#VersionedRDFRecord",
            "http://mobi.com/ontologies/catalog#Record"
        ],
        "http://mobi.com/ontologies/catalog#branch": [
            {
                "@id": "https://mobi.com/branches#19b8cc92-00a9-4594-b759-8565d2f0537a"
            }
        ],
        "http://mobi.com/ontologies/catalog#catalog": [
            {
                "@id": "http://mobi.com/catalog-local"
            }
        ],
        "http://mobi.com/ontologies/catalog#masterBranch": [
            {
                "@id": "https://mobi.com/branches#19b8cc92-00a9-4594-b759-8565d2f0537a"
            }
        ],
        "http://mobi.solutions/ontologies/workflows#active": [
            {
                "@type": "http://www.w3.org/2001/XMLSchema#boolean",
                "@value": "true"
            }
        ],
        "http://mobi.solutions/ontologies/workflows#latestActivity": [
            {
                "@id": "http://mobi.com/activities/2001f136-5a37-47f2-95b0-ec3f083d634a"
            }
        ],
        "http://mobi.solutions/ontologies/workflows#workflowIRI": [
            {
                "@id": "http://test.com/workflows-example#WorkflowB"
            }
        ],
        "http://purl.org/dc/terms/issued": [
            {
                "@type": "http://www.w3.org/2001/XMLSchema#dateTime",
                "@value": "2023-09-15T08:55:30.954519-04:00"
            }
        ],
        "http://purl.org/dc/terms/modified": [
            {
                "@type": "http://www.w3.org/2001/XMLSchema#dateTime",
                "@value": "2023-09-15T08:57:28.801002-04:00"
            }
        ],
        "http://purl.org/dc/terms/publisher": [
            {
                "@id": "http://mobi.com/users/d033e22ae348aeb5660fc2140aec35850c4da997"
            }
        ],
        "http://purl.org/dc/terms/title": [
            {
                "@value": "Workflow B"
            }
        ]
    }
]</code></pre>
</div>
</div>
</li>
<li>
<p>Copy the returned JSON-LD. Send a PUT REST request to <code>$MOBI_HOST/mobirest/catalogs/http%3A%2F%2Fmobi.com%2Fcatalog-local/records/ENCODED_RECORD_IRI</code> where <code>ENCODED_RECORD_IRI</code> is replaced by the URL encoded version of the IRI of the target Workflow Record. The paste the Record JSON-LD into the body of the request and change the <code>@value</code> value of <code>http://mobi.solutions/ontologies/workflows#active</code> to the desired activation state (<code>true</code> for active and <code>false</code> for inactive).</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="update_a_workflow_definition">Update a Workflow Definition</h4>
<div class="paragraph">
<p>Workflows are managed by Workflow Records, which are types of Versioned RDF Records. This means that all changes to the definition of the Workflow must go through the standard graph-versioning flow in order for the changes to be recognized by the system. Thus, to update the definition of a Workflow, you will need to follow steps similar to those below.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Make a GET REST request to <code>$MOBI_HOST/mobirest/catalogs/http%3A%2F%2Fmobi.com%2Fcatalog-local/records/ENCODED_RECORD_IRI/branches/master</code> where <code>ENCODED_RECORD_IRI</code> is replaced by the URL encoded version of the IRI of the target Workflow Record. This will return the full JSON-LD of the MASTER Branch of the Workflow Record. We will need both the IRI of the Branch and the IRI of the head Commit for the subsequent requests. An example response is shown below.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
    "@id": "https://mobi.com/branches#19b8cc92-00a9-4594-b759-8565d2f0537a",
    "@type": [
        "http://www.w3.org/2002/07/owl#Thing",
        "http://mobi.com/ontologies/catalog#Branch"
    ],
    "http://mobi.com/ontologies/catalog#head": [
        {
            "@id": "https://mobi.com/commits#d78190647e4e9b2e8555c036349fbf8928417c50"
        }
    ],
    "http://purl.org/dc/terms/description": [
        {
            "@value": "The master branch."
        }
    ],
    "http://purl.org/dc/terms/issued": [
        {
            "@type": "http://www.w3.org/2001/XMLSchema#dateTime",
            "@value": "2023-09-15T08:55:30.955812-04:00"
        }
    ],
    "http://purl.org/dc/terms/modified": [
        {
            "@type": "http://www.w3.org/2001/XMLSchema#dateTime",
            "@value": "2023-09-15T08:55:31.003336-04:00"
        }
    ],
    "http://purl.org/dc/terms/publisher": [
        {
            "@id": "http://mobi.com/users/d033e22ae348aeb5660fc2140aec35850c4da997"
        }
    ],
    "http://purl.org/dc/terms/title": [
        {
            "@value": "MASTER"
        }
    ]
}</code></pre>
</div>
</div>
</li>
<li>
<p>Make a GET REST request to <code>$MOBI_HOST/mobirest/commits/ENCODED_COMMIT_IRI/resource</code> where <code>ENCODED_COMMIT_IRI</code> is replaced by the URL encoded version of the IRI of the head Commit retrieved from the last call. This will return the compiled RDF of the latest/current version of the Workflow definition. An example response is below.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">[
    {
        "@id": "http://test.com/workflows-example#WorkflowB",
        "@type": [
            "http://mobi.solutions/ontologies/workflows#Workflow"
        ],
        "http://mobi.solutions/ontologies/workflows#hasAction": [
            {
                "@id": "http://test.com/workflows-example#WorkflowBAction"
            }
        ]
    },
    {
        "@id": "http://test.com/workflows-example#WorkflowBAction",
        "@type": [
            "http://mobi.solutions/ontologies/workflows#Action",
            "http://mobi.solutions/ontologies/workflows#TestAction"
        ],
        "http://mobi.solutions/ontologies/workflows#testMessage": [
            {
                "@value": "This is a test from Workflow B"
            }
        ]
    }
]</code></pre>
</div>
</div>
</li>
<li>
<p>Make a PUT REST request to <code>$MOBI_HOST/mobirest/catalogs/http%3A%2F%2Fmobi.com%2Fcatalog-local/records/ENCODED_RECORD_IRI/in-progress-commit</code> where <code>ENCODED_RECORD_IRI</code> is replaced by the URL encoded version of the IRI of the target Workflow Record with the following form data contents. If successful, the endpoint will return an empty 200 response.</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Parameter</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>additions</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The new desired Workflow definition in JSON-LD RDF format</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>deletions</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The contents of the previous compiled resource call with the full JSON-LD of the current Workflow RDF definition</p></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Make a POST REST request to <code>$MOBI_HOST/mobirest/catalogs/http%3A%2F%2Fmobi.com%2Fcatalog-local/records/ENCODED_RECORD_IRI/branches/ENCODED_BRANCH_IRI/commits</code> where <code>ENCODED_RECORD_IRI</code> is replaced by the URL encoded version of the IRI of the target Workflow Record and <code>ENCODED_BRANCH_IRI</code> is replaced the URL encoded version of the IRI of the MASTER Branch of the Workflow Record. This will commit the changes you uploaded in the previous call to the system and make the uploaded RDF the latest/current Workflow definition, updating the associated trigger service if appropriate. The response from this endpoint will be the IRI of the newly created Commit.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="manually_initiate_a_workflow_execution">Manually Initiate a Workflow Execution</h4>
<div class="paragraph">
<p>Workflows can be configured with automated triggers that will initiate executions, but a Workflow can always be triggered manually following the steps below.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Send a POST REST request to <code>$MOBI_HOST/mobirest/workflows/ENCODED_RECORD_IRI/executions</code> where <code>ENCODED_RECORD_IRI</code> is replaced by the URL encoded version of the IRI of the target Workflow Record. This will initiate an execution of the target Workflow in an asynchronous process and provide the IRI of the generated <code>w:WorkflowExecutionActivity</code> in the response to be used in subsequent calls to fetch the status and logs.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="retrieving_workflow_provenance_and_logs">Retrieving Workflow Provenance and Logs</h4>
<div class="paragraph">
<p>As Workflows are executed, provenance is tracked for each execution along with logs with more details about the complete workflow execution and each individual action. The RDF structure of this data can be summarized in the image below, with the key classes described underneath.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/workflows/provenance_rdf.png" alt="provenance rdf">
</div>
<div class="title">Figure 128. RDF Structure of Workflow Provenance</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>w:WorkflowExecutionActivity</code> - Every execution of a Workflow is tracked with an instance of this class. They will have properties for the start/end time, the IRI of the User who initiated the execution, a boolean indicating the success of the execution, a relationship to the <code>vfs:BinaryFile</code> for the log file generated by the execution, and a relationship back to the Workflow Record in question.</p>
</li>
<li>
<p><code>vfs:BinaryFile</code> - Used to represent a file stored on a file system that the platform has access to.</p>
</li>
<li>
<p><code>w:ActionExecution</code> - Represents an individual execution of a single <code>w:Action</code> within a Workflow. They will have properties for the start/end time, a boolean indicating the success of the action, and a relationship to the <code>vfs:BinaryFile</code> for the log file generated by the individual <code>w:Action</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This can all be retrieved via various REST endpoints provided by the platform. Common scenarios are described below with the appropriate REST endpoints.</p>
</div>
<div class="sect4">
<h5 id="retrieve_workflow_activity">Retrieve Workflow Activity</h5>
<div class="paragraph">
<p>Send a GET REST request to <code>$MOBI_HOST/mobirest/workflows/ENCODED_RECORD_IRI/executions/ACTIVITY_ID</code> where <code>ENCODED_RECORD_IRI</code> is replaced by the URL encoded version of the IRI of the target Workflow Record and <code>ACTIVITY_ID</code> is either replaced by <code>latest</code>, to get the latest execution details, or the URL encoded version of the IRI of a specific <code>w:WorkflowExecutionActivity</code>. The response will be the full JSON-LD of the <code>w:WorkflowExecutionActivity</code> requested. An example response is shown below.</p>
</div>
<div class="listingblock">
<div class="title">Example Workflow Activity JSON-LD</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
    "@id": "http://mobi.com/activities/2001f136-5a37-47f2-95b0-ec3f083d634a",
    "@type": [
        "http://www.w3.org/ns/prov#Activity",
        "http://mobi.solutions/ontologies/workflows#WorkflowExecutionActivity",
        "http://www.w3.org/2002/07/owl#Thing"
    ],
    "http://mobi.solutions/ontologies/workflows#logs": [
        {
            "@id": "https://mobi.solutions/workflows/log-files/agent_98d3918e09cf5791eee7ad55c6ac67cadbab484e.20230915.14:42:49.158.cbfd8c5c.log"
        }
    ],
    "http://mobi.solutions/ontologies/workflows#succeeded": [
        {
            "@type": "http://www.w3.org/2001/XMLSchema#boolean",
            "@value": "true"
        }
    ],
    "http://www.w3.org/ns/prov#endedAtTime": [
        {
            "@type": "http://www.w3.org/2001/XMLSchema#dateTime",
            "@value": "2023-09-15T14:42:59.176399-04:00"
        }
    ],
    "http://www.w3.org/ns/prov#startedAtTime": [
        {
            "@type": "http://www.w3.org/2001/XMLSchema#dateTime",
            "@value": "2023-09-15T14:42:48.974369-04:00"
        }
    ],
    "http://www.w3.org/ns/prov#used": [
        {
            "@id": "https://mobi.com/records#19ee2b35-aa29-4a86-a0b1-892633b1d0bc"
        }
    ],
    "http://www.w3.org/ns/prov#wasAssociatedWith": [
        {
            "@id": "http://mobi.com/users/d033e22ae348aeb5660fc2140aec35850c4da997"
        }
    ]
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="retrieve_all_workflow_activities">Retrieve All Workflow Activities</h5>
<div class="paragraph">
<p>Send a GET REST request to <code>$MOBI_HOST/mobirest/provenance</code> and provide the URL encoded version of the IRI of the target Workflow Record as the value of the <code>entity</code> query parameters. The response will be a JSON object containing a key called <code>activities</code>, which will include a sorted array of all the provenance activities about the target Workflow Record, including all <code>w:WorkflowExecutionActivity</code> and the initial creation activity. An example response is shown below.</p>
</div>
<div class="listingblock">
<div class="title">Example Full Workflow Activities</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
    "activities": [
        {
            "@id": "http://mobi.com/activities/2001f136-5a37-47f2-95b0-ec3f083d634a",
            "@type": [
                "http://www.w3.org/ns/prov#Activity",
                "http://mobi.solutions/ontologies/workflows#WorkflowExecutionActivity",
                "http://www.w3.org/2002/07/owl#Thing"
            ],
            "http://mobi.solutions/ontologies/workflows#logs": [
                {
                    "@id": "https://mobi.solutions/workflows/log-files/agent_98d3918e09cf5791eee7ad55c6ac67cadbab484e.20230915.14:42:49.158.cbfd8c5c.log"
                }
            ],
            "http://mobi.solutions/ontologies/workflows#succeeded": [
                {
                    "@type": "http://www.w3.org/2001/XMLSchema#boolean",
                    "@value": "true"
                }
            ],
            "http://www.w3.org/ns/prov#endedAtTime": [
                {
                    "@type": "http://www.w3.org/2001/XMLSchema#dateTime",
                    "@value": "2023-09-15T14:42:59.176399-04:00"
                }
            ],
            "http://www.w3.org/ns/prov#startedAtTime": [
                {
                    "@type": "http://www.w3.org/2001/XMLSchema#dateTime",
                    "@value": "2023-09-15T14:42:48.974369-04:00"
                }
            ],
            "http://www.w3.org/ns/prov#used": [
                {
                    "@id": "https://mobi.com/records#19ee2b35-aa29-4a86-a0b1-892633b1d0bc"
                }
            ],
            "http://www.w3.org/ns/prov#wasAssociatedWith": [
                {
                    "@id": "http://mobi.com/users/d033e22ae348aeb5660fc2140aec35850c4da997"
                }
            ]
        },
        {
            "@id": "http://mobi.com/activities/86c8db82-066d-4531-8526-2f6c39556567",
            "@type": [
                "http://www.w3.org/ns/prov#Activity",
                "http://mobi.solutions/ontologies/workflows#WorkflowExecutionActivity",
                "http://www.w3.org/2002/07/owl#Thing"
            ],
            "http://mobi.solutions/ontologies/workflows#logs": [
                {
                    "@id": "https://mobi.solutions/workflows/log-files/agent_98d3918e09cf5791eee7ad55c6ac67cadbab484e.20230915.13:19:53.994.67ebcf55.log"
                }
            ],
            "http://mobi.solutions/ontologies/workflows#succeeded": [
                {
                    "@type": "http://www.w3.org/2001/XMLSchema#boolean",
                    "@value": "true"
                }
            ],
            "http://www.w3.org/ns/prov#endedAtTime": [
                {
                    "@type": "http://www.w3.org/2001/XMLSchema#dateTime",
                    "@value": "2023-09-15T09:20:04.09355-04:00"
                }
            ],
            "http://www.w3.org/ns/prov#startedAtTime": [
                {
                    "@type": "http://www.w3.org/2001/XMLSchema#dateTime",
                    "@value": "2023-09-15T09:19:53.86763-04:00"
                }
            ],
            "http://www.w3.org/ns/prov#used": [
                {
                    "@id": "https://mobi.com/records#19ee2b35-aa29-4a86-a0b1-892633b1d0bc"
                }
            ],
            "http://www.w3.org/ns/prov#wasAssociatedWith": [
                {
                    "@id": "http://mobi.com/users/d033e22ae348aeb5660fc2140aec35850c4da997"
                }
            ]
        },
        {
            "@id": "http://mobi.com/activities/f2df2cde-7eec-4fb7-aa22-4e4ec6cabfd8",
            "@type": [
                "http://www.w3.org/ns/prov#Activity",
                "http://mobi.com/ontologies/prov#CreateActivity",
                "http://www.w3.org/2002/07/owl#Thing"
            ],
            "http://www.w3.org/ns/prov#atLocation": [
                {
                    "@value": "9832af45-7488-3b7c-928e-0618de48a3e3"
                }
            ],
            "http://www.w3.org/ns/prov#endedAtTime": [
                {
                    "@type": "http://www.w3.org/2001/XMLSchema#dateTime",
                    "@value": "2023-09-15T08:55:31.854546-04:00"
                }
            ],
            "http://www.w3.org/ns/prov#generated": [
                {
                    "@id": "https://mobi.com/records#19ee2b35-aa29-4a86-a0b1-892633b1d0bc"
                }
            ],
            "http://www.w3.org/ns/prov#startedAtTime": [
                {
                    "@type": "http://www.w3.org/2001/XMLSchema#dateTime",
                    "@value": "2023-09-15T08:55:30.942226-04:00"
                }
            ],
            "http://www.w3.org/ns/prov#wasAssociatedWith": [
                {
                    "@id": "http://mobi.com/users/d033e22ae348aeb5660fc2140aec35850c4da997"
                }
            ]
        }
    ],
    "entities": [
        {
            "@id": "https://mobi.com/records#19ee2b35-aa29-4a86-a0b1-892633b1d0bc",
            "@type": [
                "http://www.w3.org/2002/07/owl#Thing",
                "http://www.w3.org/ns/prov#Entity",
                "http://mobi.solutions/ontologies/workflows#WorkflowRecord",
                "http://mobi.com/ontologies/catalog#VersionedRecord",
                "http://mobi.com/ontologies/catalog#VersionedRDFRecord",
                "http://mobi.com/ontologies/catalog#Record"
            ],
            "http://mobi.com/ontologies/catalog#branch": [
                {
                    "@id": "https://mobi.com/branches#19b8cc92-00a9-4594-b759-8565d2f0537a"
                }
            ],
            "http://mobi.com/ontologies/catalog#catalog": [
                {
                    "@id": "http://mobi.com/catalog-local"
                }
            ],
            "http://mobi.com/ontologies/catalog#masterBranch": [
                {
                    "@id": "https://mobi.com/branches#19b8cc92-00a9-4594-b759-8565d2f0537a"
                }
            ],
            "http://mobi.solutions/ontologies/workflows#active": [
                {
                    "@type": "http://www.w3.org/2001/XMLSchema#boolean",
                    "@value": "true"
                }
            ],
            "http://mobi.solutions/ontologies/workflows#latestActivity": [
                {
                    "@id": "http://mobi.com/activities/2001f136-5a37-47f2-95b0-ec3f083d634a"
                }
            ],
            "http://mobi.solutions/ontologies/workflows#workflowIRI": [
                {
                    "@id": "http://test.com/workflows-example#WorkflowB"
                }
            ],
            "http://purl.org/dc/terms/issued": [
                {
                    "@type": "http://www.w3.org/2001/XMLSchema#dateTime",
                    "@value": "2023-09-15T08:55:30.954519-04:00"
                }
            ],
            "http://purl.org/dc/terms/modified": [
                {
                    "@type": "http://www.w3.org/2001/XMLSchema#dateTime",
                    "@value": "2023-09-15T08:57:28.801002-04:00"
                }
            ],
            "http://purl.org/dc/terms/publisher": [
                {
                    "@id": "http://mobi.com/users/d033e22ae348aeb5660fc2140aec35850c4da997"
                }
            ],
            "http://purl.org/dc/terms/title": [
                {
                    "@value": "Workflow B"
                }
            ],
            "http://www.w3.org/ns/prov#atLocation": [
                {
                    "@value": "system"
                }
            ],
            "http://www.w3.org/ns/prov#generatedAtTime": [
                {
                    "@type": "http://www.w3.org/2001/XMLSchema#dateTime",
                    "@value": "2023-09-15T08:55:31.853903-04:00"
                }
            ]
        }
    ]
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="retrieve_specific_workflow_activity_logs">Retrieve Specific Workflow Activity Logs</h5>
<div class="paragraph">
<p>Send a GET REST request to <code>$MOBI_HOST/mobirest/workflows/ENCODED_RECORD_IRI/executions/ENCODED_ACTIVITY_IRI/logs</code> where <code>ENCODED_RECORD_IRI</code> is replaced by the URL encoded version of the IRI of the target Workflow Record and <code>ENCODED_ACTIVITY_IRI</code> is replaced by the URL encoded version of the IRI of a specific <code>w:WorkflowExecutionActivity</code>. The response will be the plain text contents of the logs file generated by the overall Workflow execution in question. An example response is shown below.</p>
</div>
<div class="listingblock">
<div class="title">Example Workflow Execution Logs</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">2023/09/15 14:42:49 server is running at "/tmp/@dagu-98d3918e09cf5791eee7ad55c6ac67cadbab484e-4c93e3159bb697634261e271087fbeb1.sock"
2023/09/15 14:42:49 start running: http://test.com/workflows-example#WorkflowBAction
2023/09/15 14:42:49 http://test.com/workflows-example#WorkflowBAction finished
2023/09/15 14:42:49 schedule finished.
2023/09/15 14:42:49
Summary -&gt;
+--------------------------------------+------------------------------------------+---------------------+---------------------+----------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------+
| REQUESTID                            | NAME                                     | STARTED AT          | FINISHED AT         |   STATUS | PARAMS                                                                                                                                                                                                 | ERROR |
+--------------------------------------+------------------------------------------+---------------------+---------------------+----------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------+
| cbfd8c5c-56e3-4861-aefc-f3b833336322 | 98d3918e09cf5791eee7ad55c6ac67cadbab484e | 2023-09-15 14:42:49 | 2023-09-15 14:42:49 | finished | "https://localhost:8443" "eyJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJodHRwOlwvXC9tb2JpLmNvbVwvIiwic3ViIjoiYWRtaW4iLCJleHAiOjE2OTQ4ODk3NjksInNjb3BlIjoic2VsZiBcLyoifQ.aEpjpZZMW5mucXQSQ35fU7_aVxj5_yj-hU_fH7mbFZQ" |       |
+--------------------------------------+------------------------------------------+---------------------+---------------------+----------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------+
Details -&gt;
+---+---------------------------------------------------+---------------------+---------------------+----------+-------------------------------------+-------+
| # | STEP                                              | STARTED AT          | FINISHED AT         | STATUS   | COMMAND                             | ERROR |
+---+---------------------------------------------------+---------------------+---------------------+----------+-------------------------------------+-------+
| 1 | http://test.com/workflows-example#WorkflowBAction | 2023-09-15 14:42:49 | 2023-09-15 14:42:49 | finished | echo This is a test from Workflow B |       |
+---+---------------------------------------------------+---------------------+---------------------+----------+-------------------------------------+-------+</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="extending_workflows">Extending Workflows</h3>
<div class="paragraph">
<p>The Workflows feature is designed to be extensible, in that customers and third parties can develop their own types of triggers and actions specific to their enterprise needs. This can be accomplished with only some RDF and a few code changes, but does require a coding background.</p>
</div>
<div class="sect3">
<h4 id="triggeraction_rdf_definition">Trigger/Action RDF Definition</h4>
<div class="paragraph">
<p>In order to introduce a new <code>w:Trigger</code> or <code>w:Action</code> to Mobi, a developer must create an RDF representation of the Trigger/Action they want to add. The Workflows framework uses <a href="https://www.w3.org/TR/shacl/">SHACL</a> to define constraints on the attributes of the new Triggers/Actions and to describe how these attributes should be set in the UI.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
A UI module for creating and maintaining Workflows is coming soon!
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A full example of a <code>w:Trigger</code> and <code>w:Action</code> definition is shown below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">@prefix owl: &lt;http://www.w3.org/2002/07/owl#&gt;.
@prefix xsd: &lt;http://www.w3.org/2001/XMLSchema#&gt;.
@prefix rdfs: &lt;http://www.w3.org/2000/01/rdf-schema#&gt;.
@prefix sh: &lt;http://www.w3.org/ns/shacl#&gt;.
@prefix w: &lt;http://mobi.solutions/ontologies/workflows#&gt;.
@prefix wf: &lt;https://mobi.solutions/ontologies/form#&gt;.
@prefix : &lt;http://mobi.solutions/example/extension#&gt;.
@base &lt;http://mobi.solutions/example/extension&gt;.

:NewTrigger a owl:Class, sh:NodeShape, rdfs:Class ;
    rdfs:subClassOf w:Trigger ;
    rdfs:label "New Trigger"@en ;
    rdfs:comment "A specification for a new type of Trigger."@en ;
    sh:property :newTriggerPropertyShape .

:newTriggerPropertyShape a sh:PropertyShape ;
    wf:usesFormField wf:TextInput ;
    sh:path :newTriggerAttribute ;
    sh:datatype xsd:string ;
    sh:minCount 1 ;
    sh:maxCount 1 .

:newTriggerAttribute a owl:DatatypeProperty, owl:FunctionalProperty ;
    rdfs:label "new trigger attribute"@en ;
    rdfs:comment "An attribute for a new trigger type."@en ;
    rdfs:domain :NewTrigger ;
    rdfs:range xsd:string .

:NewAction a owl:Class, sh:NodeShape, rdfs:Class ;
    rdfs:subClassOf w:Action ;
    rdfs:label "New Action"@en ;
    rdfs:comment "A new extended action."@en ;
    sh:property :newActionPropertyShape.

:newActionPropertyShape a sh:PropertyShape ;
    wf:usesFormField wf:TextInput ;
    sh:path :newActionAttribute ;
    sh:datatype xsd:string ;
    sh:minCount 1 ;
    sh:maxCount 1 .

:newActionAttribute a owl:DatatypeProperty, owl:FunctionalProperty ;
    rdfs:label "new action attribute"@en ;
    rdfs:comment "An attribute for the new action."@en ;
    rdfs:domain :NewAction ;
    rdfs:range xsd:string .</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Every new <code>w:Trigger</code> or <code>w:Action</code> definition must also be defined as a <code>sh:NodeShape</code> and a <code>rdfs:Class</code></p>
</li>
<li>
<p>Every new <code>w:Trigger</code> or <code>w:Action</code> must have a <code>rdfs:subClassOf</code> predicate with the appropriate parent type</p>
</li>
<li>
<p>Any configurable properties desired for the new <code>w:Trigger</code> or <code>w:Action</code> must be defined as new <code>owl:DatatypeProperty</code> or <code>owl:ObjectProperty</code> instances</p>
</li>
<li>
<p>Every new <code>w:Trigger</code> or <code>w:Action</code> must have associated SHACL Property Shapes defined that describe any desired constraints on the values of the configurable properties</p>
<div class="ulist">
<ul>
<li>
<p>Must have a <code>sh:path</code> of one of the configurable properties of the new <code>w:Trigger</code> or <code>w:Action</code></p>
</li>
<li>
<p>Must have a <code>wf:usesFormField</code> predicate with one of the following values: <code>wf:TextInput</code>, <code>wf:ToggleInput</code>, <code>wf:CheckboxInput</code>, or <code>wf:RadioInput</code></p>
</li>
<li>
<p>Can have any of the available <a href="https://www.w3.org/TR/shacl/#core-components">SHACL Constraint predicates</a> to describe what is a valid value for the property</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="adding_custom_triggersactions">Adding Custom Triggers/Actions</h4>
<div class="paragraph">
<p>In order to load a new Trigger or Action into Mobi, there are four steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create RDF to model the new Trigger/Action inside of a new OSGi bundle.</p>
</li>
<li>
<p>Generate Java classes from the Trigger/Action RDF using the Mobi <code>rdf-orm-plugin</code>.</p>
</li>
<li>
<p>For new Triggers, develop <code>TriggerService</code> and <code>TriggerHandler</code> implementations. For new Actions, develop an <code>ActionHandler</code> implementation.</p>
</li>
<li>
<p>Deploy your OSGi bundle to the platform.</p>
</li>
</ol>
</div>
<div class="sect4">
<h5 id="create_workflow_extension_bundle_with_rdf">Create Workflow Extension Bundle with RDF</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Make sure your development environment matches the requirements in the <a href="#developer_guide">Developer Guide</a>. Create a Maven project somewhere on your system.</p>
</li>
<li>
<p>Include RDF file containing your new Trigger/Action definition in the <code>src/main/resources</code> directory of your project.</p>
</li>
<li>
<p>Adapt the <code>pom.xml</code> of your Maven project to look like the contents below. Each change is called out with explanations.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;

    &lt;!-- Replace this with your desired group ID, artifact ID, and version numbers --&gt;
    &lt;groupId&gt;my.plugin&lt;/groupId&gt;
    &lt;artifactId&gt;root&lt;/artifactId&gt;
    &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
    &lt;name&gt;my.plugin&lt;/name&gt;

    &lt;!-- Select the Maven bundle plug-in, maven-bundle-plugin, to perform packaging for this project. This setting on its own, however, has no effect until you explicitly add the bundle plug-in to your POM. --&gt;
    &lt;packaging&gt;bundle&lt;/packaging&gt;
    &lt;!-- Sets the full bundle name--&gt;
    &lt;name&gt;${project.groupId}.${project.artifactId}&lt;/name&gt;

    &lt;!-- These properties are utilized to set defaults and centralize dependency versions --&gt;
    &lt;properties&gt;
        &lt;!-- Declares UTF-8 as the default encoding --&gt;
        &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;
        &lt;!-- Sets a timestamp format for the builds (this will be important for your bundle versions) --&gt;
        &lt;maven.build.timestamp.format&gt;yyyyMMddHHmm&lt;/maven.build.timestamp.format&gt;
        &lt;!-- Set the default versions for the plugin you will be using to generate bundles and important dependencies --&gt;
        &lt;maven-bundle-plugin.version&gt;5.1.4&lt;/maven-bundle-plugin.version&gt;

        &lt;osgi-service-jaxrs.version&gt;1.0.0&lt;/osgi-service-jaxrs.version&gt;
        &lt;osgi-service-cm.version&gt;1.6.1&lt;/osgi-service-cm.version&gt;
        &lt;osgi-service-component&gt;1.5.0&lt;/osgi-service-component&gt;
        &lt;osgi-component-annotations.version&gt;1.5.0&lt;/osgi-component-annotations.version&gt;
        &lt;osgi-metatype-annotations.version&gt;1.4.1&lt;/osgi-metatype-annotations.version&gt;
        &lt;osgi-versioning.version&gt;1.1.2&lt;/osgi-versioning.version&gt;
        &lt;osgi.version&gt;8.0.0&lt;/osgi.version&gt;
        &lt;rdf4j.version&gt;4.2.3&lt;/rdf4j.version&gt;

        &lt;!-- Replace this with the version of Mobi you are deploying into. NOTE: Workflows are only supported from version 2.4 onwards --&gt;
        &lt;mobi.version&gt;2.4.0&lt;/mobi.version&gt;
    &lt;/properties&gt;

    &lt;!-- Establishes the dependencies for several libraries you will need to compile our code and complete the project --&gt;
    &lt;dependencies&gt;
        &lt;!-- These dependencies are needed for compiling the OSGi services --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.mobi&lt;/groupId&gt;
            &lt;artifactId&gt;rdf.orm&lt;/artifactId&gt;
            &lt;version&gt;${mobi.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.mobi&lt;/groupId&gt;
            &lt;artifactId&gt;workflows.api&lt;/artifactId&gt;
            &lt;version&gt;${mobi.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;!-- Include  --&gt;
        &lt;!-- OSGi and other dependencies we'll need when defining the services --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.osgi&lt;/groupId&gt;
            &lt;artifactId&gt;osgi.core&lt;/artifactId&gt;
            &lt;version&gt;${osgi.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.osgi&lt;/groupId&gt;
            &lt;artifactId&gt;org.osgi.service.cm&lt;/artifactId&gt;
            &lt;version&gt;${osgi-service-cm.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.osgi&lt;/groupId&gt;
            &lt;artifactId&gt;org.osgi.service.component&lt;/artifactId&gt;
            &lt;version&gt;${osgi-service-component}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.osgi&lt;/groupId&gt;
            &lt;artifactId&gt;osgi.annotation&lt;/artifactId&gt;
            &lt;version&gt;${osgi.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.osgi&lt;/groupId&gt;
            &lt;artifactId&gt;org.osgi.service.metatype.annotations&lt;/artifactId&gt;
            &lt;version&gt;${osgi-metatype-annotations.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.osgi&lt;/groupId&gt;
            &lt;artifactId&gt;org.osgi.service.component.annotations&lt;/artifactId&gt;
            &lt;version&gt;${osgi-component-annotations.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.osgi&lt;/groupId&gt;
            &lt;artifactId&gt;org.osgi.annotation.versioning&lt;/artifactId&gt;
            &lt;version&gt;${osgi-versioning.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.eclipse.rdf4j&lt;/groupId&gt;
            &lt;artifactId&gt;rdf4j-model-api&lt;/artifactId&gt;
            &lt;version&gt;${rdf4j.version}&lt;/version&gt;
            &lt;exclusions&gt;
                &lt;exclusion&gt;
                    &lt;groupId&gt;com.github.jsonld-java&lt;/groupId&gt;
                    &lt;artifactId&gt;*&lt;/artifactId&gt;
                &lt;/exclusion&gt;
            &lt;/exclusions&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;

    &lt;!-- Defines some defaults for plugins you will be using for building the bundle --&gt;
    &lt;build&gt;
        &lt;plugins&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.apache.felix&lt;/groupId&gt;
                &lt;artifactId&gt;maven-bundle-plugin&lt;/artifactId&gt;
                &lt;version&gt;${maven-bundle-plugin.version}&lt;/version&gt;
                &lt;extensions&gt;true&lt;/extensions&gt;
                &lt;configuration&gt;
                    &lt;obrRepository&gt;NONE&lt;/obrRepository&gt;
                    &lt;!-- Instructs the plugin how to generate our MANIFEST.MF file for the OSGi bundle --&gt;
                    &lt;instructions&gt;
                        &lt;Bundle-SymbolicName&gt;${project.groupId}.${project.artifactId}&lt;/Bundle-SymbolicName&gt;
                        &lt;Bundle-Name&gt;My Plugin&lt;/Bundle-Name&gt; &lt;!-- Replace this with your desired bundle name --&gt;
                        &lt;!-- Ensures the OSGi bundle version is our Maven project version --&gt;
                        &lt;Bundle-Version&gt;${project.version}&lt;/Bundle-Version&gt;
                        &lt;Export-Package&gt;
                            &lt;!-- Include this line if you are creating a new trigger --&gt;
                            com.mobi.workflows.api.trigger;provide:=true,
                            &lt;!-- Include this line if you are creating a new action --&gt;
                            com.mobi.workflows.api.action;provide:=true,
                        &lt;/Export-Package&gt;
                        &lt;_metatype&gt;*&lt;/_metatype&gt;
                        &lt;build&gt;${maven.build.timestamp}&lt;/build&gt;
                        &lt;!-- Substitutes the build timestamp for SNAPSHOT in the bundle version. Will be important for later steps --&gt;
                        &lt;_snapshot&gt;${maven.build.timestamp}&lt;/_snapshot&gt;
                    &lt;/instructions&gt;
                &lt;/configuration&gt;
            &lt;/plugin&gt;
            &lt;!-- Tells the Maven project to compile with the appropriate Java version --&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
                &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;
                &lt;version&gt;3.8.0&lt;/version&gt;
                &lt;configuration&gt;
                    &lt;release&gt;17&lt;/release&gt;
                &lt;/configuration&gt;
            &lt;/plugin&gt;
            &lt;!-- This plugin is needed to generate the Java classes for your new Trigger/Action --&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;com.mobi.orm&lt;/groupId&gt;
                &lt;artifactId&gt;rdf-orm-maven-plugin&lt;/artifactId&gt;
                &lt;version&gt;${mobi.version}&lt;/version&gt;
                &lt;executions&gt;
                    &lt;execution&gt;
                        &lt;id&gt;generateOrmSources&lt;/id&gt;
                        &lt;phase&gt;generate-sources&lt;/phase&gt;
                        &lt;goals&gt;
                            &lt;goal&gt;generate-orm&lt;/goal&gt;
                        &lt;/goals&gt;
                        &lt;inherited&gt;false&lt;/inherited&gt;
                        &lt;configuration&gt;
                            &lt;generates&gt;
                                &lt;ontology&gt;
                                    &lt;ontologyFile&gt;${project.basedir}/src/main/resources/filename.ttl&lt;/ontologyFile&gt; &lt;!-- Replace this with your file name --&gt;
                                    &lt;outputPackage&gt;my.plugin.workflows&lt;/outputPackage&gt; &lt;!-- Replace this with your desired output package name --&gt;
                                    &lt;ontologyName&gt;MyOntologyName&lt;/ontologyName&gt; &lt;!-- Replace this with your desired name for the definitions in your file. Will be used as the top level class name --&gt;
                                &lt;/ontology&gt;
                            &lt;/generates&gt;
                            &lt;references&gt;
                                &lt;ontology&gt;
                                    &lt;ontologyFile&gt;jar:http://nexus.inovexcorp.com/nexus/repository/public-maven-prod-group/com/mobi/rdf.orm.ontologies/${mobi.version}/rdf.orm.ontologies-${mobi.version}.jar!prov-o.ttl&lt;/ontologyFile&gt;
                                    &lt;outputPackage&gt;com.mobi.ontologies.provo&lt;/outputPackage&gt;
                                &lt;/ontology&gt;
                                &lt;ontology&gt;
                                    &lt;ontologyFile&gt;jar:http://nexus.inovexcorp.com/nexus/repository/public-maven-prod-group/com/mobi/prov.api/${mobi.version}/prov.api-${mobi.version}.jar!mobi_prov.ttl&lt;/ontologyFile&gt;
                                    &lt;outputPackage&gt;com.mobi.prov.api.ontologies.mobiprov&lt;/outputPackage&gt;
                                    &lt;ontologyName&gt;MobiProv&lt;/ontologyName&gt;
                                &lt;/ontology&gt;
                                &lt;ontology&gt;
                                    &lt;ontologyFile&gt;jar:http://nexus.inovexcorp.com/nexus/repository/public-maven-prod-group/com/mobi/vfs/${mobi.version}/vfs-${mobi.version}.jar!mobi_documents.ttl&lt;/ontologyFile&gt;
                                    &lt;outputPackage&gt;com.mobi.vfs.ontologies.documents&lt;/outputPackage&gt;
                                    &lt;ontologyName&gt;Documents&lt;/ontologyName&gt;
                                &lt;/ontology&gt;
                                &lt;ontology&gt;
                                    &lt;ontologyFile&gt;jar:http://nexus.inovexcorp.com/nexus/repository/public-maven-prod-group/com/mobi/catalog.api/${mobi.version}/catalog.api-${mobi.version}.jar!mcat.ttl&lt;/ontologyFile&gt;
                                    &lt;outputPackage&gt;com.mobi.catalog.api.ontologies.mcat&lt;/outputPackage&gt;
                                    &lt;ontologyName&gt;MCAT&lt;/ontologyName&gt;
                                &lt;/ontology&gt;
                                &lt;ontology&gt;
                                    &lt;ontologyFile&gt;jar:http://nexus.inovexcorp.com/nexus/repository/public-maven-prod-group/com/mobi/workflows.api/${mobi.version}/workflows.api-${mobi.version}.jar!workflows.ttl&lt;/ontologyFile&gt;
                                    &lt;outputPackage&gt;com.mobi.workflows.api.ontologies.workflows&lt;/outputPackage&gt;
                                    &lt;ontologyName&gt;Workflows&lt;/ontologyName&gt;
                                &lt;/ontology&gt;
                            &lt;/references&gt;
                            &lt;outputLocation&gt;${project.basedir}/src/main/java&lt;/outputLocation&gt;
                        &lt;/configuration&gt;
                    &lt;/execution&gt;
                &lt;/executions&gt;
            &lt;/plugin&gt;
        &lt;/plugins&gt;
    &lt;/build&gt;

    &lt;!-- Repositories that your project will be pulling the Mobi dependencies from --&gt;
    &lt;repositories&gt;
        &lt;repository&gt;
            &lt;id&gt;inovex&lt;/id&gt;
            &lt;url&gt;https://nexus.inovexcorp.com/nexus/content/repositories/public-maven-prod-group/&lt;/url&gt;
        &lt;/repository&gt;
    &lt;/repositories&gt;
    &lt;pluginRepositories&gt;
        &lt;pluginRepository&gt;
            &lt;id&gt;inovex&lt;/id&gt;
            &lt;url&gt;https://nexus.inovexcorp.com/nexus/content/repositories/public-maven-prod-group/&lt;/url&gt;
        &lt;/pluginRepository&gt;
    &lt;/pluginRepositories&gt;
&lt;/project&gt;</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="create_workflow_extension_services">Create Workflow Extension Services</h5>
<div class="paragraph">
<p>In the Maven project you created in the last section, you will need to implement different services depending on whether you are adding a Trigger or an Action. Each option is described in the sections below.</p>
</div>
<div class="sect5">
<h6 id="trigger_extension_services">Trigger Extension Services</h6>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a class that implements the <code>com.mobi.workflows.api.trigger.TriggerHandler</code> generic interface and extends the <code>com.mobi.workflows.api.trigger.BaseTriggerHandler</code> generic abstract class.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Include a static String field with your desired name for the service in the OSGi runtime. The class should look like this to start.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package my.plugin.trigger;

import com.mobi.workflows.api.trigger.BaseTriggerHandler;
import com.mobi.workflows.api.trigger.TriggerHandler;
import my.plugin.workflows.NewTrigger;

import org.osgi.service.component.annotations.Activate;
import org.osgi.service.component.annotations.Component;

public class NewTriggerHandler extends BaseTriggerHandler&lt;NewTrigger&gt; implements TriggerHandler&lt;NewTrigger&gt; {
    static final String NAME = "my.plugin.trigger.NewTriggerHandler";
}</code></pre>
</div>
</div>
</li>
<li>
<p>Add the following annotation to the class definition to instruct the runtime that this is an OSGi service.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Component(
    immediate = true,
    name = NewTriggerHandler.NAME,
    service = { TriggerHandler.class, NewTriggerHandler.class })</code></pre>
</div>
</div>
</li>
<li>
<p>Add a protected method to activate the service that calls a method from the abstract class.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Activate
protected void start() {
    startService();
}</code></pre>
</div>
</div>
</li>
<li>
<p>Add an implementation of the <code>setPid</code> method from the <code>BaseTriggerHandler</code> class that returns your service&#8217;s name.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Override
protected void setPid() {
    this.pid = NewTriggerService.NAME;
}</code></pre>
</div>
</div>
</li>
<li>
<p>Add an implementation of the <code>getTypeIRI</code> method from the <code>TriggerHandler</code> interface that returns the IRI of your Trigger definition.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Override
public String getTypeIRI() {
    return NewTrigger.TYPE;
}</code></pre>
</div>
</div>
</li>
<li>
<p>Add an implementation of the <code>getShaclDefinition</code> method from the <code>TriggerHandler</code> interface that returns an <code>InputStream</code> of the contents of the RDF file in the bundle. You should be able to just replace the name of the file in the code snippet below.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Override
public InputStream getShaclDefinition() {
    return NewTriggerHandler.class.getResourceAsStream("/filename.ttl");
}</code></pre>
</div>
</div>
</li>
<li>
<p>Add an implementation of the <code>setConfigurationProperties</code> method from the <code>BaseTriggerHandler</code> class that retrieves the properties from the RDF definition of an instance of your new Trigger type and sets appropriate OSGi service properties on the provided map. An example is shown below, but the exact contents of this method depend on the logic required for your new Trigger.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Override
protected void setConfigurationProperties(NewTrigger trigger, Map&lt;String, Object&gt; properties) {
    String attribute = trigger.getNewTriggerAttribute()
            .orElseThrow(() -&gt; new IllegalArgumentException("NewTrigger missing required newTriggerAttribute property"));
    properties.put("customProperty", attribute);
}</code></pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Create a class that implements the <code>com.mobi.workflows.api.trigger.TriggerService</code> and extends either the <code>com.mobi.workflows.api.trigger.BaseTriggerService</code> or the <code>com.mobi.workflows.api.trigger.BaseEventTriggerService</code> depends on whether the new Trigger subclasses <code>w:Trigger</code> or <code>w:EventTrigger</code> respectively. If extending the <code>BaseEventTriggerService</code>, be sure to implement <code>org.osgi.service.event.EventHandler</code> as well. The contents of this class will depend largely on how the new Trigger is meant to behave, but there are a few key changes that should be made.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Include a static String field with your desired name for the service in the OSGi runtime. The class should look like this to start.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package my.plugin.trigger;

import com.mobi.workflows.api.trigger.BaseTriggeService;
import com.mobi.workflows.api.trigger.TriggerService;
import my.plugin.workflows.NewTrigger;

import org.osgi.service.component.annotations.Activate;
import org.osgi.service.component.annotations.Component;
import org.osgi.service.component.annotations.ConfigurationPolicy;
import org.osgi.service.component.annotations.Modified;
import org.osgi.service.event.Event;
import org.osgi.service.event.EventConstants;
import org.osgi.service.event.EventHandler;

import java.util.Map;

public class NewTriggerService extends BaseTriggerService&lt;NewTrigger&gt; implements TriggerService&lt;NewTrigger&gt; {
    static final String NAME = "my.plugin.trigger.NewTriggerService";
}</code></pre>
</div>
</div>
</li>
<li>
<p>Add a protected method to activate the service and update on modification that calls a method from the abstract class and performs any other startup logic needed. including fetching the OSGi properties set by the new TriggerHandler implementation you created.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Activate
@Modified
protected void start(Map&lt;String, Object&gt; properties) {
    startService(properties);
    this.attribute = vf.createIRI(properties.get("customProperty").toString());
}</code></pre>
</div>
</div>
</li>
<li>
<p>Add the following annotation to the class definition to instruct the runtime that this is an OSGi service.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Component(
    immediate = true,
    name = NewTriggerService.NAME,
    service = { TriggerService.class, NewTriggerService.class },
    configurationPolicy = ConfigurationPolicy.REQUIRE)</code></pre>
</div>
</div>
</li>
<li>
<p>If the new Trigger is a just a subclass of <code>w:Trigger</code>, include any methods or logic needed by the new Trigger requirements, but utilize the <code>trigger</code> method from the <code>BaseTriggerService</code> class to kick off the workflow.</p>
</li>
<li>
<p>If the new Trigger is a subclass of <code>w:EventTrigger</code> include the following changes as well.</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Include the <code>EventHandler</code> class in the list of <code>service</code> classes in the <code>@Component</code> annotation and include a <code>property</code> with the name of the OSGi Event Topic you are subscribing to.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Component(
    immediate = true,
    name = NewTriggerService.NAME,
    service = { TriggerService.class, NewTriggerService.class, EventHandler.class },
    property = EventConstants.EVENT_TOPIC + "=TOPIC_NAME",
    configurationPolicy = ConfigurationPolicy.REQUIRE)</code></pre>
</div>
</div>
</li>
<li>
<p>Add an implementation of the <code>handleEvent</code> method from the <code>EventHandler</code> interface that will validate anything required in the event that is caught by your service and if everything is valid, calls the <code>trigger</code> method from the <code>BaseTriggerService</code> class. An example is shown below, but the exact logic will depend on your new Trigger requirements.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Override
public void handleEvent(Event event) {
    String someProperty = event.getProperty("someProperty").toString();
    if (someProperty.equals(this.attribute)) {
        this.trigger();
    }
}</code></pre>
</div>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="action_extension_services">Action Extension Services</h6>
<div class="paragraph">
<p>Creating a new Action depends on identifying how to conduct your desired&#8217;s Action within the chosen Workflow Engine framework. The following example assumes you are using the default <a href="https://dagu.readthedocs.io/en/latest/index.html">Dagu</a>-based Workflow Engine. Interaction with the Mobi platform via Dagu is intended to be conducted via REST and there are several utility methods provided by the services to assist with that interact. Read through the Dagu documentation and the Mobi REST API documentation to identify how to accomplish your desired tasks using Dagu steps before creating the extension service.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a class that implements the <code>com.mobi.workflows.api.action.ActionHandler</code> generic interface.</p>
</li>
<li>
<p>Include a static String field with your desired name for the service in the OSGi runtime. The class should look like this to start.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package my.plugin.action;

import com.mobi.workflows.api.action.ActionHandler;
import my.plugin.workflows.NewAction;

import org.osgi.service.component.annotations.Activate;
import org.osgi.service.component.annotations.Component;

public class NewActionHandler implements ActionHandler&lt;NewAction&gt; {
    static final String NAME = "my.plugin.action.NewActionHandler";
}</code></pre>
</div>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Add the following annotation to the class definition to instruct the runtime that this is an OSGi service.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Component(
    immediate = true,
    name = NewActionHandler.NAME,
    service = { ActionHandler.class, NewActionHandler.class })</code></pre>
</div>
</div>
</li>
<li>
<p>Add an implementation of the <code>getTypeIRI</code> method from the <code>ActionHandler</code> interface that returns the IRI of your Action definition.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Override
public String getTypeIRI() {
    return NewAction.TYPE;
}</code></pre>
</div>
</div>
</li>
<li>
<p>Add an implementation of the <code>getShaclDefinition</code> method from the <code>ActionHandler</code> interface that returns an <code>InputStream</code> of the contents of the RDF file in the bundle. You should be able to just replace the name of the file in the code snippet below.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Override
public InputStream getShaclDefinition() {
    return NewActionHandler.class.getResourceAsStream("/filename.ttl");
}</code></pre>
</div>
</div>
</li>
<li>
<p>Add an implementation of the <code>createDefinition</code> method from the <code>ActionHandler</code> interface that returns a <code>com.mobi.workflows.impl.dagu.actions.DaguActionDefinition</code> containing the Dagu step definitions that accomplish your desired Action behavior based on the provided instance of the new Action. The <code>DaguActionDefinition</code> class provides a a few utility methods to assist with creating the string definition. In general, it is recommended that each Dagu step name is associated with the IRI of the new Action instance itself in some manner. A simple example of a <code>createDefinition</code> method is shown below.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Override
public ActionDefinition createDefinition(NewAction action) {
    String attribute = action.getNewActionAttribute()
            .orElseThrow(() -&gt; new IllegalStateException("NewAction must have an attribute"));
    String step = "- name: " + action.getResource() + "\n"
            + "  command: echo \"" + attribute + "\"";
    return new DaguActionDefinition(step);
}</code></pre>
</div>
</div>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>The <code>DaguActionDefinition.getStepsToCheckEmptyVariable</code> method will return a String containing Dagu step definitions that will validate that an environment variable set by a previous step has a value. The inputs are the environment variable name and the name of the parent step.</p>
</li>
<li>
<p>The <code>DaguActionDefinition.getPlatformCurlString</code> method will return a String containing a <code>curl</code> command that will hit a specific REST endpoint on the host Mobi application. The inputs are a string containing any additional flags needed for the <code>curl</code> command and the REST endpoint path in question (i.e. the path for the endpoint after <code>$MOBI_HOST/mobirest/</code>).</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect4">
<h5 id="deploy_osgi_bundle">Deploy OSGi Bundle</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Once all the steps above are complete for the new Triggers/Actions being added to the platform, all that&#8217;s left is to build the OSGi bundle and deploy it to your Mobi installation.</p>
</li>
<li>
<p>In the root of your Maven project, run <code>mvn clean install</code> to build the OSGi bundle. Be sure that the build succeeds. If the build succeeds, your OSGI bundle for has now been created within the <code>target</code> directory of the bundle and has been installed in your local maven repository.</p>
</li>
<li>
<p>To deploy the bundle to your Mobi installation, you can copy the <code>.jar</code> file generated in your project&#8217;s <code>target</code> directory into the <code>$MOBI_HOME/deploy</code> directory of your running installation.</p>
</li>
<li>
<p>Validate that the bundle was installed and activated properly by opening the Mobi Karaf Client with <code>bin/client</code> for Unix (or <code>bin\client.bat</code> for Windows) and then running <code>bundle:list</code>. You should see your bundle&#8217;s Name listed with the version you specified in the <code>pom.xml</code> and a state of "Active".</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Now that your bundle is active and your extension services are running, the platform can execute and manage any Workflows defined that utilize the newly defined Triggers/Actions provided in the bundle!</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 2.4<br>
Last updated 2023-10-10 18:38:07 UTC
</div>
</div>
<script src="../highlight/highlight.min.js"></script>
<script>
if (!hljs.initHighlighting.called) {
  hljs.initHighlighting.called = true
  ;[].slice.call(document.querySelectorAll('pre.highlight > code')).forEach(function (el) { hljs.highlightBlock(el) })
}
</script>
</body>
</html>