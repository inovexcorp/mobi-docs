[[shapes-editor-guide]]
===  Shapes Editor (BETA)
The Mobi web-based shapes graph editor is an experimental feature that provides users with a Distributed Management System for local and community development of (https://www.w3.org/TR/shacl/#shapes[SHACL Shapes]). The Shapes Editor features a customizable user interface, constraint capture, collaboration, shapes graph reuse, and extensibility.

To reach the Shapes Editor, click on the link in the left menu.

.Shapes Editor Overview page
image::shacl-editor/shacl_overview.png[Shapes Overview Page]

The main Shapes Editor page includes a new action-bar where all the action buttons for a shapes graph record are located. From the action-bar, users can create, filter, and open different shapes graph records, branches, and tags.

.Shapes Editor Action Bar
image::shacl-editor/action_bar.png[width=100%,pdfwidth=0%,align=center]

When opening a shapes graph record, the editor will load the previous branch and/or commit you were viewing. If you have not previously opened the record or in the case that the branch you were viewing no longer exists, the editor will load the HEAD commit of the shape graph's master branch. For an explanation of commits and branches, see the section on <<Shapes Graph Versioning>>.

Once a shapes graph record has been opened, The overview page displays a list of high-level information surrounding the shapes graph. This includes a shapes graph's annotations, properties, imports, and a preview of the shapes graph serialized as RDF in https://www.w3.org/TR/turtle/[Turtle] syntax. Mobi will capture this high level information about a shapes graph with an OWL ontology object, following best practices from the SHACL W3C specification (see  https://www.w3.org/TR/shacl/#sparql-prefixes[this section] as an example).

.Shapes Record Details
image::shacl-editor/shapes_details.png[align=center]

==== Creating New Shapes Graphs
To create a shapes graph, select the btn:[Create Shapes Graph] button found in the dropdown for selecting a record. In the creation dialog, you are required to provide a title for the record and a file providing the initial shapes graph data (accepts all standard RDF formats). Users can also optionally provide a description and keywords which will be used to describe the shapes graph record in the local catalog.

.New Shapes Record Form
image::shacl-editor/create_shapes.png[width=50%,pdfwidth=50%,align=center]

The Title field populates the `dcterms:title` annotations of the new shapes graph record and the Description field populates the `dcterms:description` annotations of the new shapes graph record. The keywords field will attach the entered values as keywords to the new record.

==== Editing a Shapes Graph

NOTE: In-app shapes graph editing features are coming soon. In this BETA version, updates can be uploaded using the <<Uploading Changes to Shapes Graphs,Upload Changes feature>>

==== Shapes Graph Versioning
Each shapes graph in Mobi is versioned similarly to the https://git-scm.com/[Git] Version Control System, whereby all changes to a shapes graph are collected into a chain of "commits" which form a commit history called a "branch". Thus, every version in the history of a shapes graph can be generated by selecting a commit and applying all the changes in the branch back to the initial commit.

Every shapes graph is also initialized with a MASTER branch that contains the initial commit. Changes to the shapes graph can be uploaded to the MASTER branch or can be uploaded into separate branches. Changes uploaded on these branches exists in isolation until they are merged into the MASTER branch, joining any other changes committed in the meantime. When merging two branches, the Shapes Editor does its best to combine any changes made on both branches. If a conflict occurs, the editor allows the user to resolve them manually. More information on merging branches can be found in the section on <<Merging Branches on Shapes Graphs,Merging Branches>>.

===== Branches & Tags
In order to create a branch or tag, click the corresponding button in the action bar.

[frame=none,border=none,grid=none,stripe=none]
|===


|image:shacl-editor/create_branch_button.png[] | image:shacl-editor/create_tag_button.png[]

|===
.Create Branch and Create Tag buttons

The branches dropdown provides a searchable list of branches and tags which can be checked out. To checkout a branch or tag, simply select the branch in the drop-down menu. Checking out a tag will open the ontology at the tagged commit in read-only mode. If you have checked out a commit from the commit history table, the commit will be in the dropdown list and show as selected. Note that the ability to check out a branch or tag will be disabled if you have any uncommitted changes on the current branch.

.Branches Dropdown
image::shacl-editor/versioning_dropdown.png[width=40%,pdfwidth=40%,align=center]

To delete a branch or tag, click on the delete icon next to the branch/tag in the drop-down menu. If a branch is deleted, all commits on that branch that are not part of another branch will be removed, as well as the branch itself. If a tag is deleted, the commit is not removed. Note that these actions cannot be undone.

===== Viewing Saved Changes on Shapes Graphs
Changes that have been uploaded to a shapes graph record are automatically saved and an indicator is shown in the action-bar. Users are able to reach the changes page by clicking the btn:[Show Changes] button found in the right-hand side of the action bar.

.Changes Page
image::shacl-editor/changes_page.png[align=center]

The Changes Page displays all the uncommitted changes and the commit history table for the opened shapes graph record. This provides users the ability to upload changes without committing and allows a user the opportunity to review proposed changes to a shapes graph in a more digestible manner before adding any commits to the commit history. Clicking the btn:[Remove All Changes] button will clear all the changes uploaded into the shape graph, resetting to the state of the current commit.

Users can also view a shapes graph record at a specific commit in time by clicking the btn:[View] button next to the corresponding commit in the commit history table.

===== Merging Branches on Shapes Graphs
Merging branches works much the same as the Ontology Editor. By clicking the btn:[Merge Branch] button found in the action-bar, users are brought to the merge view of the Shapes Editor.

.Merge Branches button
image::shacl-editor/merge_branches_button.png[]

The merge view displays the name of the current (source) branch, a select box for the branch (target) you want to merge into, and a checkbox for whether or not you want the source branch to be deleted after it is merged. The view also shows an aggregated view of all changes made in the source branch that will be merged into the target branch along with a list of all the commits that will be added to the target branch from the source branch.

.Merge View
image::shacl-editor/merge_page.png[align=center]

Clicking btn:[Submit] will attempt to perform the merge. If there are no conflicts between the changes on both branches, a new commit will be created merging the two branches, and a success message will appear in the top right corner of the screen.

===== Uploading Changes to Shapes Graphs
The btn:[Upload Changes] button in the action-bar allows you to upload a new version of your shapes graph from a file and apply the changes. Clicking this button will bring up an overlay where you can select the file with the changed shapes graph. Uploaded changes will not be automatically committed, but will allow you to review changes before making a new Commit.

.Upload Changes button
image::shacl-editor/upload_changes_button.png[width=10%,pdfwidth=10%,align=left]