[[merge-requests-guide]]
=== Merge Requests
The Mobi Merge Requests module allows users to create long lived representations of a merge between two branches of a record to provide checks and balances before including changes into the object the record represents. Each merge request is connected to a particular Record in the local Catalog and specifies a "source" and "target" branch. The request represents what would occur if the "source" branch were merged into the "target" branch.

To reach the Merge Requests module, click on the link in the left menu.

.The Merge Requests module
image::merge-requests/full_merge_requests_initial_view.png[]

The initial view of the Merge Requests module displays a list of all currently open merge requests within the application sorted by created date descending along with a button to <<Create a Merge Request,create a merge request>>. To view all accepted merge requests, change the selected filter next to the search bar. Each merge request in the list displays a preview of the request metadata and a button to delete the request. Clicking on a merge request in the list opens a display of the individual merge request.

.An Individual Merge Request
image::merge-requests/individual_request.png[]

The individual merge request view displays all information regarding the merge request. The top displays more metadata about the request including the request's description and whether the source branch will be removed once the request is accepted. Below the metadata are a series of tabs containing the discussion on the request, the changes between the source and target branch, and commits that will be added from the source to the target branch. The bottom of the view contains a button to delete the request, a button to accept the request if it not already accepted, and a button to go back to the main list of merge requests.

The discussion tab allows users to comment and discuss the changes within the request to facilitates more collaboration in a distributed environment. You can create new comments to start new threads of communication or you can reply to existing comments and further the discussion. Comments can only be removed by the creators of the comment.

NOTE: The comment editor supports GitHub flavored Markdown which you can find more information about https://guides.github.com/features/mastering-markdown/[here].

The Changes tab displays the full difference of the source branch from the target branch. They are grouped by individual entity and display the triples on the entity grouped by property.  When a “Show Full” toggle is active, the changes display is updated to include all the other triples on that changed entity.

The metadata of a request can be edited by hovering over the area and clicking the pencil button. In the resulting overlay, you can change the [underline]#Title#, [underline]#Description#, target branch, [underline]#Assignees#, and whether the source branch should be removed on acceptance.

.Editing Merge Request Metadata
image::merge-requests/edit_merge_request.png[width=50%,pdfwidth=50%,align=center]

==== Create a Merge Request
To create a merge request, click btn:[New Request] on the initial view of the Merge Requests module. Creating a merge request is a three part process. The first step is to select which record in Mobi that request should be attached to by searching within the displayed paginated list of records. Once you have selected a record, click btn:[Next].

IMPORTANT: If the record a request is attached to is deleted, that request is removed. If the source branch of a request is removed, that request will also be removed.

.Creating a Merge Request: Step 1 - Select a Record
image::merge-requests/step1.png[]

The second step of creating a merge request is to pick the "source" and "target" branch from the attached record. The source branch will be the branch in the first select box and the target branch will be in the second select box. Once both are selected, you will see an aggregated view of all changes made in the source branch that will be merged into the target branch along with all the commits from the source branch that will be included in the target branch. Once you have selected the branches you want to merge, click btn:[Next].

.Creating a Merge Request: Step 2 - Select Branches
image::merge-requests/step2.png[]

The third step of creating a merge request is to provide any metadata you want to include about the request. This includes the required [underline]#Title#, optional [underline]#Description#, any [underline]#Assignees# of the request, and whether the source branch should be removed when the request is accepted. Once you have provided the metadata you wish to include, click btn:[Submit] and a new Merge Request with your selections will be created.

.Creating a Merge Request: Step 3 - Request Metadata
image::merge-requests/step3.png[]

==== Accepting a Merge Request
A merge request can be accepted only if there are no conflicts between the source and target branch and the user accepting the request has permission to modify the target (see <<Ontology Managing>>). If there are conflicts between the source and target branches, a notification will be shown with the option to resolve the conflicts from within the Merge Requests module. Resolving conflicts behaves the same as in the <<Merging Branches,Ontology Editor>>, except that the resolution will become a commit on the source branch.

.Conflicts on a Merge Request
image::merge-requests/conflicts.png[]

If a merge request is accepted, the merge will be preformed from the source into the target and the request will be moved into an Accepted state. All accepted merge requests are saved within the application for provenance.