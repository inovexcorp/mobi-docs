<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.18">
<title>Administration Guide</title>
<style>

</style>
</head>
<body class="article">
<div id="header">
</div>
<div id="content">
<div class="sect1">
<h2 id="administration-guide">Administration Guide</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Mobi is made available as a compressed distribution package available
<a href="https://mobi.inovexcorp.com/features/#download">here</a>. Deployment
consists of unpacking this distribution to an appropriate location on
the filesystem and modifying included configuration files. Mobi comes
pre-bundled with an open-source, file-based RDF database. By default,
all data, logs, and configurations will be stored in the extracted file
location.</p>
</div>
<div class="sect2">
<h3 id="_mobi_requirements">Mobi Requirements</h3>
<div class="sect3">
<h4 id="_hardware_requirements">Hardware Requirements</h4>
<div class="paragraph">
<p>We provide recommended hardware requirements as a guideline. These
specifications are based on standard deployment environments. Larger
production data or user requirements may require more powerful hardware
configurations.</p>
</div>
<div class="paragraph">
<p>The table below provides a summary of the recommended hardware for
production servers and the minimum requirements for test servers.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Component</strong></th>
<th class="tableblock halign-left valign-top"><strong>Minimum</strong></th>
<th class="tableblock halign-left valign-top"><strong>Recommended</strong></th>
<th class="tableblock halign-left valign-top"><strong>Guidelines</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Available RAM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 GB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8 GB or more</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mobi needs enough RAM to load large
ontology and data files and run Mobi processes. The configurations
provided refer to maximum Java heap size.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Disk Space</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10 GB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">40 GB or more</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">By default, Mobi stores all data and
configurations in the extracted file location.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CPU</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 core</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 cores or more</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Multi-core configurations dramatically
improve performance of the bundled application server and database.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_software_requirements">Software Requirements</h4>
<div class="paragraph">
<p>The table below provides a summary of the software requirements.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Component</strong></th>
<th class="tableblock halign-left valign-top"><strong>Minimum</strong></th>
<th class="tableblock halign-left valign-top"><strong>Recommended</strong></th>
<th class="tableblock halign-left valign-top"><strong>Guidelines</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Operating System</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RHEL/CentOS 6<br>
Windows 7<br>
OSX</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RHEL/CentOS 8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mobi runs within standard Java runtimes; however, we
recommend RHEL/CentOS operating systems for on-premise or cloud-based
server environments.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Java</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.17</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.17 (latest)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The latest versions of Java 17 include security
and performance updates.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Web Browser</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Chrome<br>
Firefox<br>
Safari<br>
Edge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Chrome</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Use the latest versions of web browsers for best
compatibility, performance, and security.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_firewall_requirements">Firewall Requirements</h4>
<div class="paragraph">
<p>The table below lists the TCP ports to open on the Mobi host.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Port</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">8443</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Application HTTPS port.</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
We recommend running Mobi on the default port 8443 and using firewall
configuration or a proxy server for SSL (port 443) termination and
redirection. Mobi does not run on non-SSL ports by default.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_installing_mobi">Installing Mobi</h3>
<div class="sect3">
<h4 id="_pre_installation_configuration">Pre-Installation Configuration</h4>
<div class="sect4">
<h5 id="_create_service_account">Create Service Account</h5>
<div class="paragraph">
<p>Before installing Mobi, create a service account on the host server. The
account will be used to run Mobi. The service account should meet the
following requirements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The service account must have read and write permissions for the Mobi
installation directory. On Linux, this is typically
<code>/opt/mobi/mobi-distribution-&lt;version&gt;</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>On a standard RHEL/CentOS system, this can be created using the
following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">sudo useradd -d /opt/mobi mobi</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_install_java_17">Install Java 17</h5>
<div class="paragraph">
<p>Mobi requires the latest version of Java 1.17 to operate. On a standard RHEL/CentOS system, there is no package available via <code>yum</code> to install. So we suggest Downloading the Oracle installer from <a href="https://www.oracle.com/java/technologies/downloads/#java17">here</a> and running it manually using the following commands:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">wget https://download.oracle.com/java/17/latest/jdk-17_linux-x64_bin.rpm
sudo rpm -Uvh jdk-17_linux-x64_bin.rpm</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If you are using a Red Hat system, you can install Java 17 with <code>sudo yum install java-17-openjdk</code>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>JAVA_HOME</code> environment variable must be set for the user running Mobi. On a standard RHEL/CentOS system (after running the rpm above) this can be set using the following commands:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">sudo su - mobi
echo 'export JAVA_HOME=/usr/java/jdk-17.0.4.1' &gt;&gt; ~/.bashrc
exit</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_install_mobi">Install Mobi</h4>
<div class="paragraph">
<p>Follow the instructions below to install Mobi. These instructions assume
that you have copied the Mobi distribution to the server.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
These instructions are prepared for a standard RHEL/CentOS deployment
server.
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Unpack Mobi to the installation parent directory (e.g. <strong>/opt/mobi</strong>)</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">sudo su - mobi
tar -xf $MOBI_DIST.tar.gz</code></pre>
</div>
</div>
</li>
<li>
<p>Create a symlink to the latest distribution</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">ln -s $MOBI_DIST latest</code></pre>
</div>
</div>
</li>
<li>
<p>Start the Mobi server</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">cd latest
./bin/start</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>To stop the Mobi server, run the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">./bin/stop</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_post_installation_configuration">Post-Installation Configuration</h4>
<div class="sect4">
<h5 id="_change_the_default_java_heap_size">Change the Default Java Heap Size</h5>
<div class="paragraph">
<p>Set the max heap size in <code>$MOBI_DIST/bin/setenv</code> (e.g.
<code>JAVA_MAX_MEM=4G</code>). In version 1.21, to include the <code>JAVA_MAX_MEM</code> and <code>JAVA_MIN_MEM</code> variables in the Mobi startup, add the following line beneath them in the <code>setenv</code> file.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
All versions from 1.22 onwards have this line already added.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">export JAVA_OPTS="-Xms${JAVA_MIN_MEM} -Xmx${JAVA_MAX_MEM}"</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_change_the_default_web_port">Change the Default Web Port</h5>
<div class="paragraph">
<p>Change the default SSL port in <code>$MOBI_DIST/etc/org.ops4j.pax.web.cfg</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">org.osgi.service.http.port.secure = &lt;SSL_APPLICATION_PORT&gt;</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
We recommend running Mobi on the default port 8443 and using firewall
configuration or a proxy server for SSL (port 443) termination and
redirection. Mobi does not run on non-SSL ports by default.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_configure_custom_ssl_certificates">Configure Custom SSL Certificates</h5>
<div class="paragraph">
<p>Mobi comes bundled with default self-signed SSL certificates stored in a
<a href="https://www.sslshopper.com/article-most-common-java-keytool-keystore-commands.html">Java
Keystore</a> file in <code>etc/keystore</code>. To provide your own SSL certificates,
simply replace the default keystore file with your own:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">cp mycerts.jks $MOBI_DIST/etc/keystore</code></pre>
</div>
</div>
<div class="paragraph">
<p>If there is a keystore password, it can be configured in the
<code>$MOBI_DIST/etc/org.ops4j.pax.web.cfg</code> file using the following
configuration properties:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Configuration Property</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>org.ops4j.pax.web.ssl.keystore.password</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The password used for keystore
integrity check</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>org.ops4j.pax.web.ssl.key.password</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The password used for keystore</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_installing_mobi_as_a_service">Installing Mobi as a Service</h5>
<div class="paragraph">
<p>We recommend that you configure Mobi as a Linux service for starting
Mobi automatically as the service user. Follow the instructions below to
implement the service on a standard RHEL/CentOS environment.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The below steps should be run as the root user.
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
Be sure to correctly configure the file locations and user.
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a file called <strong>mobi.service</strong> in the <code>/usr/lib/systemd/system</code>
directory. For example:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">[Unit]
Description=Mobi Service.
After=network.target
StartLimitIntervalSec=30

[Service]
Type=forking
PIDFile=/install_path/latest/karaf.pid
User=mobi
ExecStart=/install_path/latest/bin/start
ExecStop=/install_path/latest/bin/stop
ExecReload=/install_path/latest/bin/stop; /install_path/latest/bin/start
Restart=always

[Install]
WantedBy=default.target</code></pre>
</div>
</div>
</li>
<li>
<p>Save and close the file, and then run the following commands to start
and enable the new service:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">systemctl start mobi
systemctl enable mobi</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Once the service is enabled, Mobi should be running. The Mobi process
will start and stop automatically with the server. Any time you start
and stop Mobi manually, run the following systemctl commands:
<code>sudo systemctl stop mobi</code> and <code>sudo systemctl start mobi</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_configure_default_authentication_token_jwt_duration">Configure Default Authentication Token (JWT) Duration</h5>
<div class="paragraph">
<p>To configure the web authentication token duration, you
must create a file called <code>com.mobi.jaas.SimpleTokenManager.cfg</code> with
the property detailed below and put it in the <code>etc/</code> directory of your
Mobi installation before starting the application, otherwise the token
duration will use the default of 24 hours.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
In Enterprise deployments, this is only applied to non-SSO based authentication.
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Property Name</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
<th class="tableblock halign-left valign-top"><strong>Required</strong></th>
<th class="tableblock halign-left valign-top"><strong>Default</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">tokenDurationMins</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Token Duration time in minutes</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1440</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>An example file would look like this.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">### 1 day token duration
tokenDurationMins = 1440</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
.p12 and .jks files should both be supported
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_ldap_configuration_enterprise">LDAP Configuration (ENTERPRISE)</h5>
<div class="paragraph">
<p>In Enterprise deployments only, Mobi can be configured so that users can log into the application with the Users/Groups defined
in your organization&#8217;s directory, you must create a file called
<code>com.mobi.enterprise.ldap.impl.engine.LDAPEngine.cfg</code> with the following
properties and put it in the <code>$MOBI_DIST/etc/</code> directory before starting
the application. If a property is not required, you can delete the line
from the config file. The list of possible fields for the config file
are shown in the table below.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Property Name</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
<th class="tableblock halign-left valign-top"><strong>Required</strong></th>
<th class="tableblock halign-left valign-top"><strong>Default</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">repository.target</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Should always be (id=system)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ldap.server</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The hostname of the ldap server (ex: localhost)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ldap.port</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The port of the LDAP server (ex: <code>10389</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ldap.timeout</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of seconds it will keep trying to reach the
LDAP server before it gives up (ex: <code>30</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">30</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ldap.ssl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether to connect to the LDAP engine with SSL (ex: false)</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ldap.disable-auth</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether direct authentication to the LDAP engine is
disabled (ex: <code>false</code>)</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ldap.expiry</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of milliseconds before a LDAPUser should be
retrieved (ex: <code>3600000</code>)</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3600000</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ldap.admin.dn</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The admin DN on your LDAP server (ex:
<code>uid=admin,ou=system</code>)</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ldap.admin.password</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The admin password on your LDAP server (ex:
<code>secret</code>)</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ldap.users.base</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The base DN at which to start looking for users on the
LDAP server (<code>ex: ou=people,dc=example,dc=com</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ldap.users.filter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An optional LDAP filter for retrieved users. (ex:
<code>(businessCategory=Managers)</code> )</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ldap.users.id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The field name on users that the Mobi
application will use as the username to log in (ex: <code>uid</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ldap.users.firstName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The field name on users whose value is the first
name of the user (ex: <code>givenName</code>)</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ldap.users.lastName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The field name on users whose value is the last
name of the user (ex: <code>sn</code>)</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ldap.users.email</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The field name on users whose value is the email
address of the user (ex: <code>mail</code>)</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ldap.users.membership</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The field name on users whose values are the
groups they are a part of (ex: <code>memberOf</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ldap.users.membership.search</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The format of the user membership field.
Should be set to the field name on groups that the values of the user
membership field uses. If this is not set, assume the values are full
group DNs. (ex: <code>cn</code>)</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ldap.groups.base</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The base DN at which to start looking for groups on
the LDAP server (ex: <code>ou=groups,dc=example,dc=com</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ldap.groups.filter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An optional LDAP filter for retrieved groups (ex:
<code>(businessCategory=Managers)</code> )</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ldap.groups.id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The field name for groups' ids (ex: <code>dn</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ldap.groups.name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The field name for groups' names/titles (ex: <code>title</code>)</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ldap.groups.description</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The field name on groups whose value is the
description of the group (ex: <code>description</code>)</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ldap.groups.membership</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The field name on groups whose values are the
users that are a part of the group (ex: <code>member</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ldap.groups.membership.search</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The format of the group membership
field. Should be set to the field name on users that the values of the
group membership field uses. If this is not set, assume the values are
full user DNs. (ex: <code>uid</code>)</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>An example file would look like this.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">repository.target = (id=system)
ldap.server = localhost
ldap.port = 10389
ldap.timeout = 30
ldap.admin.dn = uid=admin,ou=system
ldap.admin.password = secret
ldap.users.base = ou=people,dc=example,dc=com
ldap.users.filter = (businessCategory=Superhero)
ldap.users.id = uid
ldap.users.firstName = givenName
ldap.users.lastName = sn
ldap.users.membership = memberOf
ldap.groups.base = ou=groups,dc=example,dc=com
ldap.groups.id = cn
ldap.groups.name = cn
ldap.groups.description = description
ldap.groups.membership = member</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_sso_configuration_enterprise">SSO Configuration (ENTERPRISE)</h5>
<div class="paragraph">
<p>In Enterprise deployments only, Mobi can be configured to integrate with an SSO provider for authentication. LDAP can be configured alongside the SSO provider to retrieve additional user details, but it is not required. If configured, it is recommended to disable direct authentication against the LDAP directory by adding <code>ldap.disable-auth = false</code> to the <code>com.mobi.enterprise.ldap.impl.engine.LDAPEngine.cfg</code> file. Mobi supports SAML, OAuth 2.0, and OpenID SSO providers.</p>
</div>
<div class="sect5">
<h6 id="_saml_configuration">SAML Configuration</h6>
<div class="paragraph">
<p>In order to configure Mobi to use SAML, you will need to create a file
called <code>com.mobi.enterprise.auth.saml.api.SAMLConfigProvider.cfg</code> to the
<code>$MOBI_DIST/etc/</code> directory. The must have the following fields.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<code>${karaf.etc}</code> is a reference to the <code>$MOBI_DIST/etc/</code> directory that the
application will understand and replace
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
In order for the <code>certFile</code> to ba valid format, it must contain the appropriate <code>-----BEGIN CERTIFICATE-----</code> header and <code>-----END CERTIFICATE-----</code> footer
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Property Name</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
<th class="tableblock halign-left valign-top"><strong>Required</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">title</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The title for the SSO provider. This title will be used in the UI for triggering the SSO authentication in the format of “Login with <em>title”</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">entityId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The SP EntityId. The SSO provider must be configured to expect requests with this SP EntityId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">certFile</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The file path to a file containing the X509 certificate for verifying the signature of SAML responses. Best practice is to put the file in the <code>$MOBI_DIST/etc/</code> directory and make this value <code>${karaf.etc}/&lt;INSERT-FILE-NAME&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">keyFile</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The optional file path to a file containing the PKCS8 key for verifying the signature of SAML responses. Best practice is to put the
file in the <code>$MOBI_DIST/etc/</code> directory and make this value <code>${karaf.etc}/&lt;INSERT-FILE-NAME&gt;</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ssoUrl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The URL for the SingleSignOnService from the IdP. This is where Mobi will redirect to.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">idAttribute</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the <code>Attribute</code> in the SAML response where the username can be found. Defaults to using the <code>&lt;UserId&gt;</code>.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ssoBinding</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The full URN of the binding to be used for the SAML Requests. Defaults to <code>urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Redirect</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">standalone</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether the SAML configuration should be considered by itself or with a LDAP backend as well. Defaults to <code>false</code>. If <code>true</code>, the properties below are applied.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">firstNameAttribute</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An optional property to specify the name of the attribute in the SAML responses that contains the first name of the authenticated user. Only applicable if <code>standalone</code>.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">lastNameAttribute</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An optional property to specify the name of the attribute in the SAML responses that contains the last name of the authenticated user. Only applicable if <code>standalone</code>.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">emailAttribute</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An optional property to specify the name of the attribute in the SAML responses that contains the email of the authenticated user. Only applicable if <code>standalone</code>.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">groupAttribute</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An optional property to specify the name of the attribute in the SAML responses that contains the groups that the authenticated user is a part of. The values of this attribute will be used as the Group&#8217;s title in Mobi. Only applicable if <code>standalone</code>.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>An example file with an LDAP backend would look like this.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">title=Samling
entityId=https://localhost:8443/mobi/#/login
certFile=${karaf.etc}/samling.cert
keyFile=${karaf.etc}/samling_pkcs8.key
ssoUrl=https://capriza.github.io/samling/samling.html
idAttribute=ShortName
ssoBinding=urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST</code></pre>
</div>
</div>
<div class="paragraph">
<p>An example <code>standalone</code> configuration would look like this.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">title=Samling
entityId=https://localhost:8443/mobi/#/login
certFile=${karaf.etc}/samling.cert
keyFile=${karaf.etc}/samling_pkcs8.key
ssoUrl=https://capriza.github.io/samling/samling.html
idAttribute=ShortName
ssoBinding=urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST
standalone=true
firstNameAttribute=FirstName
lastNameAttribute=LastName
emailAttribute=MBox
groupAttribute=Groups</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_default_saml_token_duration">Default SAML Token Duration</h6>
<div class="paragraph">
<p>In order to configure the token duration for SAML logins, you must
create a file called <code>com.mobi.enterprise.auth.rest.SAMLRest.cfg</code> with
the following properties and put it in the <code>$MOBI_DIST/etc/</code> directory
before starting the application, otherwise the token duration will use
the default of one day. There is only one possible field for the config
file as shown in the table below that is configurable and not required
to set the token duration value.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Property Name</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
<th class="tableblock halign-left valign-top"><strong>Required</strong></th>
<th class="tableblock halign-left valign-top"><strong>Default</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">tokenDurationMins</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Token Duration time in minutes</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1440</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>An example file would look like this.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">### 1 day token duration
tokenDurationMins = 1440</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_oauthopenid_configuration">OAuth/OpenID Configuration</h6>
<div class="paragraph">
<p>In order to configure Mobi to use OAuth or OpenID, you will need to create two files in the <code>$MOBI_DIST/etc</code> directory: <code>com.mobi.enterprise.auth.oauth.api.OAuthConfigProvider.cfg</code> and <code>com.mobi.enterprise.auth.oauth.impl.token.OAuthTokenLoginModuleProvider.cfg</code>. The latter must be an empty file. The former can be used to configure a generic OAuth 2.0 Provider or an OpenID Provider. For either, the file must have the following fields.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Property Name</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
<th class="tableblock halign-left valign-top"><strong>Required</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">title</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The title for the SSO provider. This title will be used in the UI for triggering the SSO authentication in the format of “Login with <em>title”</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">clientId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The ID for the Mobi installation. The OAuth/OpenID provider must be configured to expect requests with this clientId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The OAuth scopes to include in the authentication request</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">clientSecret</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The optional client secret to use in requests to the OAuth/OpenID provider.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">userIdentifierClaim</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An optional property to specify which claim in the returned JWT contains the user&#8217;s username. These values must match what is configured for the LDAP users id. Defaults to using the <code>sub</code> of the JWT</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">standalone</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether the OAuth/OpenID configuration should be considered by itself or with a LDAP backend as well. Defaults to <code>false</code>. If <code>true</code>, the property below is applied.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">groupClaim</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An optional property to specify which claim in the returned JWT contains the groups the user is a part of. The values of this attribute will be used as the Group&#8217;s title in Mobi. Only applicable if <code>standalone</code>.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>For OAuth 2.0, the file must also contain these fields.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Property Name</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
<th class="tableblock halign-left valign-top"><strong>Required</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">grantType</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The OAuth 2.0 grant type to use for authentication. Mobi currently supports the CODE and IMPLICIT flows.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">redirectUrl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The URL for the OAuth/OpenID provider. This is where Mobi will redirect to.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">tokenUrl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The URL to hit to retrieve the token in the CODE flow.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">keyFile</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The file path to a file containing the PKCS8 key for verifying the signature of JWT tokens. Best practice is to put the file in the <code>$MOBI_DIST/etc/</code> directory and make this value <code>${karaf.etc}/&lt;INSERT-FILE-NAME&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>An example file would look like this.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">title=Mock OAuth
clientId=mobi
scope=read,openid
grantType=CODE
redirectUrl=http://localhost:8080/authorize
tokenUrl=http://localhost:8080/token
keyFile=${karaf.etc}/NTs4oGbx1A-cROpjgUKdKtzTEkHUhhSwQ7xdhN6FdlQ_pub.pem</code></pre>
</div>
</div>
<div class="paragraph">
<p>For OpenID, the file must also contain these fields.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Property Name</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
<th class="tableblock halign-left valign-top"><strong>Required</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">openidConfigHostname</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The hostname of the OpenID provider. The standard <code>/.well-known/openid-configuration</code> path will be appended to this value.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>An example file would look like this.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">title=Mock OAuth
clientId=mobi
scope=read,openid
openidConfigHostname=http://localhost:8080</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_azure_ad_openid_setup">Azure AD OpenID Setup</h6>
<div class="paragraph">
<p>If you want to configure OpenID integration with Azure AD, there are a few extra steps that need to be taken due to the unique structure of the returned JWTs.</p>
</div>
<div class="paragraph">
<p>The complementary LDAP configuration for an Azure AD OpenID provider must set the <code>userPrincipalName</code> as the <code>ldap.users.id</code> property in the <code>com.mobi.enterprise.ldap.impl.engine.LDAPEngine.cfg</code> as the Azure AD JWTs do not contain the typical <code>samAccountName</code> values.</p>
</div>
<div class="paragraph">
<p>In addition, v2.0 of Azure AD adds an additional field to the header of the JWT after signing it, thus making the signature incapable of being verified by the algorithms returned from the JWKS endpoint. In order to stop Azure AD from adding this additional field, you can add a new custom scope to the App registration. The steps to do this are described in this article (<a href="https://medium.com/@abhinavsonkar/making-azure-ad-oidc-compliant-5734b70c43ff" class="bare">https://medium.com/@abhinavsonkar/making-azure-ad-oidc-compliant-5734b70c43ff</a>) under “Problem 1”.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_password_encryption_configuration">Password Encryption Configuration</h5>
<div class="paragraph">
<p>Mobi provides a way to automatically encrypt plaintext passwords stored
within service configurations on startup and subsequent updates. The setup
for this is very short. All you have to do is ensure that a file called
<code>com.mobi.security.api.EncryptionService.cfg</code> exists in the <code>$MOBI_DIST/etc</code>
directory and contains the following fields:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">enabled=true
password=ENTER_A_UNIQUE_PASSWORD_HERE</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This password is not the password you want to encrypt, rather it is a unique master
password used for encrypt and decrypt operations.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This encryption config is present and enabled by default, meaning your passwords will be automatically encrypted.
An alternate way of providing an encryption master password is via environment variable.
To configure the use of an environment variable, use the following fields:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">enabled=true
variable=MY_CHOSEN_ENVIRONMENT_VARIABLE</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you use an environment variable, make sure before you start Mobi that you have stored a
unique password as the value for that environment variable.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
If there is a default password in the Encryption Config (i.e. <code>CHANGEME</code>) make sure
you change it to a unique password before starting Mobi, otherwise your passwords will be easy
to decrypt.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Once the encryption config is added, start Mobi and if a Mobi service configuration includes
a plaintext password, it will encrypt the value and update the configuration file. To
change an encrypted value, simply replace it with the new plaintext value in the
configuration file and after a few seconds it will be automatically re-encrypted and the
file will be updated.</p>
</div>
<div class="sect5">
<h6 id="_services_that_use_encryption">Services that use Encryption</h6>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Service</strong></th>
<th class="tableblock halign-left valign-top"><strong>Config File</strong></th>
<th class="tableblock halign-left valign-top"><strong>Field that gets encrypted</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Email</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">com.mobi.email.api.EmailService.cfg</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">emailPassword</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>To update the encryption master password, change the password field in the <code>com.mobi.security.api.EncryptionService.cfg</code> file while Mobi is running. After a few seconds have passed, all passwords will be automatically re-encrypted using the new master password.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If the master password is changed while Mobi is not running, all previously encrypted passwords must be re-entered in plain text for the encryption service to re-encrypt.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2023-01-31 19:18:38 UTC
</div>
</div>
</body>
</html>